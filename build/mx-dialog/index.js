define("mx-dialog/index",["magix","$","../mx-medusa/util","mx-popover/index"],(n,e,i)=>{n("mx-popover/index");var l=n("magix"),a=n("$"),t=l.Vframe,o=n("../mx-medusa/util");l.applyStyle("_zs_gallery_mx-dialog_index_","._zs_gallery_mx-dialog_index_-dialog-backdrop,\n._zs_gallery_mx-dialog_index_-dialog-wrapper {\n  position: fixed;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  transition: all var(--duration);\n}\n._zs_gallery_mx-dialog_index_-dialog-backdrop {\n  opacity: 0;\n  top: 0;\n  background-color: rgba(0, 0, 0, 0.4);\n}\n._zs_gallery_mx-dialog_index_-dialog-backdrop._zs_gallery_mx-dialog_index_-backdrop-out {\n  opacity: 1;\n}\n._zs_gallery_mx-dialog_index_-dialog {\n  position: absolute;\n  border-radius: var(--border-radius);\n  background-color: #fff;\n  box-shadow: 0 1px 1px 0 rgba(0, 0, 0, 0.08);\n  border: 1px solid #f5f5f6;\n}\n._zs_gallery_mx-dialog_index_-dialog ._zs_gallery_mx-dialog_index_-dialog-content {\n  position: relative;\n  word-break: break-all;\n}\n._zs_gallery_mx-dialog_index_-dialog ._zs_gallery_mx-dialog_index_-dialog-close {\n  position: absolute;\n  top: 16px;\n  right: 24px;\n  width: 26px;\n  height: 26px;\n  z-index: 20;\n  border-radius: 50%;\n  background: transparent;\n  color: #ccc;\n  text-align: center;\n}\n._zs_gallery_mx-dialog_index_-dialog ._zs_gallery_mx-dialog_index_-dialog-close ._zs_gallery_mx-dialog_index_-iconfont-ext {\n  font-size: 18px;\n  font-weight: bold;\n  line-height: 26px;\n}\n._zs_gallery_mx-dialog_index_-dialog ._zs_gallery_mx-dialog_index_-dialog-close:hover,\n._zs_gallery_mx-dialog_index_-dialog ._zs_gallery_mx-dialog_index_-dialog-close:focus {\n  background-color: #999;\n  color: #fff;\n}\n._zs_gallery_mx-dialog_index_-dialog._zs_gallery_mx-dialog_index_-full {\n  border-radius: 0;\n}\n/**\n * 按钮中间的loading点动画\n */\n@-webkit-keyframes _zs_gallery_mx-dialog_index_-loading-dots {\n  0% {\n    transform: translate(0, 0);\n  }\n  25% {\n    transform: translate(0, 2px);\n  }\n  50% {\n    transform: translate(0, 0);\n  }\n  75% {\n    transform: translate(0, -2px);\n  }\n  100% {\n    transform: translate(0, 0);\n  }\n}\n@keyframes _zs_gallery_mx-dialog_index_-loading-dots {\n  0% {\n    transform: translate(0, 0);\n  }\n  25% {\n    transform: translate(0, 2px);\n  }\n  50% {\n    transform: translate(0, 0);\n  }\n  75% {\n    transform: translate(0, -2px);\n  }\n  100% {\n    transform: translate(0, 0);\n  }\n}\n@-webkit-keyframes _zs_gallery_mx-dialog_index_-loading-dots-rev {\n  0% {\n    transform: translate(0, 0);\n  }\n  25% {\n    transform: translate(0, -2px);\n  }\n  50% {\n    transform: translate(0, 0);\n  }\n  75% {\n    transform: translate(0, 2px);\n  }\n  100% {\n    transform: translate(0, 0);\n  }\n}\n@keyframes _zs_gallery_mx-dialog_index_-loading-dots-rev {\n  0% {\n    transform: translate(0, 0);\n  }\n  25% {\n    transform: translate(0, -2px);\n  }\n  50% {\n    transform: translate(0, 0);\n  }\n  75% {\n    transform: translate(0, 2px);\n  }\n  100% {\n    transform: translate(0, 0);\n  }\n}\n._zs_gallery_mx-dialog_index_-loading-dot,\n._zs_gallery_mx-dialog_index_-loading-dot:after,\n._zs_gallery_mx-dialog_index_-loading-dot:before {\n  display: inline-block;\n  width: 4px;\n  height: 4px;\n  background-color: white;\n  vertical-align: middle;\n  border-radius: 50%;\n}\n._zs_gallery_mx-dialog_index_-loading-dot {\n  position: relative;\n  margin: 0 8px;\n}\n._zs_gallery_mx-dialog_index_-loading-dot:after {\n  content: ' ';\n  position: absolute;\n  left: -8px;\n  top: 0;\n  -webkit-animation: _zs_gallery_mx-dialog_index_-loading-dots 0.6s linear 0s infinite;\n          animation: _zs_gallery_mx-dialog_index_-loading-dots 0.6s linear 0s infinite;\n}\n._zs_gallery_mx-dialog_index_-loading-dot:before {\n  content: ' ';\n  position: absolute;\n  left: 8px;\n  top: 0;\n  -webkit-animation: _zs_gallery_mx-dialog_index_-loading-dots-rev 0.6s linear 0s infinite;\n          animation: _zs_gallery_mx-dialog_index_-loading-dots-rev 0.6s linear 0s infinite;\n}\n._zs_gallery_mx-dialog_index_-btn-submit {\n  position: relative;\n}\n._zs_gallery_mx-dialog_index_-btn-submit ._zs_gallery_mx-dialog_index_-submit-text {\n  opacity: 1;\n  position: relative;\n  z-index: 1;\n}\n._zs_gallery_mx-dialog_index_-btn-submit ._zs_gallery_mx-dialog_index_-submit-loading {\n  display: none;\n  position: absolute;\n  top: 0;\n  left: 0;\n  z-index: 2;\n  width: 100%;\n  height: 100%;\n}\n._zs_gallery_mx-dialog_index_-btn-submit._zs_gallery_mx-dialog_index_-btn-submit-loading ._zs_gallery_mx-dialog_index_-submit-text {\n  opacity: 0;\n}\n._zs_gallery_mx-dialog_index_-btn-submit._zs_gallery_mx-dialog_index_-btn-submit-loading ._zs_gallery_mx-dialog_index_-submit-loading {\n  display: inline;\n}\n");var r=500,d=[];i.exports=l.View.extend({tmpl:function(n,e,i,l,a,t,o,r){if(i||(i=n),!a){var d={"&":"amp","<":"lt",">":"gt",'"':"#34","'":"#39","`":"#96"},s=/[&<>"'`]/g,_=function(n){return"&"+d[n]+";"};a=function(n){return""+(null==n?"":n)},l=function(n){return a(n).replace(s,_)}}if(!t){var c={"!":"%21","'":"%27","(":"%28",")":"%29","*":"%2A"},g=function(n){return c[n]},f=/[!')(*]/g;t=function(n){return encodeURIComponent(a(n)).replace(f,g)}}if(!r){var m=/[\\'"]/g;r=function(n){return a(n).replace(m,"\\$&")}}var x,p,u,y="",h=n.closable,b=n.cntId,v=n.full,z=n.fullHeader,w=n.fullFooter;try{u=1,p="if closable",x="<%if (closable) {%>",h&&(y+='<a mxs="_zs_gallerya4:_" href="javascript:;" mx-click="'+e+'@{close}()" class="_zs_gallery_mx-dialog_index_-dialog-close"><i class="mc-iconfont _zs_gallery_mx-dialog_index_-iconfont-ext">&#xe603;</i></a>',u=5,p="/if",x="<%}%>"),y+='<div class="_zs_gallery_mx-dialog_index_-dialog-content" id="',u=6,p="=cntId",y+=(x="<%=cntId%>",l(b)+'_content">'),u=7,p="if full",x="<%if (full) {%>",v?(y+=" ",u=10,p="if fullHeader.title",x="<%if (fullHeader.title) {%>",z.title&&(y+='<div class="dialog-header" id="',u=11,p="=cntId",y+=(x="<%=cntId%>",l(b)+'_header"><span mxa="_zs_gallerya4:_" class="header-name">'),u=12,p="!fullHeader.title",y+=(x="<%!fullHeader.title%>",a(z.title)+"</span>"),u=13,p="if fullHeader.iconTip",x="<%if (fullHeader.iconTip) {%>",z.iconTip&&(y+='<i class="mc-iconfont color-c displacement-2" mx-view="mx-popover/index?content=',u=17,p="=fullHeader.iconTip",y+=(x="<%!$eu(fullHeader.iconTip)%>",t(z.iconTip)+'">&#xe7aa;</i>'),u=18,p="/if",x="<%}%>"),y+=" ",u=20,p="if fullHeader.tip",x="<%if (fullHeader.tip) {%>",z.tip&&(y+='<span mxa="_zs_gallerya4:a" class="color-9 ml10">',u=21,p="!fullHeader.tip",y+=(x="<%!fullHeader.tip%>",a(z.tip)+"</span>"),u=22,p="/if",x="<%}%>"),y+="</div>",u=24,p="/if",x="<%}%>"),y+='<div id="',u=26,p="=cntId",y+=(x="<%=cntId%>",l(b)+'"><div mxs="_zs_gallerya4:a" class="loading" style="padding: 150px 0;"><span class="loading-anim"></span></div></div>'),u=32,p="if (fullFooter.enter || fullFooter.cancel)",x="<%if (fullFooter.enter || fullFooter.cancel) {%>",(w.enter||w.cancel)&&(y+='<div class="dialog-footer clearfix" id="',u=33,p="=cntId",y+=(x="<%=cntId%>",l(b)+'_footer">'),u=34,p="if fullFooter.enter",x="<%if (fullFooter.enter) {%>",w.enter&&(y+='<a mxa="_zs_gallerya4:b" href="javascript:;" class="fl btn btn-brand min-width-60 mr10 _zs_gallery_mx-dialog_index_-btn-submit" mx-click="'+e+'@{submit}()"><span mxa="_zs_gallerya4:c" class="_zs_gallery_mx-dialog_index_-submit-text">',u=36,p="!fullFooter.enterText",y+=(x="<%!fullFooter.enterText%>",a(w.enterText)+"</span></a>"),u=38,p="/if",x="<%}%>"),y+=" ",u=40,p="if fullFooter.cancel",x="<%if (fullFooter.cancel) {%>",w.cancel&&(y+='<a mxa="_zs_gallerya4:d" href="javascript:;" class="fl btn min-width-60 mr10" mx-click="'+e+'@{close}()">',u=41,p="!fullFooter.cancelText",y+=(x="<%!fullFooter.cancelText%>",a(w.cancelText)+"</a>"),u=42,p="/if",x="<%}%>"),y+=" ",u=44,p="if fullFooter.enter",x="<%if (fullFooter.enter) {%>",w.enter&&(y+='<span id="',u=45,p="=cntId",y+=(x="<%=cntId%>",l(b)+'_footer_error" class="fl lh32 color-red"></span>'),u=46,p="/if",x="<%}%>"),y+="</div>",u=48,p="/if",x="<%}%>"),y+=" ",u=49,p="else",x="<%}else {%>"):(y+='<div id="',u=51,p="=cntId",y+=(x="<%=cntId%>",l(b)+'"><div mxs="_zs_gallerya4:a" class="loading" style="padding: 150px 0;"><span class="loading-anim"></span></div></div>'),u=54,p="/if",x="<%}%>"),y+="</div>"}catch(n){var k="render view error:"+(n.message||n);throw p&&(k+="\r\n\tsrc art:{{"+p+"}}\r\n\tat line:"+u),k+="\r\n\t"+(p?"translate to:":"expr:"),k+=x+"\r\n\tat file:mx-dialog/index.html"}return y},init:function(n){var e=this;e.on("destroy",function(){!function(n){for(var e=d.length-1;e>=0;e--)if(d[e].id==n.id){d.splice(e,1);break}}(e),r-=2,a("#"+e.id).trigger("dlg_close"),e["@{search.timer}"]&&clearTimeout(e["@{search.timer}"])}),r+=2,d.push(e),l.has(n,"closable")||(n.closable=!0),e.updater.set(l.mix({cntId:"cnt_"+e.id},n))},render:function(){var n=this,e=n.updater,i=e.get();e.digest(),setTimeout(n.wrapAsync(function(){var e=a("#wrapper_"+n.id);e.css(i.posTo),n["@{sync.full.style}"]();var t=i.cntId,o=a("#mask_"+n.id);o.length>0?o.addClass("_zs_gallery_mx-dialog_index_-backdrop-out"):e.on("click",function(e){l.inside(e.target,t+"_content")||a("#"+n.id).trigger("dlg_close")}),n.owner.mountVframe(t,i.view,i),e.on("scroll",function(){a(document).trigger("dialogScolll")})}),250)},"@{sync.full.style}":function(){var n=this.updater.get(),e=n.cntId;if(n.full){var i=window.innerHeight,l=a("#"+e+"_header"),t=a("#"+e+"_footer");l&&l.length&&(i-=l.outerHeight()),t&&t.length&&(i-=t.outerHeight());var o={height:i-2,overflowY:"auto"};n.card&&(o.backgroundColor="#e8ebf2",o.padding="16px 24px"),a("#"+e).css(o);var r=a("#"+n.vId),d=window.innerWidth,s=Math.min(d,n.width);r.css({width:s,left:Math.max(0,d-s)})}},"@{notify.main.view.unload}":function(n){var e=t.get("cnt_"+this.id);e&&e.invoke("fire",["unload",n])},"@{submit}<click>":function(n){var e=a(n.eventTarget),i="_zs_gallery_mx-dialog_index_-btn-submit-loading";if(!e.hasClass(i)){e.addClass(i),e.append('<span class="_zs_gallery_mx-dialog_index_-submit-loading">\n            <span class="_zs_gallery_mx-dialog_index_-loading-dot"></span>\n        </span>');var l=this,o=l.updater.get(),r=o.cntId;t.get(r).invoke("check").then(function(n){e.find("._zs_gallery_mx-dialog_index_-submit-loading").remove(),e.removeClass(i);var t=a("#"+r+"_footer_error");n.ok?(t.html(""),l["@{close}<click>"](),o.callback&&o.callback(n.data||{})):n.msg?t.html('<i class="mc-iconfont displacement-2">&#xe6ad;</i>'+n.msg):t.html("")})}},"@{close}<click>":function(){a("#"+this.id).trigger("dlg_close")},"$doc<keyup>":function(n){if(27==n.keyCode){var e=d[d.length-1];if(e==this&&e.updater.get("closable"))a("#"+e.id).trigger("dlg_close")}},"$win<resize>":function(n){var e=this;e["@{search.timer}"]&&clearTimeout(e["@{search.timer}"]),e["@{search.timer}"]=setTimeout(e.wrapAsync(function(){e["@{sync.full.style}"]()}),200)}},{"@{dialog.show}":function(n,e){var i=l.guid("dlg_");if(e.mask){var t=a('<div class="_zs_gallery_mx-dialog_index_-dialog-backdrop" id="mask_'+i+'" />');t.css({zIndex:r-1}),a(document.body).append(t)}var o="wrapper_"+i,s=r,_=e.width,c=e.left,g=e.top,f=a('<div class="_zs_gallery_mx-dialog_index_-dialog-wrapper" \n            id="'+o+'" \n            style="z-index:'+s+'">\n            <div class="_zs_gallery_mx-dialog_index_-dialog '+(e.full?"_zs_gallery_mx-dialog_index_-full":"")+'" id="'+i+'" \n                style="top:'+g+"px; left:"+c+"px; width:"+_+'px;"></div>\n        </div>');f.css(e.posFrom),a(document.body).append(f),window.innerWidth-document.body.clientWidth>0&&(document.body.style.paddingRight=window.innerWidth-document.body.clientWidth+"px"),document.body.style.overflowY="hidden",f.css({overflowY:e.modal?"hidden":"auto"});var m,x=n.owner.mountVframe(i,"mx-dialog/index",e),p=a("#"+i);return p.on("dlg_close",function(){p.data("closed")||p.trigger({type:"beforeClose",closeFn:function(){if(!p.data("closing")&&!m){var l=function(){p.data("closing",1),a("#wrapper_"+i).css(e.posFrom),a("#mask_"+i).removeClass("_zs_gallery_mx-dialog_index_-backdrop-out"),setTimeout(function(){p.trigger("close"),p.data("closed",1),n.owner&&n.owner.unmountVframe(i),a("#wrapper_"+i).remove(),a("#mask_"+i).remove(),0==d.length&&(document.body.style.paddingRight="",document.body.style.overflowY="")},250)},t={prevent:function(){m=1},resolve:function(){t.p=1,m=0,l()},reject:function(){t.p=1,m=0}};x.invoke("@{notify.main.view.unload}",[t]),m||t.p||l()}}})})},alert:function(n,e,i,a){var t=(a=a||{}).btns+""!="false";return this.mxDialog("mx-dialog/alert",{title:n,content:e,enterCallback:i,hasBtns:t},l.mix({width:320,closable:!1,mask:!1},a))},confirm:function(n,e){return this.mxDialog("mx-dialog/confirm",n,l.mix({width:320,closable:!1,mask:!1},e||{}))},mxModal:function(n,e,i){return i=i||{},this.mxDialog(n,e,l.mix({closable:!0,mask:!0},l.mix(i,{full:!0,fullHeader:l.mix({title:"",tip:"",iconTip:""},i.header||{}),fullFooter:l.mix({enter:!0,enterText:o["dialog.submit"],cancel:!0,cancelText:o["dialog.cancel"]},i.footer||{}),modal:!1,height:window.innerHeight,placement:"right",card:i.card+""!="false"})))},mxDialog:function(n,e,i){var t,o,r,d=this,s={beforeClose:function(n){o=n},close:function(){t&&t.trigger("dlg_close")},afterClose:function(n){r=n}},_={view:n};return seajs.use(n,d.wrapAsync(function(c){var g="$dlg_"+n;if(!d[g]){d[g]=1;var f,m,x,p,u=c.dialogOptions||{},y=(i=i||{}).placement||u.placement||"center",h=i.width||u.width||400,b=i.height||u.height||260,v=window.innerWidth,z=window.innerHeight,w=i.target||u.target;if(w){var k=void 0;k="string"!=typeof w||/^#/.test(w)||/^\./.test(w)?a(w):a("#"+w);var T=i.offset||u.offset||{};T.top=+T.top||0,T.left=+T.left||0;var F=k.offset();m=F.top+k.outerHeight()+10-a(window).scrollTop()+T.top,f=F.left-(h-k.outerWidth())/2+T.left,x={opacity:0,top:"-50px"},p={opacity:1,top:0}}else switch(y){case"center":f=(v-h)/2,m=Math.max((z-b)/2,0),x={opacity:0,top:"-50px"},p={opacity:1,top:0};break;case"right":f=v-h,m=0,x={opacity:0,top:0,left:v},p={opacity:1,top:0,left:0}}l.mix(_,{mask:!0,modal:!1,width:h,closable:!0,left:f,top:m,posFrom:x,posTo:p},u,i),l.mix(_,e),_.dialog=s,(t=d["@{dialog.show}"](d,_)).on("beforeClose",function(n){(!o||o&&o())&&n.closeFn()}),t.on("close",function(){delete d[g],r&&r()})}})),s},mxCloseAllDialogs:function(){d.forEach(function(n){var e=a("#"+n.id);e&&e.trigger("dlg_close")})}})});