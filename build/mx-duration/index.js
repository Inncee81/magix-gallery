define("mx-duration/index",["magix","mx-form/index","mx-form/validator","mx-duration/data"],(e,t,r)=>{var n=e("magix"),o=e("mx-form/index"),i=e("mx-form/validator"),a=e("mx-duration/data");n.applyStyle("_zs_gallery_mx-duration_index_","._zs_gallery_mx-duration_index_-circle {\n  display: inline-block;\n  width: 10px;\n  height: 10px;\n  margin-right: 3px;\n  border-radius: 50%;\n}\n._zs_gallery_mx-duration_index_-duration {\n  box-sizing: border-box;\n  border-radius: var(--border-radius);\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n  user-select: none;\n  cursor: default;\n  background-color: var(--color-bg);\n}\n._zs_gallery_mx-duration_index_-duration ._zs_gallery_mx-duration_index_-week {\n  border-top: 1px solid var(--color-border);\n  border-right: 1px solid var(--color-border);\n  border-left: 1px solid var(--color-border);\n  border-top-left-radius: var(--border-radius);\n  border-bottom-left-radius: var(--border-radius);\n}\n._zs_gallery_mx-duration_index_-duration ._zs_gallery_mx-duration_index_-week ._zs_gallery_mx-duration_index_-week-item {\n  font-size: 12px;\n  color: #999;\n  text-align: center;\n  border-bottom: 1px solid var(--color-border);\n}\n._zs_gallery_mx-duration_index_-duration ._zs_gallery_mx-duration_index_-week ._zs_gallery_mx-duration_index_-week-item:first-child {\n  border-top-left-radius: var(--border-radius);\n}\n._zs_gallery_mx-duration_index_-duration ._zs_gallery_mx-duration_index_-week ._zs_gallery_mx-duration_index_-week-item:last-child {\n  border-bottom-left-radius: var(--border-radius);\n}\n._zs_gallery_mx-duration_index_-duration ._zs_gallery_mx-duration_index_-content ._zs_gallery_mx-duration_index_-range {\n  background-color: var(--color-bg);\n  border-top: 1px solid var(--color-border);\n  border-bottom: 1px solid var(--color-border);\n  border-top-right-radius: var(--border-radius);\n  text-align: center;\n  color: #999;\n}\n._zs_gallery_mx-duration_index_-duration ._zs_gallery_mx-duration_index_-content ._zs_gallery_mx-duration_index_-range ._zs_gallery_mx-duration_index_-range-item {\n  float: left;\n  font-size: 12px;\n  border-right: 1px solid var(--color-border);\n}\n._zs_gallery_mx-duration_index_-duration ._zs_gallery_mx-duration_index_-content ._zs_gallery_mx-duration_index_-range ._zs_gallery_mx-duration_index_-range-item:last-child {\n  border-top-right-radius: var(--border-radius);\n}\n._zs_gallery_mx-duration_index_-duration ._zs_gallery_mx-duration_index_-content ._zs_gallery_mx-duration_index_-time {\n  background-color: var(--color-bg);\n  text-align: center;\n  color: #999;\n}\n._zs_gallery_mx-duration_index_-duration ._zs_gallery_mx-duration_index_-content ._zs_gallery_mx-duration_index_-time ._zs_gallery_mx-duration_index_-time-item {\n  float: left;\n  font-size: 12px;\n  border-right: 1px solid var(--color-border);\n  border-bottom: 1px solid var(--color-border);\n}\n._zs_gallery_mx-duration_index_-duration ._zs_gallery_mx-duration_index_-content ._zs_gallery_mx-duration_index_-boxzone ._zs_gallery_mx-duration_index_-box {\n  background: #fff;\n  border-right: 1px solid var(--color-border);\n  border-bottom: 1px solid var(--color-border);\n}\n._zs_gallery_mx-duration_index_-duration ._zs_gallery_mx-duration_index_-content ._zs_gallery_mx-duration_index_-boxzone ._zs_gallery_mx-duration_index_-box:last-child {\n  border-bottom-right-radius: var(--border-radius);\n}\n._zs_gallery_mx-duration_index_-duration-wrapper {\n  position: relative;\n}\n._zs_gallery_mx-duration_index_-duration-wrapper ._zs_gallery_mx-duration_index_-discount-mask {\n  position: absolute;\n  z-index: 100;\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n  user-select: none;\n  cursor: default;\n  border: 1px solid var(--color-brand);\n  background: rgba(75, 138, 251, 0.2);\n}\n._zs_gallery_mx-duration_index_-duration-wrapper ._zs_gallery_mx-duration_index_-discount-hover {\n  position: absolute;\n  z-index: 100;\n  width: 140px;\n  padding: 20px;\n  border-radius: var(--border-radius);\n  background: #fff;\n  filter: alpha(opacity=80);\n  opacity: 0.8;\n}\n._zs_gallery_mx-duration_index_-duration-wrapper ._zs_gallery_mx-duration_index_-discount-setting {\n  position: absolute;\n  z-index: 100;\n  width: calc(var(--font-size) * 16 + 40px);\n  border-radius: var(--border-radius);\n  background: #fff;\n}\n._zs_gallery_mx-duration_index_-duration-wrapper ._zs_gallery_mx-duration_index_-discount-setting ._zs_gallery_mx-duration_index_-setting-content {\n  padding: 10px 10px 0 10px;\n  border-bottom: 1px solid var(--color-border);\n}\n._zs_gallery_mx-duration_index_-duration-wrapper ._zs_gallery_mx-duration_index_-discount-setting ._zs_gallery_mx-duration_index_-setting-footer {\n  padding: 10px;\n}\n"),r.exports=n.View.extend({tmpl:function(e,t,r,n,o,i,a,s){if(r||(r=e),!o){var d={"&":"amp","<":"lt",">":"gt",'"':"#34","'":"#39","`":"#96"},l=/[&<>"'`]/g,_=function(e){return"&"+d[e]+";"};o=function(e){return""+(null==e?"":e)},n=function(e){return o(e).replace(l,_)}}if(!i){var u={"!":"%21","'":"%27","(":"%28",")":"%29","*":"%2A"},g=function(e){return u[e]},m=/[!')(*]/g;i=function(e){return encodeURIComponent(o(e)).replace(m,g)}}if(!s){var x=/[\\'"]/g;s=function(e){return o(e).replace(x,"\\$&")}}var c,h,f,p="",b=e.maxWidth,v=e.hoverInfo,y=e.maskInfo,w=e.settingInfo,z=e.viewId,k=e.boxWidth,I=e.multiple,$=e.headerHeight,T=e.weeks,H=e.boxHeight,W=e.rowNum,N=e.ranges,D=e.boxZones;try{p+='<div mxv style="width: ',f=1,h="=maxWidth",p+=(c="<%=maxWidth%>",n(b)+'px;" class="_zs_gallery_mx-duration_index_-duration-wrapper">'),f=3,h="if hoverInfo.show",c="<%if (hoverInfo.show) {%>",v.show&&(p+='<div style="top: ',f=4,h="=hoverInfo.top",p+=(c="<%=hoverInfo.top%>",n(v.top)+"px; left: "),f=4,h="=hoverInfo.left",p+=(c="<%=hoverInfo.left%>",n(v.left)+'px;" class="_zs_gallery_mx-duration_index_-discount-hover mx-shadow"><div mxa="_zs_gallerybo:_" class="mb5">'),f=6,h="=hoverInfo.week",p+=(c="<%=hoverInfo.week%>",n(v.week)+'</div><div mxa="_zs_gallerybo:a" class="mb5"><strong>'),f=7,h="=hoverInfo.time",p+=(c="<%=hoverInfo.time%>",n(v.time)+"</strong></div><div><strong>"),f=8,h="=hoverInfo.discount",p+=(c="<%=hoverInfo.discount%>",n(v.discount)+"</strong>%折扣</div></div>"),f=10,h="/if",c="<%}%>"),p+=" ",f=13,h="if maskInfo.show",c="<%if (maskInfo.show) {%>",y.show&&(p+='<div style="top: ',f=14,h="=maskInfo.top",p+=(c="<%=maskInfo.top%>",n(y.top)+"px; left: "),f=14,h="=maskInfo.left",p+=(c="<%=maskInfo.left%>",n(y.left)+"px; height: "),f=14,h="=maskInfo.height",p+=(c="<%=maskInfo.height%>",n(y.height)+"px; width: "),f=14,h="=maskInfo.width",p+=(c="<%=maskInfo.width%>",n(y.width)+'px;" class="_zs_gallery_mx-duration_index_-discount-mask"></div>'),f=16,h="/if",c="<%}%>"),p+=" ",f=19,h="if settingInfo.show",c="<%if (settingInfo.show) {%>",w.show&&(p+='<div mxv style="top: ',f=20,h="=settingInfo.top",p+=(c="<%=settingInfo.top%>",n(w.top)+"px; left: "),f=20,h="=settingInfo.left",p+=(c="<%=settingInfo.left%>",n(w.left)+'px;" class="_zs_gallery_mx-duration_index_-discount-setting mx-shadow"><div mxv mxa="_zs_gallerybo:b" class="_zs_gallery_mx-duration_index_-setting-content"><div mxa="_zs_gallerybo:c" class="mb10"><span>'),f=24,h="=settingInfo.week",p+=(c="<%=settingInfo.week%>",n(w.week)+'</span>：<strong mxa="_zs_gallerybo:d" class="ml5">'),f=25,h="=settingInfo.time",p+=(c="<%=settingInfo.time%>",n(w.time)+'</strong></div><div mxv mxa="_zs_gallerybo:e" class="mb5"><label mxv><input type="radio" class="radio" name="settingType" value="1" mx-change="'+t+'changeSettingType({type:1})" '),f=31,h="if settingInfo.type == 1",c="<%if (settingInfo.type == 1) {%>",1==w.type&&(p+=' checked="true" ',f=31,h="/if",c="<%}%>"),p+="/>自定义：</label>",f=33,h="if settingInfo.type == 1",c="<%if (settingInfo.type == 1) {%>",1==w.type?(p+='<input mxe="'+t+'_0" mxc="[',f=36,h=":settingInfo.discount{required:true,posint:[true,'范围:30-250的整数'],min:[30,'范围:30-250的整数'],max:[250,'范围:30-250的整数']}",p+="{p:'settingInfo.discount',f:{required:true,posint:[true,'范围:30-250的整数'],min:[30,'范围:30-250的整数'],max:[250,'范围:30-250的整数']}}]\" class=\"input w100\" value=\"",f=35,h="=settingInfo.discount",p+=(c="<%=settingInfo.discount%>",n(w.discount)+'"/>'),f=37,h="else",c="<%}    else {%>"):(p+='<input class="input w100" disabled="true" value="',f=40,h="=settingInfo.discount",p+=(c="<%=settingInfo.discount%>",n(w.discount)+'"/>'),f=41,h="/if",c="<%}%>"),p+='<span mxs="_zs_gallerybo:_" class="ml5">%</span></div><div mxv mxa="_zs_gallerybo:f" class="mb10"><label mxv><input type="radio" name="settingType" class="radio" value="2" mx-change="'+t+'changeSettingType({type:2})" ',f=48,h="if settingInfo.type == 2",c="<%if (settingInfo.type == 2) {%>",2==w.type&&(p+=' checked="true" ',f=48,h="/if",c="<%}%>"),p+='/>无折扣</label></div><div mxv mxa="_zs_gallerybo:g" class="mb10"><label mxv><input type="radio" name="settingType" class="radio" value="3" mx-change="'+t+'changeSettingType({type:3})" ',f=55,h="if settingInfo.type == 3",c="<%if (settingInfo.type == 3) {%>",3==w.type&&(p+=' checked="true" ',f=55,h="/if",c="<%}%>"),p+='/>不投放</label></div></div><div mxs="_zs_gallerybo:a" class="_zs_gallery_mx-duration_index_-setting-footer"><a class="btn btn-small btn-brand mr10 w60" href="javascript:;" mx-click="'+t+'submitSetting()">确定</a><a class="btn btn-small w60" href="javascript:;" mx-click="'+t+'cancelSetting()">取消</a></div></div>',f=64,h="/if",c="<%}%>"),p+='<div class="_zs_gallery_mx-duration_index_-duration clearfix" id="',f=66,h="=viewId",p+=(c="<%=viewId%>",n(z)+'_duration" style="width: '),f=67,h="=(maxWidth)",p+=(c="<%=(maxWidth)%>",n(b)+'px;"><ul class="_zs_gallery_mx-duration_index_-week fl" style="width: '),f=68,h="=(boxWidth*multiple)",p+=(c="<%=(boxWidth * multiple)%>",n(k*I)+'px;"><li class="_zs_gallery_mx-duration_index_-week-item" style="height: '),f=69,h="=headerHeight+1",p+=(c="<%=headerHeight + 1%>",n($+1)+"px; line-height: "),f=69,h="=headerHeight",p+=(c="<%=headerHeight%>",n($)+'px;">星期</li>'),f=70,h="each weeks as week",c="<%for (var $art_ispmska$art_i = 0, $art_cjwtlxairyn$art_c = weeks.length; $art_ispmska$art_i < $art_cjwtlxairyn$art_c; $art_ispmska$art_i++) {    var week = weeks[$art_ispmska$art_i]%>";for(var M=0,Z=T.length;M<Z;M++){var q=T[M];p+='<li class="_zs_gallery_mx-duration_index_-week-item" style="height: ',f=71,h="=boxHeight",p+=(c="<%=boxHeight%>",n(H)+"px; line-height: "),f=71,h="=boxHeight",p+=(c="<%=boxHeight%>",n(H)+'px;">'),f=71,h="=week",p+=(c="<%=week%>",n(q)+"</li>"),f=72,h="/each",c="<%}%>"}p+='</ul><div class="_zs_gallery_mx-duration_index_-content fl" style="width: ',f=74,h="=boxWidth*rowNum",p+=(c="<%=boxWidth * rowNum%>",n(k*W)+'px;"><ul mxa="_zs_gallerybo:h" class="_zs_gallery_mx-duration_index_-range clearfix">'),f=76,h="each ranges as range",c="<%for (var $art_iyqyinlrck$art_i = 0, $art_czkfniqumm$art_c = ranges.length; $art_iyqyinlrck$art_i < $art_czkfniqumm$art_c; $art_iyqyinlrck$art_i++) {    var range = ranges[$art_iyqyinlrck$art_i]%>";for(var j=0,S=N.length;j<S;j++){var C=N[j];p+='<li class="_zs_gallery_mx-duration_index_-range-item" style="width: ',f=77,h="=(boxWidth*(rowNum/4))",p+=(c="<%=(boxWidth * (rowNum / 4))%>",n(k*(W/4))+"px; height: "),f=77,h="=headerHeight/2",p+=(c="<%=headerHeight / 2%>",n($/2)+"px; line-height: "),f=77,h="=headerHeight/2",p+=(c="<%=headerHeight / 2%>",n($/2)+'px;">'),f=77,h="=range",p+=(c="<%=range%>",n(C)+"</li>"),f=78,h="/each",c="<%}%>"}p+='</ul><ul mxa="_zs_gallerybo:i" class="_zs_gallery_mx-duration_index_-time clearfix">',f=81,h="for (let i=0;i<24;i+=1)",c="<%for (var i = 0; i < 24; i += 1) {%>";for(var R=0;R<24;R+=1)p+='<li class="_zs_gallery_mx-duration_index_-time-item" style="width: ',f=82,h="=(boxWidth*multiple)",p+=(c="<%=(boxWidth * multiple)%>",n(k*I)+"px; height: "),f=82,h="=headerHeight/2",p+=(c="<%=headerHeight / 2%>",n($/2)+"px; line-height: "),f=82,h="=headerHeight/2",p+=(c="<%=headerHeight / 2%>",n($/2)+'px;">'),f=82,h="=i",p+=(c="<%=i%>",n(R)+"</li>"),f=83,h="/for",c="<%}%>";p+='</ul><ul mxa="_zs_gallerybo:j" class="_zs_gallery_mx-duration_index_-boxzone clearfix">',f=86,h="each boxZones as zone",c="<%for (var $art_izrnqbcjk$art_i = 0, $art_ckoqoce$art_c = boxZones.length; $art_izrnqbcjk$art_i < $art_ckoqoce$art_c; $art_izrnqbcjk$art_i++) {    var zone = boxZones[$art_izrnqbcjk$art_i]%>";for(var B=0,L=D.length;B<L;B++){var A=D[B];p+='<li class="_zs_gallery_mx-duration_index_-box fl" style="width: ',f=88,h="=boxWidth",p+=(c="<%=boxWidth%>",n(k)+"px; height: "),f=88,h="=boxHeight",p+=(c="<%=boxHeight%>",n(H)+"px; background-color: "),f=88,h="=zone.bg",p+=(c="<%=zone.bg%>",n(A.bg)+'" mx-click="'+t+"clickOutside({index:"),f=89,h="=zone.index",p+=(c="<%=zone.index%>",n(A.index)+'})" mx-mousedown="'+t+'select()" mx-mouseover="'+t+"showTip({index:"),f=91,h="=zone.index",p+=(c="<%=zone.index%>",n(A.index)+'})" mx-mouseout="'+t+"hideTip({index:"),f=92,h="=zone.index",p+=(c="<%=zone.index%>",n(A.index)+'})"></li>'),f=93,h="/each",c="<%}%>"}p+='</ul></div></div><div mxs="_zs_gallerybo:b" class="pt10 pb10 clearfix"><a class="btn btn-small mr10 fl" href="javascript:;" mx-click="'+t+'clear()">清空</a><a class="btn btn-small mr10 fl" href="javascript:;" mx-click="'+t+'reset()">重置</a><span class="fr lh28 color-c"><span class="_zs_gallery_mx-duration_index_-circle" style="background-color: rgba(97,199,242,0.7)"></span><span class="font-tahoma bold color-c mr15">30-100%</span><span class="_zs_gallery_mx-duration_index_-circle" style="background-color: rgba(77,166,255,0.7)"></span><span class="font-tahoma bold color-c mr15">100-200%</span><span class="_zs_gallery_mx-duration_index_-circle" style="background-color: rgba(134,115,230,0.7)"></span><span class="font-tahoma bold color-c mr15">200-250%</span><i class="mc-iconfont displacement-2">&#xe705;</i><span class="mr10">可以拖拽鼠标选择投放时段</span></span></div></div>'}catch(e){var F="render view error:"+(e.message||e);throw h&&(F+="\r\n\tsrc art:{{"+h+"}}\r\n\tat line:"+f),F+="\r\n\t"+(h?"translate to:":"expr:"),F+=c+"\r\n\tat file:mx-duration/index.html"}return p},mixins:[o,i],init:function(e){var t=this,r=/^true$/i.test(e.half),n=e.width||780,o=e.selected||a.none,i=r?2:1;n&&+n<780&&(n=780);var s=24*i,d=n/(25*i),l=7*s;t.updater.set({viewId:t.id,timeDiscount:o,weeks:["一","二","三","四","五","六","日"],ranges:["00:00 - 06:00","06:00 - 12:00","12:00 - 18:00","18:00 - 24:00"],multiple:i,maxWidth:n,rowNum:s,columnNum:7,headerHeight:60,boxWidth:d,boxHeight:40,boxLength:l,boxZones:t.getBoxzone(l),valid:"",maskInfo:{show:!1,left:0,top:0,width:0,height:0,startRow:0,endRow:0,startColumn:0,endColumn:0,selectedZones:[]},settingInfo:{show:!1,week:"",time:"",discount:"",type:1},hoverInfo:{show:!1,left:0,top:0,week:"",time:"",discount:""}}),t.discountColorMap=t.getColorMap(),t.on("destroy",function(){$(document.body).off("mousemove.duration"),$(document.body).off("mouseup.duration"),clearTimeout(t.hoverTimeout),clearTimeout(t.hideTimeout)})},render:function(){for(var e=this.updater,t=e.get("timeDiscount"),r=e.get("boxLength"),n=this.report2Array(t),o=0;o<r;o++)this.setBoxDiscount(o,n[o]);this.updater.digest(),this.wrapper=$("#"+this.id+"_duration")},report2Array:function(e){for(var t=[],r=this.updater,n=r.get("rowNum"),o=r.get("multiple"),i=e.split(";"),a=0,s=i.length;a<s;a++)for(var d=i[a].split(","),l=0,_=d.length;l<_;l++)if("0"!=d[l]){var u=d[l].match(/(\d{2}):(\d{2})-(\d{2}):(\d{2}):(\d+)/),g=parseInt(u[1])*o+n*a;"30"==u[2]&&g++;var m=parseInt(u[3])*o+n*a;"30"==u[4]&&m++;for(var x=parseInt(u[5]),c=g;c<=m-1;c++)t[c]=x}return t},setBoxDiscount:function(e,t){t=parseInt(t)||0;var r=this.discountColorMap[t],n=this.updater.get("boxZones");n[e].bg=r,n[e].discount=t,this.updater.set({boxZones:n})},"select<mousedown>":function(e){e.preventDefault();var t=this,r=t.updater,n=r.get("hoverInfo"),o=r.get("settingInfo"),i=r.get("maskInfo"),a=r.get("boxWidth"),s=r.get("multiple"),d=r.get("headerHeight");n.show=!1,o.show=!1;var l=t.wrapper,_=l.offset().left,u=l.offset().top,g=e.pageX-_,m=e.pageY-u;$(document.body).off("mousemove.duration").on("mousemove.duration",function(e){e.preventDefault();var r=e.pageX-_,x=e.pageY-u,c=Math.min(r,l.outerWidth()),h=Math.min(x,l.outerHeight()),f=Math.max(a*s,Math.min(g,c)),p=Math.max(d,Math.min(m,h));i.left=f,i.top=p+1,i.width=Math.max(g,c)-f,i.height=Math.max(m,h)-p,i.show=!0,t.updater.digest({hoverInfo:n,settingInfo:o,maskInfo:i})}),$(document.body).off("mouseup.duration").on("mouseup.duration",function(e){i.show&&(e.preventDefault(),$(document.body).off("mousemove.duration"),t.selectEnd(),$(document.body).off("mouseup.duration"))})},selectEnd:function(e){for(var t=this.updater,r=t.get("maskInfo"),n=t.get("headerHeight"),o=t.get("boxHeight"),i=t.get("boxWidth"),a=t.get("multiple"),s=t.get("columnNum"),d=t.get("rowNum"),l=parseInt((r.top-n)/o),_=parseInt((r.height+r.top-n)/o),u=parseInt((r.left-i*a)/i),g=parseInt((r.width+r.left-i*a)/i),m=Math.max(0,l),x=Math.min(s-1,_),c=Math.max(0,u),h=Math.min(d-1,g),f=[],p=m;p<=x;p++)for(var b=c;b<=h;b++)f.push(p*d+b);r.selectedZones=f,r.startRow=m,r.endRow=x,r.startColumn=c,r.endColumn=h,r.left=i*a+c*i,r.top=n+m*o+1,r.width=(h-c+1)*i,r.height=(x-m+1)*o,r.show=!0,this.showSetting()},"clickOutside<click>":function(e){var t=+e.params.index,r=this.updater.get("maskInfo");!r.show||r.show&&r.selectedZones.indexOf(t)>-1||(e.preventDefault(),$(document.body).off("mousemove.duration"),$(document.body).off("mouseup.duration"),$(document.body).off("click.duration"),this["cancelSetting<click>"]())},"changeSettingType<change>":function(e){var t=this.updater,r=t.get("settingInfo");r.type=e.params.type,t.digest({settingInfo:r})},"submitSetting<click>":function(){var e=this.updater.get(),t=e.settingInfo,r=e.maskInfo,n=0,o=!0;switch(+t.type){case 1:o=this.isValid(),n=this.fromKeys(e,"settingInfo").settingInfo.discount;break;case 2:n=100;break;case 3:n=0}if(o){t.show=!1,t.type=1,r.show=!1;for(var i=0;i<r.selectedZones.length;i++)this.setBoxDiscount(r.selectedZones[i],n);this.updater.digest({settingInfo:t,maskInfo:r})}},"cancelSetting<click>":function(){var e=this.updater,t=e.get("settingInfo"),r=e.get("maskInfo");r.show=!1,t.show=!1,t.type=1,this.updater.digest({settingInfo:t,maskInfo:r})},showSetting:function(){var e,t=this.updater,r=t.get("settingInfo"),n=t.get("maskInfo"),o=t.get("boxZones"),i=n.startRow+1,a=n.endRow+1;e=i!=a?this.formatweek(i)+" - "+this.formatweek(a):this.formatweek(i),r.week=e,r.time=this.getDuration(n.startColumn,n.endColumn+1,"%s - %s");for(var s,d=n.selectedZones,l=!0,_=0;_<d.length;_++){var u=o[d[_]].discount;if(!u||s&&u!=s){l=!1;break}s=u}r.discount=l?s:"";var g=this.wrapper.outerWidth(),m=this.wrapper.outerHeight(),x=n.left+n.width/2;x+260>g&&(x-=260);var c=n.top+n.height/2;c+238>m+100&&(c-=238),r.left=x,r.top=c,r.show=!0,this.updater.digest({boxZones:o,settingInfo:r,maskInfo:n})},"showTip<mouseover>":function(e){if(!n.inside(e.relatedTarget,e.eventTarget)){var t=this;clearTimeout(t.hoverTimeout),clearTimeout(t.hideTimeout);var r=t.updater,o=r.get("settingInfo");if(!r.get("maskInfo").show&&!o.show){var i=r.get("boxWidth"),a=r.get("boxHeight"),s=r.get("headerHeight"),d=r.get("rowNum"),l=r.get("hoverInfo"),_=r.get("boxZones");t.hoverTimeout=setTimeout(function(){var n=parseInt(e.params.index),o=i+(n%d+1)*i,u=s+(parseInt(n/d)+1)*a,g=t.formatweek(parseInt(n/d)+1),m=t.getDuration(n,n+1,"%s - %s"),x=_[n].discount;l.left=o,l.top=u,l.week=g,l.time=m,l.discount=x,l.show=!0,r.digest({hoverInfo:l})},200)}}},"hideTip<mouseout>":function(e){if(!n.inside(e.relatedTarget,e.eventTarget)){var t=this;clearTimeout(t.hoverTimeout),clearTimeout(t.hideTimeout);var r=t.updater;t.hideTimeout=setTimeout(function(){var e=r.get("hoverInfo");e.show=!1,t.updater.digest({hoverInfo:e})},200)}},"reset<click>":function(e){for(var t=this.updater.get("boxLength"),r=0;r<t;r++)this.setBoxDiscount(r,100);this.updater.digest()},"clear<click>":function(e){for(var t=this.updater.get("boxLength"),r=0;r<t;r++)this.setBoxDiscount(r,0);this.updater.digest()},array2Report:function(e){for(var t=this,r=t.updater,n=r.get("columnNum"),o=r.get("rowNum"),i=(r.get("multiple"),[]),a=0;a<n;a++){i[a]=0;for(var s=[],d=0;d<o;d++){var l=e[a*o+d];if(l){var _=s[s.length-1];_&&_.discount==l&&_.end==d?_.end=d+1:s.push({start:d,end:d+1,discount:l})}}var u=s.map(function(e){return t.getDuration(e.start,e.end)+":"+e.discount});u&&u.length>0&&(i[a]=u.join(","))}return i.join(";")},submit:function(){var e=this.updater.get("boxZones").map(function(e){return e.discount}),t=this.array2Report(e);return t==a.none?{ok:!1}:{ok:!0,val:t}},update:function(e){for(var t=this.updater.get(),r=(e=t.timeDiscount,t.boxLength),n=this.report2Array(e),o=0;o<r;o++)this.setBoxDiscount(o,n[o])},formatweek:function(e){return"星期"+["日","一","二","三","四","五","六"][e%7]},getDuration:function(e,t,r){var n=this.updater.get("rowNum"),o=this.getTimeFromNum(e),i="",a=o+"-"+(i=t%n==0?"24:00":this.getTimeFromNum(t));return r&&(a=r.replace("%s",o).replace("%s",i)),a},getTimeFromNum:function(e){var t=this.updater.get(),r=t.rowNum,n=t.multiple,o=Math.floor(e%r/n);return 1==(o+"").length&&(o="0"+o),o+":"+(e%r%n==1?"30":"00")},getBoxzone:function(e){for(var t=[],r=0;r<e;r++)t.push({index:r,bg:"#ffffff",discount:0});return t},getColorMap:function(e){for(var t={"[0,1)":"#ffffff","[30,40)":"rgba(97,199,242,0.05)","[40,50)":"rgba(97,199,242,0.1)","[50,60)":"rgba(97,199,242,0.15)","[60,70)":"rgba(97,199,242,0.2)","[70,80)":"rgba(97,199,242,0.25)","[80,90)":"rgba(97,199,242,0.3)","[90,100)":"rgba(97,199,242,0.35)","[100,101)":"rgba(97,199,242,0.4)","[101,110)":"rgba(77,166,255,0.15)","[110,120)":"rgba(77,166,255,0.2)","[120,130)":"rgba(77,166,255,0.25)","[130,140)":"rgba(77,166,255,0.3)","[140,150)":"rgba(77,166,255,0.35)","[150,160)":"rgba(77,166,255,0.4)","[160,170)":"rgba(77,166,255,0.45)","[170,180)":"rgba(77,166,255,0.5)","[180,190)":"rgba(77,166,255,0.55)","[190,200)":"rgba(77,166,255,0.6)","[200,210)":"rgba(134,115,230,0.3)","[210,220)":"rgba(134,115,230,0.35)","[220,230)":"rgba(134,115,230,0.4)","[230,240)":"rgba(134,115,230,0.45)","[240,250)":"rgba(134,115,230,0.5)","[250,251)":"rgba(134,115,230,0.55)"},r={},n=0;n<=250;n++)for(var o in r[n]="#ffffff",t){var i=o.substring(1,o.length-1).split(","),a=i[0],s=i[1];if(n>=a&&n<s){r[n]=t[o];break}}return r}})});