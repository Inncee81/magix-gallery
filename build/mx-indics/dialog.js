define("mx-indics/dialog",["magix","mx-popover/index","mx-dragsort/index"],(e,i,n)=>{e("mx-popover/index"),e("mx-dragsort/index");var t=e("magix");t.applyStyle("_zs_gallery_mx-indics_index_",'._zs_gallery_mx-indics_index_-setting {\n  position: relative;\n  height: 100%;\n}\n._zs_gallery_mx-indics_index_-setting ._zs_gallery_mx-indics_index_-header {\n  width: 100%;\n  height: 60px;\n  padding: 0 24px;\n  background-color: #fff;\n  line-height: 60px;\n  border-bottom: 1px solid var(--color-border);\n}\n._zs_gallery_mx-indics_index_-setting ._zs_gallery_mx-indics_index_-content {\n  position: absolute;\n  top: 60px;\n  left: 0;\n  bottom: 0;\n  right: 0;\n  overflow-y: auto;\n}\n._zs_gallery_mx-indics_index_-setting ._zs_gallery_mx-indics_index_-content ._zs_gallery_mx-indics_index_-line {\n  position: relative;\n  padding: 16px 24px;\n}\n._zs_gallery_mx-indics_index_-setting ._zs_gallery_mx-indics_index_-content ._zs_gallery_mx-indics_index_-line:nth-of-type(even) {\n  background-color: var(--color-bg);\n}\n._zs_gallery_mx-indics_index_-setting ._zs_gallery_mx-indics_index_-content ._zs_gallery_mx-indics_index_-name {\n  position: absolute;\n  top: 16px;\n  left: 24px;\n  width: 90px;\n  padding: 8px 0;\n  color: #999;\n}\n._zs_gallery_mx-indics_index_-setting ._zs_gallery_mx-indics_index_-content ._zs_gallery_mx-indics_index_-item {\n  float: left;\n  padding: 8px 0;\n  white-space: nowrap;\n}\n._zs_gallery_mx-indics_index_-setting ._zs_gallery_mx-indics_index_-content ._zs_gallery_mx-indics_index_-item ._zs_gallery_mx-indics_index_-field-tip {\n  position: relative;\n  top: 1px;\n  left: 1px;\n  font-size: 14px;\n  color: #ccc;\n}\n._zs_gallery_mx-indics_index_-setting._zs_gallery_mx-indics_index_-parent ._zs_gallery_mx-indics_index_-line {\n  padding-left: 122px;\n}\n._zs_gallery_mx-indics_index_-setting._zs_gallery_mx-indics_index_-sortable {\n  padding-right: 240px;\n}\n._zs_gallery_mx-indics_index_-setting._zs_gallery_mx-indics_index_-sortable ._zs_gallery_mx-indics_index_-content {\n  right: 240px;\n  border-right: 1px solid var(--color-border);\n}\n._zs_gallery_mx-indics_index_-setting._zs_gallery_mx-indics_index_-sortable ._zs_gallery_mx-indics_index_-drag-header {\n  position: absolute;\n  top: 0;\n  right: 0;\n  width: 240px;\n  height: 98px;\n}\n._zs_gallery_mx-indics_index_-setting._zs_gallery_mx-indics_index_-sortable ._zs_gallery_mx-indics_index_-drag-header ._zs_gallery_mx-indics_index_-drag-title {\n  height: 60px;\n  line-height: 60px;\n  font-size: 16px;\n  padding-left: 24px;\n  border-bottom: 1px solid var(--color-border);\n}\n._zs_gallery_mx-indics_index_-setting._zs_gallery_mx-indics_index_-sortable ._zs_gallery_mx-indics_index_-drag-header ._zs_gallery_mx-indics_index_-drag-oper {\n  height: 38px;\n  padding: 0 24px;\n  line-height: 38px;\n  text-align: right;\n  background-color: var(--color-bg);\n}\n._zs_gallery_mx-indics_index_-setting._zs_gallery_mx-indics_index_-sortable ._zs_gallery_mx-indics_index_-drag-wrapper {\n  position: absolute;\n  top: 98px;\n  right: 0;\n  bottom: 0;\n  width: 240px;\n  padding: 0 24px 16px 24px;\n  overflow-y: scroll;\n  background-color: var(--color-bg);\n}\n._zs_gallery_mx-indics_index_-setting._zs_gallery_mx-indics_index_-sortable ._zs_gallery_mx-indics_index_-drag-wrapper ._zs_gallery_mx-indics_index_-drag {\n  height: 30px;\n  margin-bottom: 5px;\n  padding: 0 15px;\n  line-height: 28px;\n  background: #fff;\n  border: 1px solid var(--color-border);\n  border-radius: var(--border-radius);\n  cursor: move;\n}\n._zs_gallery_mx-indics_index_-setting._zs_gallery_mx-indics_index_-sortable ._zs_gallery_mx-indics_index_-drag-wrapper ._zs_gallery_mx-indics_index_-drag:last-child {\n  margin-bottom: 0;\n}\n._zs_gallery_mx-indics_index_-setting-show-btn {\n  display: inline-block;\n  width: 40px;\n  padding-right: 10px;\n  margin-right: 10px;\n  text-align: center;\n}\n._zs_gallery_mx-indics_index_-setting-show-btn ._zs_gallery_mx-indics_index_-setting-show-icon {\n  position: relative;\n  top: 2px;\n  font-size: 18px;\n}\n._zs_gallery_mx-indics_index_-setting-switch-btn {\n  display: inline-block;\n  width: auto;\n}\n[mx-view*="mx-indics/index"] {\n  display: inline-block;\n  vertical-align: middle;\n}\n[mx-view*="mx-indics/index"]:hover ._zs_gallery_mx-indics_index_-setting-show-btn {\n  border-color: var(--border-highlight-hover);\n  color: #333;\n}\n[mx-view*="mx-indics/index"]:hover ._zs_gallery_mx-indics_index_-setting-switch-btn {\n  border-color: var(--border-highlight-hover);\n  color: #333;\n}\n[mx-view*="mx-indics/index"]:hover ._zs_gallery_mx-indics_index_-setting-switch-btn ._zs_gallery_mx-indics_index_-setting-switch-icon {\n  color: var(--border-highlight-hover);\n}\n'),n.exports=t.View.extend({tmpl:function(e,i,n,t,l,r,_,a){if(n||(n=e),!l){var s={"&":"amp","<":"lt",">":"gt",'"':"#34","'":"#39","`":"#96"},d=/[&<>"'`]/g,c=function(e){return"&"+s[e]+";"};l=function(e){return""+(null==e?"":e)},t=function(e){return l(e).replace(d,c)}}if(!r){var x={"!":"%21","'":"%27","(":"%28",")":"%29","*":"%2A"},o=function(e){return x[e]},g=/[!')(*]/g;r=function(e){return encodeURIComponent(l(e)).replace(g,o)}}if(!a){var m=/[\\'"]/g;a=function(e){return l(e).replace(m,"\\$&")}}var p,h,f,v="",u=e.sortable,y=e.hasParent,b=e.limit,z=e.selectedItems,$=e.groups,w=e.width;try{v+='<div mxv class="_zs_gallery_mx-indics_index_-setting ',f=1,h="if sortable",p="<%if (sortable) {%>",u&&(v+="_zs_gallery_mx-indics_index_-sortable",f=1,h="/if",p="<%}%>"),v+=" ",f=1,h="if hasParent",p="<%if (hasParent) {%>",y&&(v+="_zs_gallery_mx-indics_index_-parent",f=1,h="/if",p="<%}%>"),v+='"><div mxa="_zs_gallerycQ:_" class="_zs_gallery_mx-indics_index_-header"><span mxs="_zs_gallerycQ:_" class="fontsize-16">选择数据字段</span>',f=4,h="if (limit > 0)",p="<%if (limit > 0) {%>",b>0&&(v+='<span mxa="_zs_gallerycQ:a" class="color-9 font-tahoma bold ml10">',f=5,h="=selectedItems.length",v+=(p="<%=selectedItems.length%>",t(z.length)+" / "),f=5,h="=limit",v+=(p="<%=limit%>",t(b)+"</span>"),f=6,h="/if",p="<%}%>"),v+=" ",f=7,h="if !sortable",p="<%if (!sortable) {%>",u||(v+='<a mxs="_zs_gallerycQ:a" href="javascript:;" class="link-brand fr" mx-click="'+i+'clear()"><i class="mc-iconfont displacement-2">&#xe72e;</i>清空</a>',f=11,h="/if",p="<%}%>"),v+='</div><div mxv mxa="_zs_gallerycQ:b" class="_zs_gallery_mx-indics_index_-content">',f=14,h="each groups as group",p="<%for (var $art_ixeorovpd$art_i = 0, $art_ckoiljm$art_c = groups.length; $art_ixeorovpd$art_i < $art_ckoiljm$art_c; $art_ixeorovpd$art_i++) {    var group = groups[$art_ixeorovpd$art_i]%>";for(var k=0,I=$.length;k<I;k++){var j=$[k];v+='<div mxv mxa="_zs_gallerycQ:c" class="_zs_gallery_mx-indics_index_-line clearfix">',f=16,h="if group.text",p="<%if (group.text) {%>",j.text&&(v+='<div mxa="_zs_gallerycQ:d" class="_zs_gallery_mx-indics_index_-name">',f=17,h="=group.text",v+=(p="<%=group.text%>",t(j.text)+"</div>"),f=18,h="/if",p="<%}%>"),v+='<div mxv mxa="_zs_gallerycQ:e" class="clearfix">',f=20,h="each group.fields as field",p="<%for (var $art_iyoorglq$art_i = 0, $art_objpsoumcjllg$art_obj = group.fields, $art_cfaleknbxw$art_c = $art_objpsoumcjllg$art_obj.length; $art_iyoorglq$art_i < $art_cfaleknbxw$art_c; $art_iyoorglq$art_i++) {        var field = $art_objpsoumcjllg$art_obj[$art_iyoorglq$art_i]%>";for(var Q=0,q=j.fields,P=q.length;Q<P;Q++){var E=q[Q];v+='<div mxv class="_zs_gallery_mx-indics_index_-item" style="width: ',f=21,h="=width",v+=(p="<%=width%>",t(w)+';"><label mxv '),f=22,h="if ((limit > 0) && (selectedItems.length >= limit) && !field.checked)",p="<%if ((limit > 0) && (selectedItems.length >= limit) && !field.checked) {%>",b>0&&z.length>=b&&!E.checked&&(v+=' class="cursor-not-allow" ',f=22,h="/if",p="<%}%>"),v+='><input type="checkbox" name="field" value="',f=23,h="=field.value",v+=(p="<%=field.value%>",t(E.value)+'" class="checkbox" '),f=24,h="if field.checked",p="<%if (field.checked) {%>",E.checked&&(v+=' checked="true" ',f=24,h="/if",p="<%}%>"),v+=" ",f=25,h="if ((limit > 0) && (selectedItems.length >= limit) && !field.checked)",p="<%if ((limit > 0) && (selectedItems.length >= limit) && !field.checked) {%>",b>0&&z.length>=b&&!E.checked&&(v+=' disabled="true" ',f=25,h="/if",p="<%}%>"),v+=' mx-change="'+i+"toggle({value:'",f=26,h="=field.value",v+=(p="<%=$eq(field.value)%>",t(a(E.value))+"',text:'"),f=26,h="=field.text",v+=(p="<%=$eq(field.text)%>",t(a(E.text))+"'})\"/>"),f=26,h="=field.text",v+=(p="<%=field.text%>",t(E.text)+"</label>"),f=28,h="if field.tip",p="<%if (field.tip) {%>",E.tip&&(v+='<i class="mc-iconfont _zs_gallery_mx-indics_index_-field-tip" mx-view="mx-popover/index?width=240&content=',f=32,h="=field.tip",v+=(p="<%!$eu(field.tip)%>",r(E.tip)+'">&#xe7aa;</i>'),f=33,h="/if",p="<%}%>"),v+="</div>",f=35,h="/each",p="<%}%>"}v+="</div></div>",f=38,h="/each",p="<%}%>"}if(v+="</div>",f=40,h="if sortable",p="<%if (sortable) {%>",u){v+='<div mxs="_zs_gallerycQ:b" class="_zs_gallery_mx-indics_index_-drag-header"><div class="_zs_gallery_mx-indics_index_-drag-title">自定义字段</div><div class="_zs_gallery_mx-indics_index_-drag-oper"><span class="color-9 mr10">可拖动排序</span><a href="javascript:;" class="link-brand" mx-click="'+i+'clear()"><i class="mc-iconfont displacement-2">&#xe72e;</i>清空</a></div></div><div mxa="_zs_gallerycQ:f" class="_zs_gallery_mx-indics_index_-drag-wrapper" mx-view="mx-dragsort/index" mx-dragfinish="'+i+'drag()">',f=49,h="each selectedItems as s",p="<%for (var $art_iarjctbl$art_i = 0, $art_cecxhibc$art_c = selectedItems.length; $art_iarjctbl$art_i < $art_cecxhibc$art_c; $art_iarjctbl$art_i++) {        var s = selectedItems[$art_iarjctbl$art_i]%>";for(var M=0,V=z.length;M<V;M++){var A=z[M];v+='<div class="_zs_gallery_mx-indics_index_-drag" data-value="',f=50,h="=s.value",v+=(p="<%=s.value%>",t(A.value)+'" data-text="'),f=50,h="=s.text",v+=(p="<%=s.text%>",t(A.text)+'">'),f=50,h="=s.text",v+=(p="<%=s.text%>",t(A.text)+"</div>"),f=51,h="/each",p="<%}%>"}v+="</div>",f=53,h="/if",p="<%}%>"}v+="</div>"}catch(e){var C="render view error:"+(e.message||e);throw h&&(C+="\r\n\tsrc art:{{"+h+"}}\r\n\tat line:"+f),C+="\r\n\t"+(h?"translate to:":"expr:"),C+=p+"\r\n\tat file:mx-indics/dialog.html"}return v},init:function(e){var i=e.selected||[],n=e.fields||[],t=e.parents||[];selectedItems=[],i.forEach(function(e){for(var i=0;i<n.length;i++){var t=n[i];if(t.value==e){t.checked=!0,selectedItems.push({value:t.value,text:t.text});break}}});var l,r=e.lineNumber,_=[];if(t.length>0)_=t.map(function(e){var i=[];return n.forEach(function(n){n.pValue==e.value&&i.push(n)}),{text:e.text,fields:i}}),l=!0;else{for(var a=Math.ceil(n.length/r),s=0;s<a;s++){var d={fields:n.slice(s*r,(s+1)*r)};_.push(d)}l=!1}this.updater.set({width:Math.floor(100/r)+"%",hasParent:l,sortable:e.sortable,fields:n,groups:_,selectedItems:selectedItems,limit:e.limit}),this.viewOptions=e},render:function(){this.updater.digest({})},"toggle<change>":function(e){for(var i=e.target.checked,n=e.params.value,t=e.params.text,l=this.updater,r=l.get("fields"),_=0;_<r.length;_++)if(r[_].value==n){r[_].checked=i;break}var a=l.get("selectedItems"),s=l.get("sortable");if(i)s?a.push({value:n,text:t}):a=r.filter(function(e){return e.checked});else for(_=0;_<a.length;_++)if(a[_].value==n){a.splice(_,1);break}l.digest({fields:r,selectedItems:a})},"drag<dragfinish>":function(e){for(var i=[],n=$("#"+this.id+" ._zs_gallery_mx-indics_index_-drag"),t=0,l=n.length;t<l;t++){var r=$(n[t]);i.push({value:r.data("value"),text:r.data("text")})}this.updater.digest({selectedItems:i})},"clear<click>":function(){var e=this.updater,i=e.get("fields");i.forEach(function(e){e.checked=!1}),e.digest({fields:i,selectedItems:[]})},check:function(){event.preventDefault();var e=this.updater.get("selectedItems").map(function(e){return e.value});return new Promise(function(i){i({ok:e.length>0,msg:"请至少选择一个指标",data:{selected:e}})})}})});