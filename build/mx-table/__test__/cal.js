define("mx-table/__test__/cal",["magix","__test__/example","$"],(t,l,a)=>{var r=t("magix"),n=t("__test__/example"),e=t("$");r.applyStyle("_zs_gallery_mx-table___test___cal_","._zs_gallery_mx-table___test___cal_-custom {\n  width: 600px;\n  border: 1px solid var(--color-border);\n}\n._zs_gallery_mx-table___test___cal_-custom tbody td {\n  padding: 8px!important;\n  background-color: transparent!important;\n  border-right: 1px solid var(--color-border);\n}\n._zs_gallery_mx-table___test___cal_-tag {\n  display: inline-block;\n  margin: 0 4px;\n  padding: 0 4px;\n  height: 20px;\n  line-height: 16px;\n  background-color: var(--color-bg);\n  border: 1px solid var(--color-border);\n  text-align: center;\n  border-radius: 2px;\n  overflow: hidden;\n  vertical-align: middle;\n}\n._zs_gallery_mx-table___test___cal_-prefix {\n  width: 30px;\n}\n"),a.exports=n.extend({tmpl:function(t,l,a,r,n,e,s,d){if(a||(a=t),!n){var _={"&":"amp","<":"lt",">":"gt",'"':"#34","'":"#39","`":"#96"},o=/[&<>"'`]/g,c=function(t){return"&"+_[t]+";"};n=function(t){return""+(null==t?"":t)},r=function(t){return n(t).replace(o,c)}}if(!e){var p={"!":"%21","'":"%27","(":"%28",")":"%29","*":"%2A"},i=function(t){return p[t]},x=/[!')(*]/g;e=function(t){return encodeURIComponent(n(t)).replace(x,i)}}if(!d){var m=/[\\'"]/g;d=function(t){return n(t).replace(m,"\\$&")}}var b,g,v,f="",w=t.viewId,h=t.rows;try{f+='<div mxa="_zs_galleryeD:_" class="mb20"><div mxs="_zs_galleryeD:_" class="mb10">1. 原始表格：当前4*4的表格，x坐标的取值范围【0-3】，y的取值范围【0-3】</div><div mxa="_zs_galleryeD:a" class="pl15"><table class="table _zs_gallery_mx-table___test___cal_-custom" id="',v=5,g="=viewId",f+=(b="<%=viewId%>",r(w)+'_table"><tbody mxs="_zs_galleryeD:a"><tr><td rowspan="2">A</td><td>B</td><td rowspan="2">C</td><td>D</td></tr><tr><td rowspan="3">E</td><td>F</td></tr><tr><td>G</td><td>H</td><td>I</td></tr><tr><td>J</td><td colspan="2">L</td></tr></tbody></table></div></div><div mxs="_zs_galleryeD:b" class="mb20"><div class="mb10">2. 根据属性<span class="_zs_gallery_mx-table___test___cal_-tag">colspan</span>得到单元格相对于当前行的相对位置<span class="_zs_gallery_mx-table___test___cal_-tag">x</span>，后一行的位置等于<span class="_zs_gallery_mx-table___test___cal_-tag">prevRow.x + prevRow.colspan</span>，第一次计算得到以下结果：</div><div class="pl15"><table class="table _zs_gallery_mx-table___test___cal_-custom mb10"><tbody><tr><td>(0,0)<span class="color-brand ml10">A</span></td><td>(1,0)<span class="color-brand ml10">B</span></td><td>(2,0)<span class="color-brand ml10">C</span></td><td>(3,0)<span class="color-brand ml10">D</span></td></tr><tr><td>(0,1)<span class="color-brand ml10">E</span></td><td>(1,1)<span class="color-brand ml10">F</span></td><td>(2,1)</td><td>(3,1)</td></tr><tr><td>(0,2)<span class="color-brand ml10">G</span></td><td>(1,2)<span class="color-brand ml10">H</span></td><td>(2,2)<span class="color-brand ml10">I</span></td><td>(3,2)</td></tr><tr><td>(0,3)<span class="color-brand ml10">J</span></td><td>(1,3)<span class="color-brand ml10">L</span></td><td>(2,3)</td><td>(3,3)</td></tr></tbody></table><pre class="tip-content">\n// 二维数组\nlet rows = [];\n\n// 计算同一行的x位置\nfor (let i = 0; i &lt; trs.length; i++) &#123;\n    let tds = $(trs[i]).find(\'td\');\n\n    let gap = 0;\n    let row = [];\n    for (let j = 0; j &lt; tds.length; j++) &#123;\n        let td = tds.eq(j);\n        let colspan = +td.attr(\'colspan\') || 1,\n            rowspan = +td.attr(\'rowspan\') || 1;\n        row.push(&#123;\n            x: gap,\n            y: i,\n            colspan,\n            rowspan,\n            left: td.offset().left,  //用于判断位置\n            content: td.html()\n        &#125;)\n        gap = gap + colspan;\n    &#125;\n\n    rows.push(row);\n&#125;\n        </pre></div></div><div mxs="_zs_galleryeD:c" class="mb20"><div class="mb10">3. 可以从上表看出，由于<span class="_zs_gallery_mx-table___test___cal_-tag">rowspan</span>的存在，部分单元格在计算位置时存在偏差，分析可得，当前单元格存在rowspan时，以下两种情况的单元格需要进行移动：</div><div class="pl15"><div>1. 当前单元格后面的单元格</div><div class="mb10">2. 两行行差小于当前单元格的rowspan</div><pre class="tip-content">\n//计算 rowspan对后边行的影响\nfor (let rowIndex = 0; rowIndex &lt; rows.length - 1; rowIndex++) &#123;\n    let row = rows[rowIndex];\n    for (let cellIndex = 0; cellIndex &lt; row.length; cellIndex++) &#123;\n        let curCell = row[cellIndex];\n        if (curCell.rowspan &gt; 1) &#123;\n            // 后面行，left&lt;当前cell的位置进行移动\n            for (let nextRowIndex = rowIndex + 1; (nextRowIndex &lt; rows.length) && (curCell.rowspan &gt; nextRowIndex - rowIndex); nextRowIndex++) &#123;\n                let nextRow = rows[nextRowIndex];\n                for (let nextCellIndex = 0; nextCellIndex &lt; nextRow.length; nextCellIndex++) &#123;\n                    let nextCell = nextRow[nextCellIndex];\n                    if (nextCell.left &gt; curCell.left) &#123;\n                        nextCell.x += curCell.colspan;\n                    &#125;\n                &#125;\n            &#125;\n        &#125;\n    &#125;\n&#125;    \n        </pre></div></div><div><div mxs="_zs_galleryeD:d" class="mb10">4. 最终结果</div><div mxa="_zs_galleryeD:b" class="pl15 clearfix"><table mxs="_zs_galleryeD:e" class="table _zs_gallery_mx-table___test___cal_-custom fl"><tbody><tr><td>(0,0)<span class="color-brand ml10">A</span></td><td>(1,0)<span class="color-brand ml10">B</span></td><td>(2,0)<span class="color-brand ml10">C</span></td><td>(3,0)<span class="color-brand ml10">D</span></td></tr><tr><td>(0,1)</td><td>(1,1)<span class="color-brand ml10">E</span></td><td>(2,1)</td><td>(3,1)<span class="color-brand ml10">F</span></td></tr><tr><td>(0,2)<span class="color-brand ml10">G</span></td><td>(1,2)</td><td>(2,2)<span class="color-brand ml10">H</span></td><td>(3,2)<span class="color-brand ml10">I</span></td></tr><tr><td>(0,3)<span class="color-brand ml10">J</span></td><td>(1,3)</td><td>(2,3)<span class="color-brand ml10">L</span></td><td>(3,3)</td></tr></tbody></table><div mxa="_zs_galleryeD:c" class="fl ml20">'),v=151,g="each rows as row",b="<%for (var $art_ihldrghztf$art_i = 0, $art_cvyiyhcq$art_c = rows.length; $art_ihldrghztf$art_i < $art_cvyiyhcq$art_c; $art_ihldrghztf$art_i++) {    var row = rows[$art_ihldrghztf$art_i]%>";for(var y=0,u=h.length;y<u;y++){var z=h[y];f+=" ",v=152,g="each row as cell",b="<%for (var $art_irdwfdkrc$art_i = 0, $art_cspanxfplpc$art_c = row.length; $art_irdwfdkrc$art_i < $art_cspanxfplpc$art_c; $art_irdwfdkrc$art_i++) {        var cell = row[$art_irdwfdkrc$art_i]%>";for(var $=0,I=z.length;$<I;$++){var C=z[$];f+='<div mxa="_zs_galleryeD:d" class="clearfix"><div mxa="_zs_galleryeD:e" class="fl _zs_gallery_mx-table___test___cal_-prefix">',v=154,g="=cell.content",f+=(b="<%=cell.content%>",r(C.content)+'：</div><div mxa="_zs_galleryeD:f" class="fl">&#123;x: '),v=155,g="=cell.x",f+=(b="<%=cell.x%>",r(C.x)+", y: "),v=155,g="=cell.y",f+=(b="<%=cell.y%>",r(C.y)+"&#125;</div></div>"),v=157,g="/each",b="<%}%>"}f+=" ",v=158,g="/each",b="<%}%>"}f+="</div></div></div>"}catch(t){var D="render view error:"+(t.message||t);throw g&&(D+="\r\n\tsrc art:{{"+g+"}}\r\n\tat line:"+v),D+="\r\n\t"+(g?"translate to:":"expr:"),D+=b+"\r\n\tat file:mx-table/__test__/cal.html"}return f},render:function(){var t=this.id;this.updater.digest({viewId:t,rows:[]});for(var l=e("#"+t+"_table").find("tbody>tr"),a=[],r=0;r<l.length;r++){for(var n=e(l[r]).find("td"),s=0,d=[],_=0;_<n.length;_++){var o=n.eq(_),c=+o.attr("colspan")||1,p=+o.attr("rowspan")||1;d.push({x:s,y:r,colspan:c,rowspan:p,left:o.offset().left,content:o.html()}),s+=c}a.push(d)}for(var i=0;i<a.length-1;i++){d=a[i];for(var x=0;x<d.length;x++){var m=d[x];if(m.rowspan>1)for(var b=i+1;b<a.length&&m.rowspan>b-i;b++)for(var g=a[b],v=0;v<g.length;v++){var f=g[v];f.left>m.left&&(f.x+=m.colspan)}}}this.updater.digest({rows:a})}})});