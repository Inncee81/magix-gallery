define("mx-indics/dialog",["magix","mx-popover/index","mx-dragsort/index"],(e,l,a)=>{e("mx-popover/index"),e("mx-dragsort/index");var r=e("magix");r.applyStyle("_zs_galleryU",'._zs_gallerygp{box-shadow:0 2px 4px rgba(51,51,51,.08);border:1px solid #eee}[mx-view*="mx-indics/index"]{display:inline-block}._zs_gallerygq,._zs_gallerygr{position:relative;height:60px;padding:0 18px;background-color:#fff}._zs_gallerygr{line-height:60px;border-bottom:1px solid #e6e6e6}._zs_gallerygq{padding-top:14px;border-top:1px solid #e6e6e6}._zs_gallerygs{padding-right:32%}._zs_gallerygs ._zs_gallerygt{position:absolute;top:0;right:0;width:32%;height:100%;padding-left:18px}._zs_gallerygu{position:relative}._zs_gallerygu ._zs_gallerygv ._zs_gallerygw{padding:26px 18px}._zs_gallerygu ._zs_gallerygv ._zs_gallerygw:nth-of-type(2n){background-color:#fafafa}._zs_gallerygu ._zs_gallerygv ._zs_gallerygw ._zs_gallerygx{float:left;width:33%}._zs_gallerygu ._zs_gallerygv ._zs_gallerygw ._zs_gallerygx ._zs_gallerygy{position:relative;top:1px;left:4px;font-size:14px;color:#ccc}._zs_gallerygu._zs_gallerygs ._zs_gallerygv{min-height:316px;border-right:1px solid #e6e6e6}._zs_gallerygu._zs_gallerygs ._zs_gallerygt{background-color:#fafafa;padding-top:56px;padding-bottom:18px}._zs_gallerygu._zs_gallerygs ._zs_gallerygt ._zs_gallerygz{position:absolute;top:18px;left:18px;right:18px;text-align:right}._zs_gallerygu._zs_gallerygs ._zs_gallerygt ._zs_gallerygA{height:100%;overflow-y:scroll}._zs_gallerygu._zs_gallerygs ._zs_gallerygt ._zs_gallerygA ._zs_gallerygB{height:30px;margin-right:18px;margin-bottom:5px;padding:0 15px;line-height:28px;background:#fff;border:1px solid #e6e6e6;border-radius:4px;cursor:move}._zs_gallerygu._zs_gallerygs ._zs_gallerygt ._zs_gallerygA ._zs_gallerygB:last-child{margin-bottom:0}._zs_gallerygC{position:relative;color:#999}._zs_gallerygC:hover{color:#666;border-color:#ccc}._zs_gallerygC:focus{border-color:#ccc}._zs_gallerygD{margin-right:10px}._zs_gallerygD ._zs_gallerygE{position:relative;top:2px}._zs_gallerygF{padding-right:20px}._zs_gallerygF ._zs_gallerygG{position:absolute;top:0;right:0;width:20px;height:32px;line-height:32px;text-align:center;font-size:18px}'),a.exports=r.View.extend({tmpl:function(e,l,a,r,s,g,t,i){if(a||(a=e),!s){var _={"&":"amp","<":"lt",">":"gt",'"':"#34","'":"#39","`":"#96"},o=/[&<>"'`]/g,c=function(e){return"&"+_[e]+";"};s=function(e){return""+(null==e?"":e)},r=function(e){return s(e).replace(o,c)}}if(!g){var n={"!":"%21","'":"%27","(":"%28",")":"%29","*":"%2A"},d=function(e){return n[e]},p=/[!')(*]/g;g=function(e){return encodeURIComponent(s(e)).replace(p,d)}}if(!i){var z=/[\\'"]/g;i=function(e){return s(e).replace(z,"\\$&")}}var x="",v=e.sortable,y=e.limit,f=e.selectedItems,u=e.groups,h=e.error;x+='<div class="_zs_gallerygr ',v&&(x+="_zs_gallerygs"),x+='"><div mxa="_zs_gallerybz:_" class="_zs_gallerygv"><span mxs="_zs_gallerybz:_" class="fontsize-16">选择数据字段</span>',y>0&&(x+='<span mxa="_zs_gallerybz:a" class="color-9 font-tahoma bold ml10">'+r(f.length)+" / "+r(y)+"</span>"),x+=" ",v||(x+='<a mxs="_zs_gallerybz:a" href="javascript:;" class="link-brand fr" mx-click="'+l+'clear()"><i class="mc-iconfont displacement-2">&#xe72e;</i>清空</a>'),x+="</div>",v&&(x+='<div mxs="_zs_gallerybz:b" class="_zs_gallerygt"><span class="fontsize-16">自定义字段</span></div>'),x+='</div><div mxv class="_zs_gallerygu ',v&&(x+="_zs_gallerygs"),x+='"><div mxv mxa="_zs_gallerybz:b" class="_zs_gallerygv">';for(var m=0,b=u.length;m<b;m++){var k=u[m];x+='<div mxv mxa="_zs_gallerybz:c" class="_zs_gallerygw clearfix">';for(var w=0,I=k.length;w<I;w++){var A=k[w];x+='<div mxv mxa="_zs_gallerybz:d" class="_zs_gallerygx"><label mxv ',y>0&&f.length>=y&&!A.checked&&(x+=' class="cursor-not-allow" '),x+='><input type="checkbox" name="field" value="'+r(A.value)+'" class="checkbox" ',A.checked&&(x+=' checked="true" '),x+=" ",y>0&&f.length>=y&&!A.checked&&(x+=' disabled="true" '),x+=' mx-change="'+l+"toggle({value:'"+r(i(A.value))+"',text:'"+r(i(A.text))+"'})\"/>"+r(A.text)+"</label>",A.tip&&(x+='<i class="mc-iconfont _zs_gallerygy" mx-view="mx-popover/index?content='+g(A.tip)+'">&#xe629;</i>'),x+="</div>"}x+="</div>"}if(x+="</div>",v){x+='<div mxa="_zs_gallerybz:e" class="_zs_gallerygt"><div mxs="_zs_gallerybz:c" class="_zs_gallerygz"><span class="color-9 mr10">可拖动排序</span><a href="javascript:;" class="link-brand" mx-click="'+l+'clear()"><i class="mc-iconfont displacement-2">&#xe72e;</i>清空</a></div><div mxa="_zs_gallerybz:f" class="_zs_gallerygA" mx-view="mx-dragsort/index" mx-dragfinish="'+l+'drag()">';for(var j=0,B=f.length;j<B;j++){var C=f[j];x+='<div class="_zs_gallerygB" data-value="'+r(C.value)+'" data-text="'+r(C.text)+'">'+r(C.text)+"</div>"}x+="</div></div>"}return x+='</div><div mxa="_zs_gallerybz:g" class="_zs_gallerygq"><a mxs="_zs_gallerybz:d" href="javascript:;" class="min-width-60 btn btn-brand mr10" mx-click="'+l+'submit()">确定</a><a mxs="_zs_gallerybz:e" href="javascript:;" class="min-width-60 btn mr10" mx-click="'+l+'cancel()">取消</a>',h&&(x+='<span mxs="_zs_gallerybz:f" class="color-error"><i class="mc-iconfont displacement-2 mr5">&#xe6ad;</i>请至少选择一个指标</span>'),x+="</div>"},init:function(e){var l=e.selected||[],a=e.fields||[],r=[];l.forEach(function(e){for(var l=0;l<a.length;l++){var s=a[l];if(s.value==e){s.checked=!0,r.push({value:s.value,text:s.text});break}}});for(var s=[],g=Math.ceil(a.length/3),t=0;t<g;t++)s.push(a.slice(3*t,3*(t+1)));this.updater.set({fields:a,groups:s,selectedItems:r,limit:e.limit,sortable:e.sortable}),this.viewOptions=e},render:function(){this.updater.digest({})},"toggle<change>":function(e){for(var l=e.target.checked,a=e.params.value,r=e.params.text,s=this.updater,g=s.get("fields"),t=0;t<g.length;t++)if(g[t].value==a){g[t].checked=l;break}var i=s.get("selectedItems"),_=s.get("sortable");if(l)_?i.push({value:a,text:r}):i=g.filter(function(e){return e.checked});else for(t=0;t<i.length;t++)if(i[t].value==a){i.splice(t,1);break}s.digest({fields:g,selectedItems:i})},"drag<dragfinish>":function(e){for(var l=[],a=$("#"+this.id+" ._zs_gallerygB"),r=0,s=a.length;r<s;r++){var g=$(a[r]);l.push({value:g.data("value"),text:g.data("text")})}this.updater.digest({selectedItems:l})},"clear<click>":function(){var e=this.updater,l=e.get("fields");l.forEach(function(e){e.checked=!1}),e.digest({fields:l,selectedItems:[]})},"submit<click>":function(e){e.preventDefault();var l=this.updater.get("selectedItems");if(0!=l.length){var a=l.map(function(e){return e.value}),s=this.viewOptions;s.dialog&&s.dialog.close(),s.callback&&r.toTry(s.callback(a))}else this.updater.digest({error:!0})},"cancel<click>":function(e){e.preventDefault();var l=this.viewOptions;l.dialog&&l.dialog.close()}})});