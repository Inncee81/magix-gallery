define("mx-taginput/index",["magix","$","../mx-medusa/util","../mx-monitor/index"],(t,a,r)=>{var e=t("magix"),s=t("$"),n=t("../mx-medusa/util"),l=t("../mx-monitor/index");e.applyStyle("_zs_galleryaH",'._zs_gallerymK{box-shadow:0 1px 1px 0 rgba(0,0,0,.08);border:1px solid #f5f5f6}[mx-view*="mx-taginput/index"] ._zs_gallerymL{position:relative;height:auto;border:1px solid #e6e6e6;border-radius:4px;padding:2px 6px;cursor:text;transition:border-color .25s}[mx-view*="mx-taginput/index"] ._zs_gallerymL:hover{border-color:#ccc}[mx-view*="mx-taginput/index"] ._zs_gallerymL ._zs_gallerymM,[mx-view*="mx-taginput/index"] ._zs_gallerymL ._zs_gallerymN,[mx-view*="mx-taginput/index"] ._zs_gallerymL ._zs_gallerymO{height:22px;line-height:22px}[mx-view*="mx-taginput/index"] ._zs_gallerymL ._zs_gallerymN{position:absolute;left:10px;top:50%;margin-top:-11px;color:#999;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}[mx-view*="mx-taginput/index"] ._zs_gallerymL ._zs_gallerymM,[mx-view*="mx-taginput/index"] ._zs_gallerymL ._zs_gallerymO{float:left;margin-top:2px;margin-bottom:2px}[mx-view*="mx-taginput/index"] ._zs_gallerymL ._zs_gallerymM{float:left;position:relative;max-width:220px;padding-right:26px;padding-left:6px;margin-right:4px;background-color:#eee;border-radius:4px;cursor:pointer;white-space:nowrap;word-wrap:normal;overflow:hidden;text-overflow:ellipsis}[mx-view*="mx-taginput/index"] ._zs_gallerymL ._zs_gallerymM ._zs_gallerymP{position:absolute;top:0;right:0;height:100%;width:20px;line-height:22px;text-align:center;font-size:12px;font-weight:700;color:#ccc;transition:color .25s;border-left:1px solid #fff}[mx-view*="mx-taginput/index"] ._zs_gallerymL ._zs_gallerymM ._zs_gallerymP:hover{color:#999}[mx-view*="mx-taginput/index"] ._zs_gallerymL ._zs_gallerymO{padding:0;border:none;outline:none;background:transparent}[mx-view*="mx-taginput/index"][mx-disabled] ._zs_gallerymL{cursor:not-allowed;background-color:#fafafa;border-color:#e6e6e6}[mx-view*="mx-taginput/index"][mx-disabled] ._zs_gallerymL:hover{border-color:#e6e6e6}[mx-view*="mx-taginput/index"][mx-disabled] ._zs_gallerymM{cursor:not-allowed}[mx-view*="mx-taginput/index"][mx-disabled] ._zs_gallerymM ._zs_gallerymP:hover{color:#ccc}'),e.applyStyle("_zs_galleryaA","._zs_gallerylP{box-shadow:0 1px 1px 0 rgba(0,0,0,.08);border:1px solid #f5f5f6}@keyframes _zs_galleryz{0%{transform:translateY(-20%);-ms-transform:translateY(-20%);-moz-transform:translateY(-20%);-webkit-transform:translateY(-20%);-o-transform:translateY(-20%);opacity:0}to{transform:translate(0);-ms-transform:translate(0);-moz-transform:translate(0);-webkit-transform:translate(0);-o-transform:translate(0);opacity:1}}@-webkit-keyframes _zs_galleryz{0%{transform:translateY(-20%);-ms-transform:translateY(-20%);-moz-transform:translateY(-20%);-webkit-transform:translateY(-20%);-o-transform:translateY(-20%);opacity:0}to{transform:translate(0);-ms-transform:translate(0);-moz-transform:translate(0);-webkit-transform:translate(0);-o-transform:translate(0);opacity:1}}@keyframes _zs_galleryA{0%{transform:translateY(20%);-ms-transform:translateY(20%);-moz-transform:translateY(20%);-webkit-transform:translateY(20%);-o-transform:translateY(20%);opacity:0}to{transform:translate(0);-ms-transform:translate(0);-moz-transform:translate(0);-webkit-transform:translate(0);-o-transform:translate(0);opacity:1}}@-webkit-keyframes _zs_galleryA{0%{transform:translateY(20%);-ms-transform:translateY(20%);-moz-transform:translateY(20%);-webkit-transform:translateY(20%);-o-transform:translateY(20%);opacity:0}to{transform:translate(0);-ms-transform:translate(0);-moz-transform:translate(0);-webkit-transform:translate(0);-o-transform:translate(0);opacity:1}}@keyframes _zs_galleryB{0%{transform:translate(0);-ms-transform:translate(0);-moz-transform:translate(0);-webkit-transform:translate(0);-o-transform:translate(0)}25%{transform:translateY(-15%);-ms-transform:translateY(-15%);-moz-transform:translateY(-15%);-webkit-transform:translateY(-15%);-o-transform:translateY(-15%)}75%{transform:translateY(15%);-ms-transform:translateY(15%);-moz-transform:translateY(15%);-webkit-transform:translateY(15%);-o-transform:translateY(15%)}to{transform:translate(0);-ms-transform:translate(0);-moz-transform:translate(0);-webkit-transform:translate(0);-o-transform:translate(0)}}@-webkit-keyframes _zs_galleryB{0%{transform:translate(0);-ms-transform:translate(0);-moz-transform:translate(0);-webkit-transform:translate(0);-o-transform:translate(0)}25%{transform:translateY(-15%);-ms-transform:translateY(-15%);-moz-transform:translateY(-15%);-webkit-transform:translateY(-15%);-o-transform:translateY(-15%)}75%{transform:translateY(15%);-ms-transform:translateY(15%);-moz-transform:translateY(15%);-webkit-transform:translateY(15%);-o-transform:translateY(15%)}to{transform:translate(0);-ms-transform:translate(0);-moz-transform:translate(0);-webkit-transform:translate(0);-o-transform:translate(0)}}@keyframes _zs_galleryC{0%{transform:translate(0);-ms-transform:translate(0);-moz-transform:translate(0);-webkit-transform:translate(0);-o-transform:translate(0)}25%{transform:translateY(2px);-ms-transform:translateY(2px);-moz-transform:translateY(2px);-webkit-transform:translateY(2px);-o-transform:translateY(2px)}50%{transform:translate(0);-ms-transform:translate(0);-moz-transform:translate(0);-webkit-transform:translate(0);-o-transform:translate(0)}75%{transform:translateY(-2px);-ms-transform:translateY(-2px);-moz-transform:translateY(-2px);-webkit-transform:translateY(-2px);-o-transform:translateY(-2px)}to{transform:translate(0);-ms-transform:translate(0);-moz-transform:translate(0);-webkit-transform:translate(0);-o-transform:translate(0)}}@-webkit-keyframes _zs_galleryC{0%{transform:translate(0);-ms-transform:translate(0);-moz-transform:translate(0);-webkit-transform:translate(0);-o-transform:translate(0)}25%{transform:translateY(2px);-ms-transform:translateY(2px);-moz-transform:translateY(2px);-webkit-transform:translateY(2px);-o-transform:translateY(2px)}50%{transform:translate(0);-ms-transform:translate(0);-moz-transform:translate(0);-webkit-transform:translate(0);-o-transform:translate(0)}75%{transform:translateY(-2px);-ms-transform:translateY(-2px);-moz-transform:translateY(-2px);-webkit-transform:translateY(-2px);-o-transform:translateY(-2px)}to{transform:translate(0);-ms-transform:translate(0);-moz-transform:translate(0);-webkit-transform:translate(0);-o-transform:translate(0)}}@keyframes _zs_galleryD{0%{transform:translate(0);-ms-transform:translate(0);-moz-transform:translate(0);-webkit-transform:translate(0);-o-transform:translate(0)}25%{transform:translateY(-2px);-ms-transform:translateY(-2px);-moz-transform:translateY(-2px);-webkit-transform:translateY(-2px);-o-transform:translateY(-2px)}50%{transform:translate(0);-ms-transform:translate(0);-moz-transform:translate(0);-webkit-transform:translate(0);-o-transform:translate(0)}75%{transform:translateY(2px);-ms-transform:translateY(2px);-moz-transform:translateY(2px);-webkit-transform:translateY(2px);-o-transform:translateY(2px)}to{transform:translate(0);-ms-transform:translate(0);-moz-transform:translate(0);-webkit-transform:translate(0);-o-transform:translate(0)}}@-webkit-keyframes _zs_galleryD{0%{transform:translate(0);-ms-transform:translate(0);-moz-transform:translate(0);-webkit-transform:translate(0);-o-transform:translate(0)}25%{transform:translateY(-2px);-ms-transform:translateY(-2px);-moz-transform:translateY(-2px);-webkit-transform:translateY(-2px);-o-transform:translateY(-2px)}50%{transform:translate(0);-ms-transform:translate(0);-moz-transform:translate(0);-webkit-transform:translate(0);-o-transform:translate(0)}75%{transform:translateY(2px);-ms-transform:translateY(2px);-moz-transform:translateY(2px);-webkit-transform:translateY(2px);-o-transform:translateY(2px)}to{transform:translate(0);-ms-transform:translate(0);-moz-transform:translate(0);-webkit-transform:translate(0);-o-transform:translate(0)}}._zs_gallerylQ{display:none;position:absolute;top:100%;z-index:99;min-width:100%;max-height:300px;margin-top:10px;padding:8px 10px;border-radius:4px;background-color:#fff;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;overflow-y:auto;box-shadow:0 1px 1px 0 rgba(0,0,0,.08);border:1px solid #f5f5f6}._zs_gallerylQ ._zs_gallerylR{margin:2px 0;padding:0 10px;cursor:pointer;height:26px;line-height:26px;border-radius:4px;white-space:nowrap;word-break:break-all}._zs_gallerylQ ._zs_gallerylR._zs_gallerylS,._zs_gallerylQ ._zs_gallerylR:hover{background-color:#f0f0f0}._zs_gallerylQ ._zs_gallerylR._zs_gallerylT,._zs_gallerylQ ._zs_gallerylR._zs_gallerylT:active,._zs_gallerylQ ._zs_gallerylR._zs_gallerylT:focus,._zs_gallerylQ ._zs_gallerylR._zs_gallerylT:hover{color:#4d7fff;background-color:#f6f9ff}._zs_gallerylQ._zs_gallerylU{display:block;-webkit-animation:_zs_galleryz .25s ease-out;animation:_zs_galleryz .25s ease-out;-webkit-animation-fill-mode:forwards;animation-fill-mode:forwards}");r.exports=e.View.extend({tmpl:function(t,a,r,e,s,n,l,o){if(r||(r=t),!s){var i={"&":"amp","<":"lt",">":"gt",'"':"#34","'":"#39","`":"#96"},m=/[&<>"'`]/g,_=function(t){return"&"+i[t]+";"};s=function(t){return""+(null==t?"":t)},e=function(t){return s(t).replace(m,_)}}if(!n){var f={"!":"%21","'":"%27","(":"%28",")":"%29","*":"%2A"},p=function(t){return f[t]},g=/[!')(*]/g;n=function(t){return encodeURIComponent(s(t)).replace(g,p)}}if(!o){var d=/[\\'"]/g;o=function(t){return s(t).replace(d,"\\$&")}}l||(l=function(t,a,r,e){for(e=t[x];--e;)if(t[r=x+e]===a)return r;return t[r=x+t[x]++]=a,r});var x="",u="",c=t.viewId,y=t.items,z=t.placeholder,h=t.inputWidth,b=t.iv,v=t.disabled,w=t.suggestLeft,k=t.show,Y=t.loading,L=t.suggest,Q=t.emptyText;if(u+='<div mxv class="_zs_gallerymL unselectable clearfix" mx-click="'+a+'__fb()" id="ipt_'+e(c)+'">',y.length||(u+='<span mxa="_zs_galleryeB:_" class="_zs_gallerymN">'+e(z)+"</span>"),u+=" ",y.length){u+=" ";for(var T=0,j=y.length;T<j;T++){u+='<span mxa="_zs_galleryeB:a" class="_zs_gallerymM clearfix" mx-contextmenu="'+a+'prevent()">'+e(y[T].text)+'<i class="mc-iconfont _zs_gallerymP" mx-click="'+a+"__fe({idx:"+e(T)+'})">&#xe603;</i></span>'}u+=" "}if(u+='<input class="_zs_gallerymO" autocomplete="off" style="width: '+e(h)+'px;" value="'+e(b)+'" mx-keydown="'+a+'__bS()" mx-keyup="'+a+'__bS()" mx-paste="'+a+'__bS()" mx-focusin="'+a+'__bS()" mx-focusout="'+a+'__l()" mx-change="'+a+'__l()" ',v&&(u+=' disabled="true" '),u+="/>",!v){if(u+='<ul id="ul_'+e(c)+'" style="left: '+e(w)+'px;" class="_zs_gallerylQ ',k&&(u+=" _zs_gallerylU "),u+='" mx-mouseout="'+a+'__ci()" mx-mousemove="'+a+'__fi()" mx-contextmenu="'+a+'__H()">',Y)u+='<li mxs="_zs_galleryeB:_"><div class="loading" style="padding: 40px 0;"><span class="loading-anim"></span></div></li>';else{if(u+=" ",L&&L.length){u+=" ";T=0;for(var C=L.length;T<C;T++){var M=L[T];u+='<li class="_zs_gallerylR" mx-click="'+a+"__p({item:'"+l(r,M)+'\'})" data-idx="'+e(T)+'" id="sg_'+e(c)+"_"+e(T)+'">'+s(M.text)+"</li>"}u+=" "}else u+='<li mxa="_zs_galleryeB:b" class="text-center color-9">'+e(Q)+"</li>";u+=" "}u+="</ul>"}return u+="</div>"},init:function(t){var a=this,r=t.textKey||"text",o=t.valueKey||"value",i=0|t.max;a.__eZ=t.dynamicList+""=="true",a.updater.set({textKey:r,valueKey:o});var m=a.rebuildList(t.list||[]),_=t.selected||"";_=(_+"").split(",");var f=[],p=t.items||[];if(p&&p.length)f=p;else{var g=e.toMap(m,"value");_.forEach(function(t){g[t]&&f.push(g[t])})}a.__dg=a.__eZ?[]:m,a.__j=s("#"+a.id);var d=s("#"+a.id+"[mx-disabled]");a.updater.set({viewId:a.id,disabled:d&&d.length>0,placeholder:t.placeholder||n.choose,emptyText:n["empty.text"],inputWidth:10,items:f,max:i}),l.__f(),a.on("destroy",function(){l.__g(a),l.__h()})},rebuildList:function(t){var a=this.updater,r=a.get("textKey"),e=a.get("valueKey");return t="object"==typeof t[0]?t.map(function(t){return{text:t[r],value:t[e]}}):t.map(function(t){return{text:t,value:t}})},render:function(){this.updater.digest(),this.__f_(),this.__bL()},__bL:function(){var t=this.updater.get("items").map(function(t){return t.value});this.__j.val(t.join(","))},__f_:function(){var t=this;t.__fa=-1;var a=t.__dg,r=t.updater.get("items"),e=t.__bQ||"",n=[];if(t.__eZ)n=a;else for(var l=r.map(function(t){return t.value+""}),o=0,i=void 0;o<a.length;o++)i=a[o],l.indexOf(i.value+"")<0&&((i.value+"").indexOf(e)>-1||(i.text+"").indexOf(e)>-1)&&n.push(i);var m=t.__j.find("input");m.width(10);var _=m.position(),f=s("#ipt_"+t.id).width()-_.left;t.updater.digest({iv:e,suggest:n,inputWidth:f>=10?f:10,suggestLeft:_.left-6})},"__fb<click>":function(){this.updater.get("disabled")||this.__j.find("input").focus()},"__H<contextmenu>":function(t){t.preventDefault()},"__l<change,focusout>":function(t){t.stopPropagation()},"__bS<focusin,paste,keyup,keydown>":function(t){t.stopPropagation();var a=this;a.__dG&&clearTimeout(a.__dG);var r=t.eventTarget.value;if(a.__bQ!==r){a.__bQ=r;var e=a.__j.find("._zs_gallerymN");r?e.hide():e.show()}if("keydown"!=t.type){var s=a.updater.get("suggest");if(40==t.keyCode)a.__fc(),a.__fa++,a.__fa>=s.length&&(a.__fa=0),a.__fd();else if(38==t.keyCode)a.__fc(),a.__fa--,a.__fa<0&&(a.__fa=s.length-1),a.__fd();else if(13==t.keyCode){if(a.__fa>-1&&a.__fa<s.length){var n=s[a.__fa];a.__fc(),a.__p(n)}}else a.__dG=setTimeout(a.wrapAsync(function(){var t=a.updater.get("items"),r=a.updater.get("max");(r<=0||t.length<r)&&(a.__f_(),a.__n())}),300)}if(!r&&"keydown"==t.type&&8==t.keyCode){var l=a.updater.get("items").length-1;l>-1&&(a["__fe<click>"]({params:{idx:l}}),a.__eZ&&a.__m())}},__y:function(){for(var t=this.updater,a=[],r=t.get("items"),e=t.get("valueKey"),s=0,n=void 0;s<r.length;s++)n=r[s],a.push(e?n[e]:n);a=a.join(","),this.__j.val(a).trigger({type:"change",selected:a,items:r})},"__p<click>":function(t){t.stopPropagation&&t.stopPropagation(),this.__p(t.params.item)},__p:function(t){var a=this,r=a.updater;(s=r.get("items")).push(t),r.digest({items:s}),a.__bQ="",a.__bL(),a.__f_(),a.__y();var e=a.updater.get("max"),s=a.updater.get("items");e>0&&s.length>=e?a.__m():(a.__ff(),a.__eZ&&a.__m())},"__fe<click>":function(t){var a=this,r=a.updater.get();if(!r.disabled){var e=r.items,s=t.params.idx;e.splice(s,1),a.updater.digest({items:e}),a.__bQ="",a.__bL(),a.__f_(),a.__y(),a.__ff()}},__ff:function(){var t=this;if(t.__eZ)t.__j.find("input").focus();else{var a=t.updater.get("suggest");a&&a.length?t.__j.find("input").focus():t.__m()}},__fc:function(){s("#sg_"+this.id+"_"+this.__fa).removeClass("_zs_gallerylS")},__fd:function(t){var a=this,r=s("#sg_"+a.id+"_"+a.__fa);if(r.addClass("_zs_gallerylS"),!t&&r.length){a.__fg=1;var e=r.outerHeight(),n=(a.__fa+1)*e,l=s("#ul_"+a.id),o=l.height(),i=l.prop("scrollTop"),m=Math.ceil(o/e);n<i+e?l.prop("scrollTop",n-e):n>i+o&&l.prop("scrollTop",(a.__fa+2-m)*e)}},__m:function(){var t=this;t.__fh&&(t.__fh=!1,t.updater.digest({show:!1}),l.__g(t),t.__eZ&&(t.__dg=[]))},__n:function(){var t=this;t.__j.trigger({type:"show",keyword:t.__bQ});var a=t.updater.get("suggest");!t.__fh&&a&&a.length&&(t.__fh=!0,t.updater.digest({show:!0}),l.__p(t))},__k:function(t){return e.inside(t,this.id)},"__ci<mouseout>":function(t){if(!e.inside(t.relateTarget,t.eventTarget)){this.__fc(),this.__fa=-1}},"__fi<mousemove>":function(t){var a=this;if(a.__fg)delete a.__fg;else{var r=s(t.target);if(r.hasClass("_zs_gallerylR")){var e=r.data("idx");e!=a.__fa&&(a.__fc(),a.__fa=e,a.__fd(!0))}}},showLoading:function(){var t=this;t.__fh||(t.__fh=!0,t.updater.digest({show:!0,loading:!0,iv:t.__bQ}),l.__p(t))},hideLoading:function(){this.updater.digest({loading:!1})},update:function(t){t=this.rebuildList(t),this.__dg=t,this.updater.digest({iv:this.__bQ,suggest:t})}})});