define("mx-taginput/index",["magix","$","../mx-medusa/util","../mx-monitor/index"],(t,a,r)=>{var e=t("magix"),s=t("$"),n=t("../mx-medusa/util"),l=t("../mx-monitor/index");e.applyStyle("_zs_galleryaH",'._zs_gallerymL{box-shadow:0 1px 1px 0 rgba(0,0,0,.08);border:1px solid #f5f5f6}[mx-view*="mx-taginput/index"] ._zs_gallerymM{position:relative;height:auto;border:1px solid #e6e6e6;border-radius:4px;padding:2px 6px;cursor:text;transition:border-color .25s}[mx-view*="mx-taginput/index"] ._zs_gallerymM:hover{border-color:#ccc}[mx-view*="mx-taginput/index"] ._zs_gallerymM ._zs_gallerymN,[mx-view*="mx-taginput/index"] ._zs_gallerymM ._zs_gallerymO,[mx-view*="mx-taginput/index"] ._zs_gallerymM ._zs_gallerymP{height:22px;line-height:22px}[mx-view*="mx-taginput/index"] ._zs_gallerymM ._zs_gallerymO{position:absolute;left:10px;top:50%;margin-top:-11px;color:#999;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}[mx-view*="mx-taginput/index"] ._zs_gallerymM ._zs_gallerymN,[mx-view*="mx-taginput/index"] ._zs_gallerymM ._zs_gallerymP{float:left;margin-top:2px;margin-bottom:2px}[mx-view*="mx-taginput/index"] ._zs_gallerymM ._zs_gallerymN{float:left;position:relative;max-width:220px;padding-right:26px;padding-left:6px;margin-right:4px;background-color:#eee;border-radius:4px;cursor:pointer;white-space:nowrap;word-wrap:normal;overflow:hidden;text-overflow:ellipsis}[mx-view*="mx-taginput/index"] ._zs_gallerymM ._zs_gallerymN ._zs_gallerymQ{position:absolute;top:0;right:0;height:100%;width:20px;line-height:22px;text-align:center;font-size:12px;font-weight:700;color:#ccc;transition:color .25s;border-left:1px solid #fff}[mx-view*="mx-taginput/index"] ._zs_gallerymM ._zs_gallerymN ._zs_gallerymQ:hover{color:#999}[mx-view*="mx-taginput/index"] ._zs_gallerymM ._zs_gallerymP{padding:0;border:none;outline:none;background:transparent}[mx-view*="mx-taginput/index"][mx-disabled] ._zs_gallerymM{cursor:not-allowed;background-color:#fafafa;border-color:#e6e6e6}[mx-view*="mx-taginput/index"][mx-disabled] ._zs_gallerymM:hover{border-color:#e6e6e6}[mx-view*="mx-taginput/index"][mx-disabled] ._zs_gallerymN{cursor:not-allowed}[mx-view*="mx-taginput/index"][mx-disabled] ._zs_gallerymN ._zs_gallerymQ:hover{color:#ccc}'),e.applyStyle("_zs_galleryaA","._zs_gallerylQ{box-shadow:0 1px 1px 0 rgba(0,0,0,.08);border:1px solid #f5f5f6}@keyframes _zs_galleryz{0%{transform:translateY(-20%);-ms-transform:translateY(-20%);-moz-transform:translateY(-20%);-webkit-transform:translateY(-20%);-o-transform:translateY(-20%);opacity:0}to{transform:translate(0);-ms-transform:translate(0);-moz-transform:translate(0);-webkit-transform:translate(0);-o-transform:translate(0);opacity:1}}@-webkit-keyframes _zs_galleryz{0%{transform:translateY(-20%);-ms-transform:translateY(-20%);-moz-transform:translateY(-20%);-webkit-transform:translateY(-20%);-o-transform:translateY(-20%);opacity:0}to{transform:translate(0);-ms-transform:translate(0);-moz-transform:translate(0);-webkit-transform:translate(0);-o-transform:translate(0);opacity:1}}@keyframes _zs_galleryA{0%{transform:translateY(20%);-ms-transform:translateY(20%);-moz-transform:translateY(20%);-webkit-transform:translateY(20%);-o-transform:translateY(20%);opacity:0}to{transform:translate(0);-ms-transform:translate(0);-moz-transform:translate(0);-webkit-transform:translate(0);-o-transform:translate(0);opacity:1}}@-webkit-keyframes _zs_galleryA{0%{transform:translateY(20%);-ms-transform:translateY(20%);-moz-transform:translateY(20%);-webkit-transform:translateY(20%);-o-transform:translateY(20%);opacity:0}to{transform:translate(0);-ms-transform:translate(0);-moz-transform:translate(0);-webkit-transform:translate(0);-o-transform:translate(0);opacity:1}}@keyframes _zs_galleryB{0%{transform:translate(0);-ms-transform:translate(0);-moz-transform:translate(0);-webkit-transform:translate(0);-o-transform:translate(0)}25%{transform:translateY(-15%);-ms-transform:translateY(-15%);-moz-transform:translateY(-15%);-webkit-transform:translateY(-15%);-o-transform:translateY(-15%)}75%{transform:translateY(15%);-ms-transform:translateY(15%);-moz-transform:translateY(15%);-webkit-transform:translateY(15%);-o-transform:translateY(15%)}to{transform:translate(0);-ms-transform:translate(0);-moz-transform:translate(0);-webkit-transform:translate(0);-o-transform:translate(0)}}@-webkit-keyframes _zs_galleryB{0%{transform:translate(0);-ms-transform:translate(0);-moz-transform:translate(0);-webkit-transform:translate(0);-o-transform:translate(0)}25%{transform:translateY(-15%);-ms-transform:translateY(-15%);-moz-transform:translateY(-15%);-webkit-transform:translateY(-15%);-o-transform:translateY(-15%)}75%{transform:translateY(15%);-ms-transform:translateY(15%);-moz-transform:translateY(15%);-webkit-transform:translateY(15%);-o-transform:translateY(15%)}to{transform:translate(0);-ms-transform:translate(0);-moz-transform:translate(0);-webkit-transform:translate(0);-o-transform:translate(0)}}@keyframes _zs_galleryC{0%{transform:translate(0);-ms-transform:translate(0);-moz-transform:translate(0);-webkit-transform:translate(0);-o-transform:translate(0)}25%{transform:translateY(2px);-ms-transform:translateY(2px);-moz-transform:translateY(2px);-webkit-transform:translateY(2px);-o-transform:translateY(2px)}50%{transform:translate(0);-ms-transform:translate(0);-moz-transform:translate(0);-webkit-transform:translate(0);-o-transform:translate(0)}75%{transform:translateY(-2px);-ms-transform:translateY(-2px);-moz-transform:translateY(-2px);-webkit-transform:translateY(-2px);-o-transform:translateY(-2px)}to{transform:translate(0);-ms-transform:translate(0);-moz-transform:translate(0);-webkit-transform:translate(0);-o-transform:translate(0)}}@-webkit-keyframes _zs_galleryC{0%{transform:translate(0);-ms-transform:translate(0);-moz-transform:translate(0);-webkit-transform:translate(0);-o-transform:translate(0)}25%{transform:translateY(2px);-ms-transform:translateY(2px);-moz-transform:translateY(2px);-webkit-transform:translateY(2px);-o-transform:translateY(2px)}50%{transform:translate(0);-ms-transform:translate(0);-moz-transform:translate(0);-webkit-transform:translate(0);-o-transform:translate(0)}75%{transform:translateY(-2px);-ms-transform:translateY(-2px);-moz-transform:translateY(-2px);-webkit-transform:translateY(-2px);-o-transform:translateY(-2px)}to{transform:translate(0);-ms-transform:translate(0);-moz-transform:translate(0);-webkit-transform:translate(0);-o-transform:translate(0)}}@keyframes _zs_galleryD{0%{transform:translate(0);-ms-transform:translate(0);-moz-transform:translate(0);-webkit-transform:translate(0);-o-transform:translate(0)}25%{transform:translateY(-2px);-ms-transform:translateY(-2px);-moz-transform:translateY(-2px);-webkit-transform:translateY(-2px);-o-transform:translateY(-2px)}50%{transform:translate(0);-ms-transform:translate(0);-moz-transform:translate(0);-webkit-transform:translate(0);-o-transform:translate(0)}75%{transform:translateY(2px);-ms-transform:translateY(2px);-moz-transform:translateY(2px);-webkit-transform:translateY(2px);-o-transform:translateY(2px)}to{transform:translate(0);-ms-transform:translate(0);-moz-transform:translate(0);-webkit-transform:translate(0);-o-transform:translate(0)}}@-webkit-keyframes _zs_galleryD{0%{transform:translate(0);-ms-transform:translate(0);-moz-transform:translate(0);-webkit-transform:translate(0);-o-transform:translate(0)}25%{transform:translateY(-2px);-ms-transform:translateY(-2px);-moz-transform:translateY(-2px);-webkit-transform:translateY(-2px);-o-transform:translateY(-2px)}50%{transform:translate(0);-ms-transform:translate(0);-moz-transform:translate(0);-webkit-transform:translate(0);-o-transform:translate(0)}75%{transform:translateY(2px);-ms-transform:translateY(2px);-moz-transform:translateY(2px);-webkit-transform:translateY(2px);-o-transform:translateY(2px)}to{transform:translate(0);-ms-transform:translate(0);-moz-transform:translate(0);-webkit-transform:translate(0);-o-transform:translate(0)}}._zs_gallerylR{display:none;position:absolute;top:100%;z-index:99;min-width:100%;max-height:300px;margin-top:10px;padding:8px 10px;border-radius:4px;background-color:#fff;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;overflow-y:auto;box-shadow:0 1px 1px 0 rgba(0,0,0,.08);border:1px solid #f5f5f6}._zs_gallerylR ._zs_gallerylS{margin:2px 0;padding:0 10px;cursor:pointer;height:26px;line-height:26px;border-radius:4px;white-space:nowrap;word-break:break-all}._zs_gallerylR ._zs_gallerylS._zs_gallerylT,._zs_gallerylR ._zs_gallerylS:hover{background-color:#f0f0f0}._zs_gallerylR ._zs_gallerylS._zs_gallerylU,._zs_gallerylR ._zs_gallerylS._zs_gallerylU:active,._zs_gallerylR ._zs_gallerylS._zs_gallerylU:focus,._zs_gallerylR ._zs_gallerylS._zs_gallerylU:hover{color:#4d7fff;background-color:#f6f9ff}._zs_gallerylR._zs_gallerylV{display:block;-webkit-animation:_zs_galleryz .25s ease-out;animation:_zs_galleryz .25s ease-out;-webkit-animation-fill-mode:forwards;animation-fill-mode:forwards}");r.exports=e.View.extend({tmpl:function(t,a,r,e,s,n,l,o){if(r||(r=t),!s){var i={"&":"amp","<":"lt",">":"gt",'"':"#34","'":"#39","`":"#96"},m=/[&<>"'`]/g,_=function(t){return"&"+i[t]+";"};s=function(t){return""+(null==t?"":t)},e=function(t){return s(t).replace(m,_)}}if(!n){var f={"!":"%21","'":"%27","(":"%28",")":"%29","*":"%2A"},p=function(t){return f[t]},g=/[!')(*]/g;n=function(t){return encodeURIComponent(s(t)).replace(g,p)}}if(!o){var d=/[\\'"]/g;o=function(t){return s(t).replace(d,"\\$&")}}l||(l=function(t,a,r,e){for(e=t[x];--e;)if(t[r=x+e]===a)return r;return t[r=x+t[x]++]=a,r});var x="",u="",c=t.viewId,y=t.items,z=t.placeholder,h=t.inputWidth,b=t.iv,v=t.disabled,w=t.suggestLeft,Y=t.show,k=t.loading,M=t.suggest,Z=t.emptyText;if(u+='<div mxv class="_zs_gallerymM unselectable clearfix" mx-click="'+a+'__f_()" id="ipt_'+e(c)+'">',y.length||(u+='<span mxa="_zs_galleryeA:_" class="_zs_gallerymO">'+e(z)+"</span>"),u+=" ",y.length){u+=" ";for(var S=0,L=y.length;S<L;S++){u+='<span mxa="_zs_galleryeA:a" class="_zs_gallerymN clearfix" mx-contextmenu="'+a+'prevent()">'+e(y[S].text)+'<i class="mc-iconfont _zs_gallerymQ" mx-click="'+a+"__fc({idx:"+e(S)+'})">&#xe603;</i></span>'}u+=" "}if(u+='<input class="_zs_gallerymP" autocomplete="off" style="width: '+e(h)+'px;" value="'+e(b)+'" mx-keydown="'+a+'__bS()" mx-keyup="'+a+'__bS()" mx-paste="'+a+'__bS()" mx-focusin="'+a+'__bS()" mx-focusout="'+a+'__l()" mx-change="'+a+'__l()" ',v&&(u+=' disabled="true" '),u+="/>",!v){if(u+='<ul id="ul_'+e(c)+'" style="left: '+e(w)+'px;" class="_zs_gallerylR ',Y&&(u+=" _zs_gallerylV "),u+='" mx-mouseout="'+a+'__ci()" mx-mousemove="'+a+'__fg()" mx-contextmenu="'+a+'__H()">',k)u+='<li mxs="_zs_galleryeA:_"><div class="loading" style="padding: 40px 0;"><span class="loading-anim"></span></div></li>';else{if(u+=" ",M&&M.length){u+=" ";S=0;for(var Q=M.length;S<Q;S++){var T=M[S];u+='<li class="_zs_gallerylS" mx-click="'+a+"__p({item:'"+l(r,T)+'\'})" data-idx="'+e(S)+'" id="sg_'+e(c)+"_"+e(S)+'">'+s(T.text)+"</li>"}u+=" "}else u+='<li mxa="_zs_galleryeA:b" class="text-center color-9">'+e(Z)+"</li>";u+=" "}u+="</ul>"}return u+="</div>"},init:function(t){var a=this,r=t.textKey||"text",o=t.valueKey||"value",i=0|t.max;a.__eX=t.dynamicList+""=="true",a.updater.set({textKey:r,valueKey:o});var m=a.rebuildList(t.list||[]),_=t.selected||"";_=(_+"").split(",");var f=[],p=t.items||[];if(p&&p.length)f=p;else{var g=e.toMap(m,"value");_.forEach(function(t){g[t]&&f.push(g[t])})}a.__df=a.__eX?[]:m,a.__j=s("#"+a.id);var d=s("#"+a.id+"[mx-disabled]");a.updater.set({viewId:a.id,disabled:d&&d.length>0,placeholder:t.placeholder||n.choose,emptyText:n["empty.text"],inputWidth:10,items:f,max:i}),l.__f(),a.on("destroy",function(){l.__g(a),l.__h()})},rebuildList:function(t){var a=this.updater,r=a.get("textKey"),e=a.get("valueKey");return t="object"==typeof t[0]?t.map(function(t){return{text:t[r],value:t[e]}}):t.map(function(t){return{text:t,value:t}})},render:function(){this.updater.digest(),this.__eY(),this.__bL()},__bL:function(){var t=this.updater.get("items").map(function(t){return t.value});this.__j.val(t.join(","))},__eY:function(){var t=this;t.__eZ=-1;var a=t.__df,r=t.updater.get("items"),e=t.__bQ||"",n=[];if(t.__eX)n=a;else for(var l=r.map(function(t){return t.value+""}),o=0,i=void 0;o<a.length;o++)i=a[o],l.indexOf(i.value+"")<0&&((i.value+"").indexOf(e)>-1||(i.text+"").indexOf(e)>-1)&&n.push(i);var m=t.__j.find("input");m.width(10);var _=m.position(),f=s("#ipt_"+t.id).width()-_.left;t.updater.digest({iv:e,suggest:n,inputWidth:f>=10?f:10,suggestLeft:_.left-6})},"__f_<click>":function(){this.updater.get("disabled")||this.__j.find("input").focus()},"__H<contextmenu>":function(t){t.preventDefault()},"__l<change,focusout>":function(t){t.stopPropagation()},"__bS<focusin,paste,keyup,keydown>":function(t){t.stopPropagation();var a=this;a.__dF&&clearTimeout(a.__dF);var r=t.eventTarget.value;if(a.__bQ!==r){a.__bQ=r;var e=a.__j.find("._zs_gallerymO");r?e.hide():e.show()}if("keydown"!=t.type){var s=a.updater.get("suggest");if(40==t.keyCode)a.__fa(),a.__eZ++,a.__eZ>=s.length&&(a.__eZ=0),a.__fb();else if(38==t.keyCode)a.__fa(),a.__eZ--,a.__eZ<0&&(a.__eZ=s.length-1),a.__fb();else if(13==t.keyCode){if(a.__eZ>-1&&a.__eZ<s.length){var n=s[a.__eZ];a.__fa(),a.__p(n)}}else a.__dF=setTimeout(a.wrapAsync(function(){var t=a.updater.get("items"),r=a.updater.get("max");(r<=0||t.length<r)&&(a.__eY(),a.__n())}),300)}if(!r&&"keydown"==t.type&&8==t.keyCode){var l=a.updater.get("items").length-1;l>-1&&(a["__fc<click>"]({params:{idx:l}}),a.__eX&&a.__m())}},__y:function(){for(var t=this.updater,a=[],r=t.get("items"),e=t.get("valueKey"),s=0,n=void 0;s<r.length;s++)n=r[s],a.push(e?n[e]:n);a=a.join(","),this.__j.val(a).trigger({type:"change",selected:a,items:r})},"__p<click>":function(t){t.stopPropagation&&t.stopPropagation(),this.__p(t.params.item)},__p:function(t){var a=this,r=a.updater;(s=r.get("items")).push(t),r.digest({items:s}),a.__bQ="",a.__bL(),a.__eY(),a.__y();var e=a.updater.get("max"),s=a.updater.get("items");e>0&&s.length>=e?a.__m():(a.__fd(),a.__eX&&a.__m())},"__fc<click>":function(t){var a=this,r=a.updater.get();if(!r.disabled){var e=r.items,s=t.params.idx;e.splice(s,1),a.updater.digest({items:e}),a.__bQ="",a.__bL(),a.__eY(),a.__y(),a.__fd()}},__fd:function(){var t=this;if(t.__eX)t.__j.find("input").focus();else{var a=t.updater.get("suggest");a&&a.length?t.__j.find("input").focus():t.__m()}},__fa:function(){s("#sg_"+this.id+"_"+this.__eZ).removeClass("_zs_gallerylT")},__fb:function(t){var a=this,r=s("#sg_"+a.id+"_"+a.__eZ);if(r.addClass("_zs_gallerylT"),!t&&r.length){a.__fe=1;var e=r.outerHeight(),n=(a.__eZ+1)*e,l=s("#ul_"+a.id),o=l.height(),i=l.prop("scrollTop"),m=Math.ceil(o/e);n<i+e?l.prop("scrollTop",n-e):n>i+o&&l.prop("scrollTop",(a.__eZ+2-m)*e)}},__m:function(){var t=this;t.__ff&&(t.__ff=!1,t.updater.digest({show:!1}),l.__g(t),t.__eX&&(t.__df=[]))},__n:function(){var t=this;t.__j.trigger({type:"show",keyword:t.__bQ});var a=t.updater.get("suggest");!t.__ff&&a&&a.length&&(t.__ff=!0,t.updater.digest({show:!0}),l.__p(t))},__k:function(t){return e.inside(t,this.id)},"__ci<mouseout>":function(t){if(!e.inside(t.relateTarget,t.eventTarget)){this.__fa(),this.__eZ=-1}},"__fg<mousemove>":function(t){var a=this;if(a.__fe)delete a.__fe;else{var r=s(t.target);if(r.hasClass("_zs_gallerylS")){var e=r.data("idx");e!=a.__eZ&&(a.__fa(),a.__eZ=e,a.__fb(!0))}}},showLoading:function(){var t=this;t.__ff||(t.__ff=!0,t.updater.digest({show:!0,loading:!0,iv:t.__bQ}),l.__p(t))},hideLoading:function(){this.updater.digest({loading:!1})},update:function(t){t=this.rebuildList(t),this.__df=t,this.updater.digest({iv:this.__bQ,suggest:t})}})});