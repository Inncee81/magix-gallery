define("mx-taginput/index",["magix","$","../mx-medusa/util","../mx-monitor/index"],(t,a,r)=>{var e=t("magix"),s=t("$"),n=t("../mx-medusa/util"),o=t("../mx-monitor/index");e.applyStyle("_zs_galleryaG",'._zs_gallerymW{box-shadow:0 1px 1px 0 rgba(0,0,0,.08);border:1px solid #f5f5f6}[mx-view*="mx-taginput/index"] ._zs_gallerymX{position:relative;height:auto;border:1px solid #e6e6e6;border-radius:4px;padding:2px 6px;cursor:text;transition:border-color .25s}[mx-view*="mx-taginput/index"] ._zs_gallerymX:hover{border-color:#ccc}[mx-view*="mx-taginput/index"] ._zs_gallerymX ._zs_gallerymY,[mx-view*="mx-taginput/index"] ._zs_gallerymX ._zs_gallerymZ,[mx-view*="mx-taginput/index"] ._zs_gallerymX ._zs_galleryn_{height:22px;line-height:22px}[mx-view*="mx-taginput/index"] ._zs_gallerymX ._zs_gallerymZ{position:absolute;left:10px;top:50%;margin-top:-11px;color:#999;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}[mx-view*="mx-taginput/index"] ._zs_gallerymX ._zs_gallerymY,[mx-view*="mx-taginput/index"] ._zs_gallerymX ._zs_galleryn_{float:left;margin-top:2px;margin-bottom:2px}[mx-view*="mx-taginput/index"] ._zs_gallerymX ._zs_gallerymY{float:left;position:relative;max-width:220px;padding-right:26px;padding-left:6px;margin-right:4px;background-color:#eee;border-radius:4px;cursor:pointer;white-space:nowrap;word-wrap:normal;overflow:hidden;text-overflow:ellipsis}[mx-view*="mx-taginput/index"] ._zs_gallerymX ._zs_gallerymY ._zs_galleryna{position:absolute;top:0;right:0;height:100%;width:20px;line-height:22px;text-align:center;font-size:12px;font-weight:700;color:#ccc;transition:color .25s;border-left:1px solid #fff}[mx-view*="mx-taginput/index"] ._zs_gallerymX ._zs_gallerymY ._zs_galleryna:hover{color:#999}[mx-view*="mx-taginput/index"] ._zs_gallerymX ._zs_galleryn_{padding:0;border:none;outline:none;background:transparent}[mx-view*="mx-taginput/index"][mx-disabled] ._zs_gallerymX{cursor:not-allowed;background-color:#fafafa;border-color:#e6e6e6}[mx-view*="mx-taginput/index"][mx-disabled] ._zs_gallerymX:hover{border-color:#e6e6e6}[mx-view*="mx-taginput/index"][mx-disabled] ._zs_gallerymY{cursor:not-allowed}[mx-view*="mx-taginput/index"][mx-disabled] ._zs_gallerymY ._zs_galleryna:hover{color:#ccc}'),e.applyStyle("_zs_galleryaz","._zs_galleryma{box-shadow:0 1px 1px 0 rgba(0,0,0,.08);border:1px solid #f5f5f6}@keyframes _zs_galleryF{0%{transform:translateY(-20%);-ms-transform:translateY(-20%);-moz-transform:translateY(-20%);-webkit-transform:translateY(-20%);-o-transform:translateY(-20%);opacity:0}to{transform:translate(0);-ms-transform:translate(0);-moz-transform:translate(0);-webkit-transform:translate(0);-o-transform:translate(0);opacity:1}}@-webkit-keyframes _zs_galleryF{0%{transform:translateY(-20%);-ms-transform:translateY(-20%);-moz-transform:translateY(-20%);-webkit-transform:translateY(-20%);-o-transform:translateY(-20%);opacity:0}to{transform:translate(0);-ms-transform:translate(0);-moz-transform:translate(0);-webkit-transform:translate(0);-o-transform:translate(0);opacity:1}}@keyframes _zs_galleryG{0%{transform:translateY(20%);-ms-transform:translateY(20%);-moz-transform:translateY(20%);-webkit-transform:translateY(20%);-o-transform:translateY(20%);opacity:0}to{transform:translate(0);-ms-transform:translate(0);-moz-transform:translate(0);-webkit-transform:translate(0);-o-transform:translate(0);opacity:1}}@-webkit-keyframes _zs_galleryG{0%{transform:translateY(20%);-ms-transform:translateY(20%);-moz-transform:translateY(20%);-webkit-transform:translateY(20%);-o-transform:translateY(20%);opacity:0}to{transform:translate(0);-ms-transform:translate(0);-moz-transform:translate(0);-webkit-transform:translate(0);-o-transform:translate(0);opacity:1}}@keyframes _zs_galleryH{0%{transform:translate(0);-ms-transform:translate(0);-moz-transform:translate(0);-webkit-transform:translate(0);-o-transform:translate(0)}25%{transform:translateY(-15%);-ms-transform:translateY(-15%);-moz-transform:translateY(-15%);-webkit-transform:translateY(-15%);-o-transform:translateY(-15%)}75%{transform:translateY(15%);-ms-transform:translateY(15%);-moz-transform:translateY(15%);-webkit-transform:translateY(15%);-o-transform:translateY(15%)}to{transform:translate(0);-ms-transform:translate(0);-moz-transform:translate(0);-webkit-transform:translate(0);-o-transform:translate(0)}}@-webkit-keyframes _zs_galleryH{0%{transform:translate(0);-ms-transform:translate(0);-moz-transform:translate(0);-webkit-transform:translate(0);-o-transform:translate(0)}25%{transform:translateY(-15%);-ms-transform:translateY(-15%);-moz-transform:translateY(-15%);-webkit-transform:translateY(-15%);-o-transform:translateY(-15%)}75%{transform:translateY(15%);-ms-transform:translateY(15%);-moz-transform:translateY(15%);-webkit-transform:translateY(15%);-o-transform:translateY(15%)}to{transform:translate(0);-ms-transform:translate(0);-moz-transform:translate(0);-webkit-transform:translate(0);-o-transform:translate(0)}}@keyframes _zs_galleryI{0%{transform:translate(0);-ms-transform:translate(0);-moz-transform:translate(0);-webkit-transform:translate(0);-o-transform:translate(0)}25%{transform:translateY(2px);-ms-transform:translateY(2px);-moz-transform:translateY(2px);-webkit-transform:translateY(2px);-o-transform:translateY(2px)}50%{transform:translate(0);-ms-transform:translate(0);-moz-transform:translate(0);-webkit-transform:translate(0);-o-transform:translate(0)}75%{transform:translateY(-2px);-ms-transform:translateY(-2px);-moz-transform:translateY(-2px);-webkit-transform:translateY(-2px);-o-transform:translateY(-2px)}to{transform:translate(0);-ms-transform:translate(0);-moz-transform:translate(0);-webkit-transform:translate(0);-o-transform:translate(0)}}@-webkit-keyframes _zs_galleryI{0%{transform:translate(0);-ms-transform:translate(0);-moz-transform:translate(0);-webkit-transform:translate(0);-o-transform:translate(0)}25%{transform:translateY(2px);-ms-transform:translateY(2px);-moz-transform:translateY(2px);-webkit-transform:translateY(2px);-o-transform:translateY(2px)}50%{transform:translate(0);-ms-transform:translate(0);-moz-transform:translate(0);-webkit-transform:translate(0);-o-transform:translate(0)}75%{transform:translateY(-2px);-ms-transform:translateY(-2px);-moz-transform:translateY(-2px);-webkit-transform:translateY(-2px);-o-transform:translateY(-2px)}to{transform:translate(0);-ms-transform:translate(0);-moz-transform:translate(0);-webkit-transform:translate(0);-o-transform:translate(0)}}@keyframes _zs_galleryJ{0%{transform:translate(0);-ms-transform:translate(0);-moz-transform:translate(0);-webkit-transform:translate(0);-o-transform:translate(0)}25%{transform:translateY(-2px);-ms-transform:translateY(-2px);-moz-transform:translateY(-2px);-webkit-transform:translateY(-2px);-o-transform:translateY(-2px)}50%{transform:translate(0);-ms-transform:translate(0);-moz-transform:translate(0);-webkit-transform:translate(0);-o-transform:translate(0)}75%{transform:translateY(2px);-ms-transform:translateY(2px);-moz-transform:translateY(2px);-webkit-transform:translateY(2px);-o-transform:translateY(2px)}to{transform:translate(0);-ms-transform:translate(0);-moz-transform:translate(0);-webkit-transform:translate(0);-o-transform:translate(0)}}@-webkit-keyframes _zs_galleryJ{0%{transform:translate(0);-ms-transform:translate(0);-moz-transform:translate(0);-webkit-transform:translate(0);-o-transform:translate(0)}25%{transform:translateY(-2px);-ms-transform:translateY(-2px);-moz-transform:translateY(-2px);-webkit-transform:translateY(-2px);-o-transform:translateY(-2px)}50%{transform:translate(0);-ms-transform:translate(0);-moz-transform:translate(0);-webkit-transform:translate(0);-o-transform:translate(0)}75%{transform:translateY(2px);-ms-transform:translateY(2px);-moz-transform:translateY(2px);-webkit-transform:translateY(2px);-o-transform:translateY(2px)}to{transform:translate(0);-ms-transform:translate(0);-moz-transform:translate(0);-webkit-transform:translate(0);-o-transform:translate(0)}}._zs_gallerymb{display:none;position:absolute;top:100%;z-index:99;min-width:100%;max-height:300px;margin-top:10px;padding:8px 10px;border-radius:4px;background-color:#fff;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;overflow-y:auto;box-shadow:0 1px 1px 0 rgba(0,0,0,.08);border:1px solid #f5f5f6}._zs_gallerymb ._zs_gallerymc{margin:2px 0;padding:0 10px;cursor:pointer;height:26px;line-height:26px;border-radius:4px;white-space:nowrap;word-break:break-all}._zs_gallerymb ._zs_gallerymc._zs_gallerymd,._zs_gallerymb ._zs_gallerymc:hover{background-color:#f0f0f0}._zs_gallerymb ._zs_gallerymc._zs_galleryme,._zs_gallerymb ._zs_gallerymc._zs_galleryme:active,._zs_gallerymb ._zs_gallerymc._zs_galleryme:focus,._zs_gallerymb ._zs_gallerymc._zs_galleryme:hover{color:#4d7fff;background-color:#f6f9ff}._zs_gallerymb._zs_gallerymf{display:block;-webkit-animation:_zs_galleryF .25s ease-out;animation:_zs_galleryF .25s ease-out;-webkit-animation-fill-mode:forwards;animation-fill-mode:forwards}");r.exports=e.View.extend({tmpl:function(t,a,r,e,s,n,o,l){if(r||(r=t),!s){var m={"&":"amp","<":"lt",">":"gt",'"':"#34","'":"#39","`":"#96"},i=/[&<>"'`]/g,_=function(t){return"&"+m[t]+";"};s=function(t){return""+(null==t?"":t)},e=function(t){return s(t).replace(i,_)}}if(!n){var f={"!":"%21","'":"%27","(":"%28",")":"%29","*":"%2A"},p=function(t){return f[t]},g=/[!')(*]/g;n=function(t){return encodeURIComponent(s(t)).replace(g,p)}}if(!l){var d=/[\\'"]/g;l=function(t){return s(t).replace(d,"\\$&")}}o||(o=function(t,a,r,e){for(e=t[x];--e;)if(t[r=x+e]===a)return r;return t[r=x+t[x]++]=a,r});var x="",u="",c=t.viewId,y=t.items,z=t.placeholder,b=t.inputWidth,h=t.iv,v=t.disabled,w=t.suggestLeft,Y=t.show,k=t.loading,K=t.suggest,P=t.emptyText;if(u+='<div mxv class="_zs_gallerymX unselectable clearfix" mx-click="'+a+'__eL()" id="ipt_'+e(c)+'">',y.length||(u+='<span mxa="_zs_galleryei:_" class="_zs_gallerymZ">'+e(z)+"</span>"),u+=" ",y.length){u+=" ";for(var X=0,j=y.length;X<j;X++){u+='<span mxa="_zs_galleryei:a" class="_zs_gallerymY clearfix" mx-contextmenu="'+a+'prevent()">'+e(y[X].text)+'<i class="mc-iconfont _zs_galleryna" mx-click="'+a+"__eO({idx:"+e(X)+'})">&#xe603;</i></span>'}u+=" "}if(u+='<input class="_zs_galleryn_" autocomplete="off" style="width: '+e(b)+'px;" value="'+e(h)+'" mx-keydown="'+a+'__ca()" mx-keyup="'+a+'__ca()" mx-paste="'+a+'__ca()" mx-focusin="'+a+'__ca()" mx-focusout="'+a+'__l()" mx-change="'+a+'__l()" ',v&&(u+=' disabled="true" '),u+="/>",!v){if(u+='<ul id="ul_'+e(c)+'" style="left: '+e(w)+'px;" class="_zs_gallerymb ',Y&&(u+=" _zs_gallerymf "),u+='" mx-mouseout="'+a+'__bV()" mx-mousemove="'+a+'__eS()" mx-contextmenu="'+a+'__H()">',k)u+='<li mxs="_zs_galleryei:_"><div class="loading" style="padding: 40px 0;"><span class="loading-anim"></span></div></li>';else{if(u+=" ",K&&K.length){u+=" ";X=0;for(var I=K.length;X<I;X++){var R=K[X];u+='<li class="_zs_gallerymc" mx-click="'+a+"__p({item:'"+o(r,R)+'\'})" data-idx="'+e(X)+'" id="sg_'+e(c)+"_"+e(X)+'">'+s(R.text)+"</li>"}u+=" "}else u+='<li mxa="_zs_galleryei:b" class="text-center color-9">'+e(P)+"</li>";u+=" "}u+="</ul>"}return u+="</div>"},init:function(t){var a=this,r=t.textKey||"text",l=t.valueKey||"value",m=0|t.max;a.__eI=t.dynamicList+""=="true",a.updater.set({textKey:r,valueKey:l});var i=a.rebuildList(t.list||[]),_=t.selected||"";_=(_+"").split(",");var f=[],p=t.items||[];if(p&&p.length)f=p;else{var g=e.toMap(i,"value");_.forEach(function(t){g[t]&&f.push(g[t])})}a.__cR=a.__eI?[]:i,a.__j=s("#"+a.id);var d=s("#"+a.id+"[mx-disabled]");a.updater.set({viewId:a.id,disabled:d&&d.length>0,placeholder:t.placeholder||n.choose,emptyText:n["empty.text"],inputWidth:10,items:f,max:m}),o.__f(),a.on("destroy",function(){o.__g(a),o.__h()})},rebuildList:function(t){var a=this.updater,r=a.get("textKey"),e=a.get("valueKey");return t="object"==typeof t[0]?t.map(function(t){return{text:t[r],value:t[e]}}):t.map(function(t){return{text:t,value:t}})},render:function(){this.updater.digest(),this.__eJ(),this.__bO()},__bO:function(){var t=this.updater.get("items").map(function(t){return t.value});this.__j.val(t.join(","))},__eJ:function(){var t=this;t.__eK=-1;var a=t.__cR,r=t.updater.get("items"),e=t.__bP||"",n=[];if(t.__eI)n=a;else for(var o=r.map(function(t){return t.value+""}),l=0,m=void 0;l<a.length;l++)m=a[l],o.indexOf(m.value+"")<0&&((m.value+"").indexOf(e)>-1||(m.text+"").indexOf(e)>-1)&&n.push(m);var i=t.__j.find("input");i.width(10);var _=i.position(),f=s("#ipt_"+t.id).width()-_.left;t.updater.digest({iv:e,suggest:n,inputWidth:f>=10?f:10,suggestLeft:_.left-6})},"__eL<click>":function(){this.updater.get("disabled")||this.__j.find("input").focus()},"__H<contextmenu>":function(t){t.preventDefault()},"__l<change,focusout>":function(t){t.stopPropagation()},"__ca<focusin,paste,keyup,keydown>":function(t){t.stopPropagation();var a=this;a.__dq&&clearTimeout(a.__dq);var r=t.eventTarget.value;if(a.__bP!==r){a.__bP=r;var e=a.__j.find("._zs_gallerymZ");r?e.hide():e.show()}if("keydown"!=t.type){var s=a.updater.get("suggest");if(40==t.keyCode)a.__eM(),a.__eK++,a.__eK>=s.length&&(a.__eK=0),a.__eN();else if(38==t.keyCode)a.__eM(),a.__eK--,a.__eK<0&&(a.__eK=s.length-1),a.__eN();else if(13==t.keyCode){if(a.__eK>-1&&a.__eK<s.length){var n=s[a.__eK];a.__eM(),a.__p(n)}}else a.__dq=setTimeout(a.wrapAsync(function(){var t=a.updater.get("items"),r=a.updater.get("max");(r<=0||t.length<r)&&(a.__eJ(),a.__n())}),300)}if(!r&&"keydown"==t.type&&8==t.keyCode){var o=a.updater.get("items").length-1;o>-1&&(a["__eO<click>"]({params:{idx:o}}),a.__eI&&a.__m())}},__y:function(){for(var t=this.updater,a=[],r=t.get("items"),e=t.get("valueKey"),s=0,n=void 0;s<r.length;s++)n=r[s],a.push(e?n[e]:n);a=a.join(","),this.__j.val(a).trigger({type:"change",selected:a,items:r})},"__p<click>":function(t){t.stopPropagation&&t.stopPropagation(),this.__p(t.params.item)},__p:function(t){var a=this,r=a.updater;(s=r.get("items")).push(t),r.digest({items:s}),a.__bP="",a.__bO(),a.__eJ(),a.__y();var e=a.updater.get("max"),s=a.updater.get("items");e>0&&s.length>=e?a.__m():(a.__eP(),a.__eI&&a.__m())},"__eO<click>":function(t){var a=this,r=a.updater.get();if(!r.disabled){var e=r.items,s=t.params.idx;e.splice(s,1),a.updater.digest({items:e}),a.__bP="",a.__bO(),a.__eJ(),a.__y(),a.__eP()}},__eP:function(){var t=this;if(t.__eI)t.__j.find("input").focus();else{var a=t.updater.get("suggest");a&&a.length?t.__j.find("input").focus():t.__m()}},__eM:function(){s("#sg_"+this.id+"_"+this.__eK).removeClass("_zs_gallerymd")},__eN:function(t){var a=this,r=s("#sg_"+a.id+"_"+a.__eK);if(r.addClass("_zs_gallerymd"),!t&&r.length){a.__eQ=1;var e=r.outerHeight(),n=(a.__eK+1)*e,o=s("#ul_"+a.id),l=o.height(),m=o.prop("scrollTop"),i=Math.ceil(l/e);n<m+e?o.prop("scrollTop",n-e):n>m+l&&o.prop("scrollTop",(a.__eK+2-i)*e)}},__m:function(){var t=this;t.__eR&&(t.__eR=!1,t.updater.digest({show:!1}),o.__g(t),t.__eI&&(t.__cR=[]))},__n:function(){var t=this;t.__j.trigger({type:"show",keyword:t.__bP});var a=t.updater.get("suggest");!t.__eR&&a&&a.length&&(t.__eR=!0,t.updater.digest({show:!0}),o.__p(t))},__k:function(t){return e.inside(t,this.id)},"__bV<mouseout>":function(t){if(!e.inside(t.relateTarget,t.eventTarget)){this.__eM(),this.__eK=-1}},"__eS<mousemove>":function(t){var a=this;if(a.__eQ)delete a.__eQ;else{var r=s(t.target);if(r.hasClass("_zs_gallerymc")){var e=r.data("idx");e!=a.__eK&&(a.__eM(),a.__eK=e,a.__eN(!0))}}},showLoading:function(){var t=this;t.__eR||(t.__eR=!0,t.updater.digest({show:!0,loading:!0,iv:t.__bP}),o.__p(t))},hideLoading:function(){this.updater.digest({loading:!1})},update:function(t){t=this.rebuildList(t),this.__cR=t,this.updater.digest({iv:this.__bP,suggest:t})}})});