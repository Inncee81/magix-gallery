define("mx-taginput/index",["magix","$","./suggest"],(e,t,i)=>{e("./suggest");var a=e("magix");a.applyStyle("_zs_galleryan",'._zs_gallerykv{box-shadow:0 2px 4px rgba(51,51,51,.08);border:1px solid #eee}[mx-view*="mx-taginput/index"]{position:relative;width:320px;height:auto;min-height:32px;padding:2px 6px;border:1px solid #e6e6e6;border-radius:4px;transition:border-color .25s}[mx-view*="mx-taginput/index"]:hover{border-color:#ccc}[mx-view*="mx-taginput/index"] ._zs_gallerykw{height:auto;cursor:text}[mx-view*="mx-taginput/index"] ._zs_gallerykw ._zs_gallerykx,[mx-view*="mx-taginput/index"] ._zs_gallerykw ._zs_galleryky,[mx-view*="mx-taginput/index"] ._zs_gallerykw ._zs_gallerykz{height:24px;line-height:24px}[mx-view*="mx-taginput/index"] ._zs_gallerykw ._zs_galleryky{position:absolute;left:10px;top:50%;margin-top:-12px;color:#999;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}[mx-view*="mx-taginput/index"] ._zs_gallerykw ._zs_gallerykx,[mx-view*="mx-taginput/index"] ._zs_gallerykw ._zs_gallerykz{float:left;margin-top:2px;margin-bottom:2px}[mx-view*="mx-taginput/index"] ._zs_gallerykw ._zs_gallerykx{float:left;position:relative;max-width:220px;padding-right:26px;padding-left:6px;margin-right:4px;background-color:#eee;border-radius:4px;cursor:pointer;white-space:nowrap;word-wrap:normal;overflow:hidden;text-overflow:ellipsis}[mx-view*="mx-taginput/index"] ._zs_gallerykw ._zs_gallerykx ._zs_gallerykA{position:absolute;top:0;right:0;height:100%;width:20px;line-height:24px;text-align:center;font-size:12px;font-weight:700;color:#ccc;transition:color .25s;border-left:1px solid #fff}[mx-view*="mx-taginput/index"] ._zs_gallerykw ._zs_gallerykx ._zs_gallerykA:hover{color:#999}[mx-view*="mx-taginput/index"] ._zs_gallerykw ._zs_gallerykz{width:20px;padding:0;border:none;outline:none;background:transparent}[mx-view*="mx-taginput/index"][mx-disabled]{cursor:not-allowed;background-color:#fafafa}[mx-view*="mx-taginput/index"][mx-disabled] ._zs_gallerykw,[mx-view*="mx-taginput/index"][mx-disabled] ._zs_gallerykA,[mx-view*="mx-taginput/index"][mx-disabled] ._zs_gallerykB,[mx-view*="mx-taginput/index"][mx-disabled] ._zs_gallerykz{cursor:not-allowed}[mx-view*="mx-taginput/index"][mx-disabled]:hover{border-color:#e6e6e6}[mx-view*="mx-taginput/index"][mx-disabled] ._zs_gallerykx ._zs_gallerykA:hover{color:#ccc}[mx-view*="mx-taginput/index"] ._zs_gallerykC{display:none;position:absolute}');var l=e("$");i.exports=a.View.extend({tmpl:function(e,t,i,a,l,n,r,s){if(i||(i=e),!l){var _={"&":"amp","<":"lt",">":"gt",'"':"#34","'":"#39","`":"#96"},o=/[&<>"'`]/g,d=function(e){return"&"+_[e]+";"};l=function(e){return""+(null==e?"":e)},a=function(e){return l(e).replace(o,d)}}if(!n){var p={"!":"%21","'":"%27","(":"%28",")":"%29","*":"%2A"},u=function(e){return p[e]},x=/[!')(*]/g;n=function(e){return encodeURIComponent(l(e)).replace(x,u)}}if(!s){var g=/[\\'"]/g;s=function(e){return l(e).replace(g,"\\$&")}}r||(r=function(e,t,i,a){for(a=e[c];--a;)if(e[i=c+a]===t)return i;return e[i=c+e[c]++]=t,i});var c="",m="",v=e.viewId,f=e.items,h=e.placeholder,y=e.disabled,w=e.suggest,k=e.width,z=e.scrollTop;if(m+='<div mxv class="_zs_gallerykw unselectable clearfix" mx-click="'+t+'__eH()" id="ipt_'+a(v)+'">',!f.length&&h&&(m+='<span mxa="_zs_gallerydk:_" class="_zs_galleryky">'+a(h)+"</span>"),m+=" ",f.length){m+=" ";for(var b=0,j=f.length;b<j;b++){m+='<span mxa="_zs_gallerydk:a" class="_zs_gallerykx clearfix" mx-contextmenu="'+t+'prevent()">'+a(f[b].text)+'<i class="mc-iconfont _zs_gallerykA" mx-click="'+t+"__eK({idx:"+a(b)+'})">&#xe603;</i></span>'}m+=" "}return m+='<input class="_zs_gallerykz" autocomplete="off" mx-keydown="'+t+'__bV()" mx-keyup="'+t+'__bV()" mx-input="'+t+'__bV()" mx-paste="'+t+'__bV()" mx-pick="'+t+'__p()" mx-change="'+t+'__l()" mx-focusin="'+t+'__l()" mx-focusout="'+t+'__l()" mx-showlist="'+t+'__eL()" mx-hidelist="'+t+'__eL()" ',y&&(m+=' disabled="true" '),m+="/>",!y&&w&&w.length&&(m+='<div mxv="suggest,scrollTop" mx-view="mx-taginput/suggest?list='+r(i,w)+"&relateIds=ipt_"+n(v)+"&offsetLeft=-7&width="+n(k)+"&scrollTop="+r(i,z)+'" class="_zs_gallerykC"></div>'),m+="</div>"},init:function(e){var t=this,i=e.textKey||"text",n=e.valueKey||"value",r=e.list||[];r="object"==typeof r[0]?r.map(function(e){return{text:e[i],value:e[n]}}):r.map(function(e){return{text:e,value:e}});var s=e.selected||"";s=(s+"").split(",");var _=a.toMap(r,"value"),o=[];s.forEach(function(e){_[e]&&o.push(_[e])}),t.__cQ=r,t.__j=l("#"+t.id);var d=l("#"+t.id+"[mx-disabled]");t.updater.set({disabled:d&&d.length>0,placeholder:e.placeholder||"请选择",textKey:i,valueKey:n,map:_,items:o})},render:function(){var e=this,t=e.__j.outerWidth();0===t&&(t=320);var i=e.updater.get("items");e.updater.digest({suggest:e.__eE(i),width:t,viewId:e.id}),e.__bJ(),e.__eF()},__bJ:function(){var e=this.updater.get("items").map(function(e){return e.value});this.__j.val(e.join(","))},__eF:function(){var e=this,t=e.__j;e.__eG=t.find("input"),e.__eG.width(20);var i=l("#ipt_"+e.id).width()-e.__eG.position().left;e.__eG.width(i>=20?i:20)},__eE:function(e){for(var t=this.__cQ,i=(this.updater.get().map,e.map(function(e){return e.value+""})),a=[],l=0,n=void 0;l<t.length;l++)n=t[l],i.indexOf(n.value+"")<0&&a.push(n);return a},"__eH<click>":function(){this.updater.get("disabled")||this.__eG.focus()},__eJ:function(){var e=this;clearTimeout(e.__eI),e.__de=!0,e.__eG.focus(),e.__eI=setTimeout(e.wrapAsync(function(){delete e.__de}),20)},"__bV<keydown,input,paste,keyup>":function(e){e.stopPropagation();var t=this,i=e.eventTarget.value;if(t.__bK!==i){t.__bK=i;var a=t.__j.find("._zs_galleryky");i?a.hide():a.show()}if(!i&&"keydown"==e.type&&8==e.keyCode){var l=t.updater.get("items").length-1;l>-1&&(t["__eK<click>"]({params:{idx:l}}),t.__eJ())}},__y:function(){for(var e=this.updater,t=[],i=e.get("items"),a=e.get("valueKey"),n=0,r=void 0;n<i.length;n++)r=i[n],t.push(a?r[a]:r);l("#"+this.id).val(t.join(",")).trigger({type:"change",ids:t,items:i})},"__p<pick>":function(e){e.stopPropagation();var t=this,i=t.updater,a=i.get("items"),l=e.item;a.push(l),i.digest({items:a,scrollTop:e.scrollTop,suggest:t.__eE(a)}),t.__bJ(),t.__eF(),t.__eJ(),t.__y()},"__eK<click>":function(e){var t=this,i=t.updater.get();if(!i.disabled){var a=i.items,l=e.params.idx;a.splice(l,1),t.updater.digest({items:a,suggest:t.__eE(a)}),t.__bJ(),t.__eF(),t.__y(),t.__eJ()}},"__H<contextmenu>":function(e){e.preventDefault()},"__l<change,focusin,focusout>":function(e){e.stopPropagation();var t=this.__j;"focusin"==e.type&&t.addClass("input-focus")},"__eL<showlist,hidelist>":function(e){var t=this.__j;this.__de||(t.trigger({type:"showlist"==e.type?"focusin":"focusout"}),"hidelist"==e.type&&t.removeClass("input-focus"))}})});