define("mx-hour/index",["magix","$"],(e,l,s)=>{var r=e("magix"),a=e("$");r.applyStyle("_zs_galleryZ",'._zs_galleryhn{box-shadow:0 1px 1px 0 rgba(0,0,0,.08);border:1px solid #f5f5f6}._zs_galleryho{width:10%}._zs_galleryhp ._zs_galleryhq{padding-top:40px;padding-bottom:10px;border-bottom:1px solid #e6e6e6}._zs_galleryhp ._zs_galleryhq ._zs_galleryhr,._zs_galleryhp ._zs_galleryhq ._zs_galleryhs{float:left;height:36px;text-align:center;vertical-align:middle;cursor:pointer}._zs_galleryhp ._zs_galleryhq ._zs_galleryhr{position:relative;width:10%;margin-right:1.8%;border-radius:4px;color:#333;user-select:none;-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none}._zs_galleryhp ._zs_galleryhq ._zs_galleryhr ._zs_galleryht{position:absolute;top:-18px;width:100%;height:18px;line-height:18px;right:0;text-align:center;color:#999}._zs_galleryhp ._zs_galleryhq ._zs_galleryhr ._zs_galleryhu{width:100%;margin-top:8px;padding:0}._zs_galleryhp ._zs_galleryhq ._zs_galleryhs{position:relative;width:3.6%;color:#999;line-height:20px;font-weight:700;font-family:Tahoma}._zs_galleryhp ._zs_galleryhq ._zs_galleryhs._zs_galleryhv{width:1.8%}._zs_galleryhp ._zs_galleryhq ._zs_galleryhs ._zs_galleryhw{position:relative;height:36px}._zs_galleryhp ._zs_galleryhq ._zs_galleryhs ._zs_galleryhw:before{content:"";position:absolute;top:-16px;left:0;width:100%;height:16px;background-color:transparent}._zs_galleryhp ._zs_galleryhq ._zs_galleryhs ._zs_galleryhx{position:absolute;top:13px;left:0;width:0;height:10px;border-left:1px solid #e6e6e6}._zs_galleryhp ._zs_galleryhq ._zs_galleryhs ._zs_galleryhx ._zs_galleryhy{position:absolute;top:-31px;left:50%;width:40px;margin-left:-20px;color:#ccc}._zs_galleryhp ._zs_galleryhq ._zs_galleryhs._zs_galleryhz ._zs_galleryhx{height:16px}._zs_galleryhp ._zs_galleryhq ._zs_galleryhs._zs_galleryhA ._zs_galleryhw{background-color:#f6f9ff}._zs_galleryhp ._zs_galleryhq ._zs_galleryhs._zs_galleryhA ._zs_galleryhw:before{background-color:#4d7fff}._zs_galleryhp ._zs_galleryhq ._zs_galleryhs._zs_galleryhA ._zs_galleryhx{border-left:1px solid #d8e3ff}._zs_galleryhp ._zs_galleryhq ._zs_galleryhs._zs_galleryhA ._zs_galleryhx ._zs_galleryhy{color:#fff}._zs_galleryhp ._zs_galleryhq ._zs_galleryhs ._zs_galleryhB,._zs_galleryhp ._zs_galleryhq ._zs_galleryhs ._zs_galleryhC{position:absolute;top:0;width:0;height:36px;border-left:1px solid #4d7fff}._zs_galleryhp ._zs_galleryhq ._zs_galleryhs ._zs_galleryhB:before,._zs_galleryhp ._zs_galleryhq ._zs_galleryhs ._zs_galleryhC:before{content:"";position:absolute;top:0;right:-3px;width:0;height:0;border-left:4px solid transparent;border-right:4px solid transparent;border-top:4px solid #4d7fff}._zs_galleryhp ._zs_galleryhq ._zs_galleryhs ._zs_galleryhB ._zs_galleryhD,._zs_galleryhp ._zs_galleryhq ._zs_galleryhs ._zs_galleryhC ._zs_galleryhD{position:absolute;top:-16px;left:-10px;width:20px;height:16px;background-color:#4d7fff;color:#fff;text-align:center;line-height:16px;border-radius:2px}._zs_galleryhp ._zs_galleryhq ._zs_galleryhs ._zs_galleryhC{left:0}._zs_galleryhp ._zs_galleryhq ._zs_galleryhs ._zs_galleryhB{right:-1px}._zs_galleryhE{margin-right:1.8%;padding:10px 0;color:#999}'),s.exports=r.View.extend({tmpl:function(e,l,s,r,a,_,t,h){if(s||(s=e),!a){var i={"&":"amp","<":"lt",">":"gt",'"':"#34","'":"#39","`":"#96"},n=/[&<>"'`]/g,g=function(e){return"&"+i[e]+";"};a=function(e){return""+(null==e?"":e)},r=function(e){return a(e).replace(n,g)}}if(!_){var o={"!":"%21","'":"%27","(":"%28",")":"%29","*":"%2A"},d=function(e){return o[e]},p=/[!')(*]/g;_=function(e){return encodeURIComponent(a(e)).replace(p,d)}}if(!h){var y=/[\\'"]/g;h=function(e){return a(e).replace(y,"\\$&")}}var c="",z=e.simple,f=e.types,u=e.viewId,x=e.type,m=e.periods,v=e.tip;if(c+='<div mxv mxa="_zs_galleryb|:_" class="_zs_galleryhp">',!z){c+='<div mxv><span mxs="_zs_galleryb|:_" class="color-9 mr10">快捷操作：</span>';for(var b=0,w=f.length;b<w;b++){var q=f[b];c+='<label mxv mxa="_zs_galleryb|:a" class="mr40"><input type="radio" name="'+r(u)+'_opers" value="'+r(q.value)+'" mx-change="'+l+"changeType({type:'"+r(h(q.value))+"'})\" ",q.value==x&&(c+=' checked="true" '),c+="/>"+r(q.text)+"</label>"}c+="</div>"}c+=" ";for(var k=0,E=m.length;k<E;k++){var A=m[k];c+='<ul mxa="_zs_galleryb|:b" class="_zs_galleryhq clearfix"><li mxa="_zs_galleryb|:c" class="_zs_galleryhr"><span mxs="_zs_galleryb|:a" class="_zs_galleryht">时间段</span><a href="javascript:;" class="btn btn-small _zs_galleryhu ',A.selected&&(c+=" btn-brand "),c+='" mx-click="'+l+"toggleAll({pIndex:"+r(k)+'})">'+r(A.name)+"</a></li>";for(var I=0,S=A.hours,C=S.length;I<C;I++){var D=S[I];c+='<li mx-mousedown="'+l+'drag()" class="_zs_galleryhs ',D.milestone&&(c+=" _zs_galleryhz "),c+=" ",D.selected&&(c+=" _zs_galleryhA "),c+='" data-period="'+r(k)+'" data-hour="'+r(D.index)+'"><div mxs="_zs_galleryb|:b" class="_zs_galleryhw"></div><div class="_zs_galleryhC ',D.firstSelected||(c+=" hide "),c+='" style="z-index: '+r(D.zIndex)+';"><span mxa="_zs_galleryb|:d" class="_zs_galleryhD">'+r(D.index)+'</span></div><div class="_zs_galleryhB ',D.endSelected||(c+=" hide "),c+='" style="z-index: '+r(D.zIndex)+'"><span mxa="_zs_galleryb|:e" class="_zs_galleryhD">'+r(D.indexNext)+'</span></div><div mxa="_zs_galleryb|:f" class="_zs_galleryhx"><span mxa="_zs_galleryb|:g" class="_zs_galleryhy">'+r(D.index)+"</span></div></li>"}c+='<li mxs="_zs_galleryb|:c" class="_zs_galleryhs _zs_galleryhz _zs_galleryhv"><span class="_zs_galleryhx"><span class="_zs_galleryhy">24</span></span></li></ul>'}return c+='</div><div mxa="_zs_galleryb|:h" class="clearfix _zs_galleryhE"><a mxs="_zs_galleryb|:d" mx-click="'+l+'clearAll()" href="javascript:;" class="btn btn-small _zs_galleryho"><i class="mc-iconfont displacement-2 mr5 color-9">&#xe72e;</i>清空</a><span mxa="_zs_galleryb|:i" class="fr lh28">'+r(v)+"</span></div>"},init:function(e){var l=this,s=e.tip||"",r=e.simple+""!="false",a=e.selected||[],_={};a.forEach(function(e){_[e.week]=e.times||[]});var t;t=r?[{name:"周一至周五",week:"12345"},{name:"周六至周日",week:"67"}]:[{name:"周一",week:1},{name:"周二",week:2},{name:"周三",week:3,times:[0]},{name:"周四",week:4},{name:"周五",week:5},{name:"周六",week:6},{name:"周日",week:7}],l.$selected={},t.forEach(function(e,s){var r=(_[e.week]||[]).map(function(e){return e+""}),a=function(){for(var e=[],l=0;l<24;l++)e.push({index:l,indexNext:l+1,milestone:l%6==0,zIndex:l+10});return e}();a.forEach(function(e){e.selected=r.indexOf(e.index+"")>-1,e.selected&&(l.$selected[s+"_"+e.index]=!0)}),e.hours=a}),l.updater.set({viewId:l.id,tip:s,periods:l.sync(t),simple:r,type:"",types:[{text:"全日程",value:1},{text:"工作日",value:2},{text:"双休日",value:3}]})},render:function(){this.updater.digest()},sync:function(e){return e.forEach(function(e){for(var l=e.hours,s=!0,r=0;r<l.length;r++){var a=l[r],_=l[r-1],t=l[r+1];a.firstSelected=!1,a.endSelected=!1,a.selected&&((_&&!_.selected||!_)&&(a.firstSelected=!0),(t&&!t.selected||!t)&&(a.endSelected=!0)),s=s&&a.selected}e.selected=s}),e},"clearAll<click>":function(e){var l=this.updater.get("periods");l.forEach(function(e){e.hours.forEach(function(e){e.selected=!1})}),this.updater.digest({periods:this.sync(l)})},"toggleAll<click>":function(e){var l=this.updater.get("periods"),s=l[e.params.pIndex],r=!s.selected;s.hours.forEach(function(e){e.selected=r}),this.updater.digest({periods:this.sync(l)})},"drag<mousedown>":function(e){var l=this,s=l.updater.get("periods"),r=a(e.eventTarget),_=r.data("period"),t=r.data("hour"),h=!s[_].hours[t].selected;l.toggle(_,t,h);var i=r.parent("._zs_galleryhq").find("[data-hour]");return i.on("mouseenter.drag",function(e){e.preventDefault();var s=a(this);l.toggle(s.data("period"),s.data("hour"),h)}),a(document.body).off("mouseup.drag").on("mouseup.drag",function(e){i.off("mouseenter.drag")}),e.preventDefault(),!1},toggle:function(e,l,s){var r=this.updater.get("periods");r[e].hours[l].selected=s,this.updater.digest({periods:this.sync(r)})},"changeType<change>":function(e){var l=e.params.type,s=this.updater.get("periods"),r=[];switch(+l){case 2:r=[6,7];break;case 3:r=[1,2,3,4,5]}s.forEach(function(e){e.hours.forEach(function(l){l.selected=r.indexOf(e.week)<0})}),this.updater.digest({type:l,periods:this.sync(s)})},val:function(){var e=this.updater.get("periods"),l=[];return e.forEach(function(e){var s=[];e.hours.forEach(function(e){e.selected&&s.push(e.index)}),l.push({week:e.week,name:e.name,times:s})}),l}})});