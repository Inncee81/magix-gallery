define("mx-preview/index",["magix","$"],(e,i,r)=>{var a,t=e("magix"),l=e("$");t.applyStyle("_zs_galleryae",'[mx-view*="mx-preview/index"]{display:inline-block}._zs_galleryiN{color:#ccc;font-size:30px}._zs_galleryiO{display:table;text-align:center}._zs_galleryiO ._zs_galleryiP{display:table-cell;vertical-align:middle}._zs_galleryiO ._zs_galleryiP ._zs_galleryiQ,._zs_galleryiO ._zs_galleryiP ._zs_galleryiR{max-width:100%;max-height:100%}._zs_galleryiO ._zs_galleryiP ._zs_galleryiS{white-space:nowrap;word-wrap:normal;overflow:hidden;text-overflow:ellipsis}._zs_galleryiO ._zs_galleryiP ._zs_galleryiT{font-size:20px;color:#999}._zs_galleryiO ._zs_galleryiP ._zs_galleryiU{-webkit-transform-origin:left top;transform-origin:left top}._zs_galleryiV{display:none;position:absolute;z-index:99999;box-shadow:0 2px 4px rgba(51,51,51,.08);border-collapse:separate;background-color:#fff;padding:10px}._zs_galleryiV ._zs_galleryiW{display:block;width:100%;height:100%;overflow:hidden}'),r.exports=t.View.extend({tmpl:function(e,i,r,a,t,l,n,s){if(r||(r=e),!t){var o={"&":"amp","<":"lt",">":"gt",'"':"#34","'":"#39","`":"#96"},c=/[&<>"'`]/g,d=function(e){return"&"+o[e]+";"};t=function(e){return""+(null==e?"":e)},a=function(e){return t(e).replace(c,d)}}if(!l){var g={"!":"%21","'":"%27","(":"%28",")":"%29","*":"%2A"},h=function(e){return g[e]},m=/[!')(*]/g;l=function(e){return encodeURIComponent(t(e)).replace(m,h)}}if(!s){var _=/[\\'"]/g;s=function(e){return t(e).replace(_,"\\$&")}}var f="",p=e.maxWidth,v=e.maxHeight,u=e.viewId;return f+='<div class="_zs_galleryiO" style="width: '+a(p)+"px; height: "+a(v)+'px;" mx-mouseover="'+i+'preview()" mx-mouseout="'+i+'hide()"><div class="_zs_galleryiP" style="height: '+a(v)+'px;" id="'+a(u)+'_inner"><i mxs="_zs_galleryb+:_" class="mc-iconfont _zs_galleryiN">&#xe615;</i></div></div>'},init:function(e){var i=this;i.extra=e,i.on("destroy",function(){clearTimeout(i.timer),l("#pic_preview_"+i.id).remove()})},render:function(){var e=this,i=e.extra,r=+i.format||5,a=+i.width,t=+i.height;a||(a=640,t=0);var l,n,s,o=+i.maxWidth||100,c=+i.maxHeight||100,d=i.url,g=i.clickUrl,h=i.xiaotuUrl,m=i.datuUrl;if(10==r?(n=a*(l=Math.min(+o/+a,+c/+t)),s=t*l):23==r&&(d=i.xiaotuUrl),e.updater.digest({viewId:e.id,format:r,url:d,clickUrl:g,width:a,height:t,maxWidth:o,maxHeight:c,frameWidth:n,frameHeight:s,scale:l,xiaotuUrl:h,datuUrl:m}),window.IntersectionObserver){var _=new IntersectionObserver(function(i){i.forEach(function(i){var r=i.target;i.isIntersecting&&(e.thumbnail(),_.unobserve(r))})},{rootMargin:"10px 0px"});_.observe(document.querySelector("#"+e.id))}else e.thumbnail()},thumbnail:function(){var e=this.updater.get(),i=e.format,r=e.url,a=e.width,t=e.height,n=e.maxWidth,s=(e.maxHeight,e.clickUrl),o="";switch(i){case 2:case 11:case 23:o='<img class="_zs_galleryiQ" src="'+r+'"/>';break;case 3:case 9:o="flash已下线";case 4:o='<video src="'+r+'" class="_zs_galleryiR"></video>';break;case 5:(o=l('<div class="_zs_galleryiS" style="max-width: '+n+'px;"></div>'))[0].innerText=r;break;case 10:o='<div style="width: '+e.frameWidth+"px; height: "+e.frameHeight+'px; overflow: hidden">\n                                <iframe src="'+r+'" class="_zs_galleryiU"\n                                    style="transform:scale('+e.scale+')"\n                                    width="'+a+'" \n                                    height="'+t+'" \n                                    frameborder="0"\n                                    scrolling="no" \n                                    marginheight="0" \n                                    marginwidth="0" \n                                    border="0"></iframe>\n                            </div>'}s&&(o=l(o).wrap('<a href="'+s+'" target="_blank" rel="noopener noreferrer"></a>')),l("#"+this.id+"_inner").html(o)},"preview<mouseover>":function(e){var i=this;if(!t.inside(e.relatedTarget,e.eventTarget)){a&&a!=i&&a.immediatelyHide(),a=i,clearTimeout(i.timer);var r=i.updater.get(),n=l(e.eventTarget),s=n.offset(),o=r.format,c=r.url,d=r.datuUrl,g=r.clickUrl,h=+r.width+20,m=+r.height+20,_=s.left+n.outerWidth()+10,f=s.top;if(!c||!o||3==o||9==o)return;var p=function(){var e=l(window),a=e.width(),t=e.height(),n=e.scrollTop(),s=a-_;if(s<h&&(m*=s/h,h=s),m>t&&(h=h*t/m,m=t),n+t<f+m){var p=Math.min(f+m-n-t,f-n);f-=p}var v="";switch(+o){case 2:case 11:v=l('<img src="'+c+'" class="_zs_galleryiW"/>');break;case 4:v=l('<video src="'+c+'" class="_zs_galleryiW"\n                            controls="controls" autoplay="autoplay"></video>');break;case 5:(v=l('<div class="_zs_galleryiW"></div>'))[0].innerText=c;break;case 10:var u=+r.width,y=+r.height;v=l('<div class="_zs_galleryiW">\n                            <iframe src="'+c+'"\n                                style="transform: scale('+(h-20)/u+'); transform-origin: left top;"\n                                width="'+u+'" \n                                height="'+y+'"\n                                frameborder="0" \n                                scrolling="no" \n                                marginheight="0" \n                                marginwidth="0" \n                                border="0"></iframe>\n                        </div>');break;case 23:v=l('<div class="clearfix">\n                            <img src="'+c+'" class="fl mr10"/>    \n                            <img src="'+d+'" class="fl"/>\n                        </div>')}var w=l("#pic_preview_"+i.id);w.length||(w=l('<div id="pic_preview_'+i.id+'" class="_zs_galleryiV"></div>').appendTo("body")),w.empty().append(v),g&&v.wrap('<a href="'+g+'" target="_blank" rel="noopener noreferrer"></a>'),w.css({width:h,height:r.height?m:"auto",left:_,top:f,display:"block"})};if(d){var v=new Image;v.onload=function(){h=h+10+this.width,m=Math.max(m,this.height+20),p()},v.src=d}else p()}},"hide<mouseout>":function(e){var i=this;if(!t.inside(e.relatedTarget,e.eventTarget)){i.delayHide();var r=l("#pic_preview_"+i.id);r.off("mouseover.preview").on("mouseover.preview",function(){clearTimeout(i.timer),r.off("mouseout.preview").on("mouseout.preview",function(e){i.delayHide()})})}},immediatelyHide:function(){clearTimeout(this.timer),l("#pic_preview_"+this.id).empty().css({display:"none"})},delayHide:function(){var e=this;clearTimeout(e.timer),e.timer=setTimeout(function(){l("#pic_preview_"+e.id).empty().css({display:"none"})},300)}})});