define("mx-preview/index",["magix","$"],(e,r,i)=>{var a,t=e("magix"),l=e("$");t.applyStyle("_zs_galleryaq",'._zs_gallerykH{box-shadow:0 1px 1px 0 rgba(0,0,0,.08);border:1px solid #f5f5f6}[mx-view*="mx-preview/index"]{display:inline-block}._zs_gallerykI{color:#ccc;font-size:30px}._zs_gallerykJ{display:table;text-align:center}._zs_gallerykJ ._zs_gallerykK{display:table-cell;vertical-align:middle}._zs_gallerykJ ._zs_gallerykK ._zs_gallerykL,._zs_gallerykJ ._zs_gallerykK ._zs_gallerykM{max-width:100%;max-height:100%}._zs_gallerykJ ._zs_gallerykK ._zs_gallerykN{white-space:nowrap;word-wrap:normal;overflow:hidden;text-overflow:ellipsis}._zs_gallerykJ ._zs_gallerykK ._zs_gallerykO{font-size:20px;color:#999}._zs_gallerykJ ._zs_gallerykK ._zs_gallerykP{-webkit-transform-origin:left top;transform-origin:left top}._zs_gallerykQ{display:none;position:absolute;z-index:99999;border-collapse:separate;background-color:#fff;padding:10px;box-shadow:0 1px 1px 0 rgba(0,0,0,.08);border:1px solid #f5f5f6}._zs_gallerykQ ._zs_gallerykR{display:block;width:100%;height:100%;overflow:hidden}'),i.exports=t.View.extend({tmpl:function(e,r,i,a,t,l,s,n){if(i||(i=e),!t){var o={"&":"amp","<":"lt",">":"gt",'"':"#34","'":"#39","`":"#96"},d=/[&<>"'`]/g,c=function(e){return"&"+o[e]+";"};t=function(e){return""+(null==e?"":e)},a=function(e){return t(e).replace(d,c)}}if(!l){var g={"!":"%21","'":"%27","(":"%28",")":"%29","*":"%2A"},h=function(e){return g[e]},_=/[!')(*]/g;l=function(e){return encodeURIComponent(t(e)).replace(_,h)}}if(!n){var m=/[\\'"]/g;n=function(e){return t(e).replace(m,"\\$&")}}var f="",p=e.maxWidth,v=e.maxHeight,u=e.preview,y=e.viewId;return f+='<div class="_zs_gallerykJ" style="width: '+a(p)+"px; height: "+a(v)+'px;" ',u&&(f+=' mx-mouseover="'+r+'preview()" mx-mouseout="'+r+'hide()" '),f+='><div class="_zs_gallerykK" style="height: '+a(v)+'px;" id="'+a(y)+'_inner"><i mxs="_zs_galleryc9:_" class="mc-iconfont _zs_gallerykI">&#xe615;</i></div></div>'},init:function(e){var r=this;r.extra=e,r.on("destroy",function(){clearTimeout(r.timer),l("#pic_preview_"+r.id).remove()})},render:function(){var e=this,r=e.extra,i=+r.format||5,a=+r.width,t=+r.height;a||(a=640,t=0);var l,s,n,o=+r.maxWidth||100,d=+r.maxHeight||100,c=r.url,g=r.clickUrl,h=r.xiaotuUrl,_=r.datuUrl;if(10==i?(s=a*(l=Math.min(+o/+a,+d/+t)),n=t*l):23==i&&(c=r.xiaotuUrl),e.updater.digest({viewId:e.id,preview:r.preview+""!="false",format:i,url:c,clickUrl:g,width:a,height:t,maxWidth:o,maxHeight:d,frameWidth:s,frameHeight:n,scale:l,xiaotuUrl:h,datuUrl:_}),window.IntersectionObserver){var m=new IntersectionObserver(function(r){r.forEach(function(r){var i=r.target;r.isIntersecting&&(e.thumbnail(),m.unobserve(i))})},{rootMargin:"10px 0px"});m.observe(document.querySelector("#"+e.id))}else e.thumbnail()},thumbnail:function(){var e=this.updater.get(),r=e.format,i=e.url,a=e.width,t=e.height,s=e.maxWidth,n=(e.maxHeight,e.clickUrl),o="";switch(r){case 2:case 11:case 23:o='<img class="_zs_gallerykL" src="'+i+'"/>';break;case 3:case 9:o="flash已下线";case 4:o='<video src="'+i+'" class="_zs_gallerykM"></video>';break;case 5:(o=l('<div class="_zs_gallerykN" style="max-width: '+s+'px;"></div>'))[0].innerText=i;break;case 10:o='<div style="width: '+e.frameWidth+"px; height: "+e.frameHeight+'px; overflow: hidden">\n                                <iframe src="'+i+'" class="_zs_gallerykP"\n                                    style="transform:scale('+e.scale+')"\n                                    width="'+a+'" \n                                    height="'+t+'" \n                                    frameborder="0"\n                                    scrolling="no" \n                                    marginheight="0" \n                                    marginwidth="0" \n                                    border="0"></iframe>\n                            </div>'}n&&(o=l(o).wrap('<a href="'+n+'" target="_blank" rel="noopener noreferrer"></a>')),l("#"+this.id+"_inner").html(o)},"preview<mouseover>":function(e){var r=this;if(!t.inside(e.relatedTarget,e.eventTarget)){a&&a!=r&&a.immediatelyHide(),a=r,clearTimeout(r.timer);var i=r.updater.get(),s=l(e.eventTarget),n=s.offset(),o=i.format,d=i.url,c=i.datuUrl,g=i.clickUrl,h=+i.width+20,_=+i.height+20,m=n.left+s.outerWidth()+10,f=n.top;if(!d||!o||3==o||9==o)return;var p=function(){var e=l(window),a=e.width(),t=e.height(),s=e.scrollTop(),n=a-m;if(n<h&&(_*=n/h,h=n),_>t&&(h=h*t/_,_=t),s+t<f+_){var p=Math.min(f+_-s-t,f-s);f-=p}var v="";switch(+o){case 2:case 11:v=l('<img src="'+d+'" class="_zs_gallerykR"/>');break;case 4:v=l('<video src="'+d+'" class="_zs_gallerykR"\n                            controls="controls" autoplay="autoplay"></video>');break;case 5:(v=l('<div class="_zs_gallerykR"></div>'))[0].innerText=d;break;case 10:var u=+i.width,y=+i.height;v=l('<div class="_zs_gallerykR">\n                            <iframe src="'+d+'"\n                                style="transform: scale('+(h-20)/u+'); transform-origin: left top;"\n                                width="'+u+'" \n                                height="'+y+'"\n                                frameborder="0" \n                                scrolling="no" \n                                marginheight="0" \n                                marginwidth="0" \n                                border="0"></iframe>\n                        </div>');break;case 23:v=l('<div class="clearfix">\n                            <img src="'+d+'" class="fl mr10"/>    \n                            <img src="'+c+'" class="fl"/>\n                        </div>')}var w=l("#pic_preview_"+r.id);w.length||(w=l('<div id="pic_preview_'+r.id+'" class="_zs_gallerykQ"></div>').appendTo("body")),w.empty().append(v),g&&v.wrap('<a href="'+g+'" target="_blank" rel="noopener noreferrer"></a>'),w.css({width:h,height:i.height?_:"auto",left:m,top:f,display:"block"})};if(c){var v=new Image;v.onload=function(){h=h+10+this.width,_=Math.max(_,this.height+20),p()},v.src=c}else p()}},"hide<mouseout>":function(e){var r=this;if(!t.inside(e.relatedTarget,e.eventTarget)){r.delayHide();var i=l("#pic_preview_"+r.id);i.off("mouseover.preview").on("mouseover.preview",function(){clearTimeout(r.timer),i.off("mouseout.preview").on("mouseout.preview",function(e){r.delayHide()})})}},immediatelyHide:function(){clearTimeout(this.timer),l("#pic_preview_"+this.id).empty().css({display:"none"})},delayHide:function(){var e=this;clearTimeout(e.timer),e.timer=setTimeout(function(){l("#pic_preview_"+e.id).empty().css({display:"none"})},300)}})});