define("mx-dialog/index",["magix","$","../mx-medusa/util","mx-popover/index"],(e,a,l)=>{e("mx-popover/index");var t=e("magix"),i=e("$"),o=t.Vframe,r=e("../mx-medusa/util");t.applyStyle("_zs_galleryD","._zs_gallerydV{box-shadow:0 1px 1px 0 rgba(0,0,0,.08);border:1px solid #f5f5f6}._zs_gallerydW,._zs_gallerydX{position:fixed;left:0;width:100%;height:100%;transition:all .25s}._zs_gallerydW{opacity:0;top:0;background-color:rgba(0,0,0,.4)}._zs_gallerydW._zs_gallerydY{opacity:1}._zs_gallerydZ{position:absolute;border-radius:4px;background-color:#fff;box-shadow:0 1px 1px 0 rgba(0,0,0,.08);border:1px solid #f5f5f6}._zs_gallerydZ ._zs_gallerye_{position:relative;word-break:break-all}._zs_gallerydZ ._zs_galleryea{position:absolute;top:16px;right:24px;width:26px;height:26px;z-index:20;border-radius:50%;background:transparent;color:#ccc;text-align:center}._zs_gallerydZ ._zs_galleryea ._zs_galleryeb{font-size:18px;font-weight:700;line-height:26px}._zs_gallerydZ ._zs_galleryea:focus,._zs_gallerydZ ._zs_galleryea:hover{background-color:#999;color:#fff}._zs_gallerydZ._zs_galleryec{border-radius:0}._zs_galleryed{position:relative}._zs_galleryed ._zs_galleryee{opacity:1;position:relative;z-index:1}._zs_galleryed ._zs_galleryef{display:none;position:absolute;top:50%;left:50%;z-index:2;margin-top:-2px;margin-left:-2px}._zs_galleryed._zs_galleryeg ._zs_galleryee{opacity:0}._zs_galleryed._zs_galleryeg ._zs_galleryef{display:inline}");var n=500,s=[];l.exports=t.View.extend({tmpl:function(e,a,l,t,i,o,r,n){if(l||(l=e),!i){var s={"&":"amp","<":"lt",">":"gt",'"':"#34","'":"#39","`":"#96"},d=/[&<>"'`]/g,c=function(e){return"&"+s[e]+";"};i=function(e){return""+(null==e?"":e)},t=function(e){return i(e).replace(d,c)}}if(!o){var g={"!":"%21","'":"%27","(":"%28",")":"%29","*":"%2A"},_=function(e){return g[e]},p=/[!')(*]/g;o=function(e){return encodeURIComponent(i(e)).replace(p,_)}}if(!n){var f=/[\\'"]/g;n=function(e){return i(e).replace(f,"\\$&")}}var m="",u=e.closable,x=e.cntId,h=e.full,y=e.fullHeader,v=e.fullFooter;return u&&(m+='<a mxs="_zs_galleryaR:_" href="javascript:;" mx-click="'+a+'__aG()" class="_zs_galleryea"><i class="mc-iconfont _zs_galleryeb">&#xe603;</i></a>'),m+='<div class="_zs_gallerye_" id="'+t(x)+'_content">',h?(m+=" ",y.title&&(m+='<div class="dialog-header" id="'+t(x)+'_header"><span mxa="_zs_galleryaR:_" class="header-name">'+i(y.title)+"</span>",y.iconTip&&(m+='<i class="mc-iconfont color-c" mx-view="mx-popover/index?content='+o(y.iconTip)+'">&#xe7aa;</i>'),m+=" ",y.tip&&(m+='<span mxa="_zs_galleryaR:a" class="color-9 ml10">'+i(y.tip)+"</span>"),m+="</div>"),m+='<div id="'+t(x)+'"><div mxs="_zs_galleryaR:a" class="loading" style="padding: 150px 0;"><span class="loading-anim"></span></div></div>',(v.enter||v.cancel)&&(m+='<div class="dialog-footer clearfix" id="'+t(x)+'_footer">',v.enter&&(m+='<a mxa="_zs_galleryaR:b" href="javascript:;" class="fl btn btn-brand min-width-60 mr16 _zs_galleryed" mx-click="'+a+'__aH()"><span mxa="_zs_galleryaR:c" class="_zs_galleryee">'+i(v.enterText)+"</span></a>"),m+=" ",v.cancel&&(m+='<a mxa="_zs_galleryaR:d" href="javascript:;" class="fl btn min-width-60 mr16" mx-click="'+a+'__aG()">'+i(v.cancelText)+"</a>"),m+=" ",v.enter&&(m+='<span id="'+t(x)+'_footer_error" class="fl lh32 color-red"></span>'),m+="</div>"),m+=" "):m+='<div id="'+t(x)+'"><div mxs="_zs_galleryaR:a" class="loading" style="padding: 150px 0;"><span class="loading-anim"></span></div></div>',m+="</div>"},init:function(e){var a=this;a.on("destroy",function(){!function(e){for(var a=s.length-1;a>=0;a--)if(s[a].id==e.id){s.splice(a,1);break}}(a),n-=2,i("#"+a.id).trigger("dlg_close")}),n+=2,s.push(a),t.has(e,"closable")||(e.closable=!0),a.updater.set(t.mix({cntId:"cnt_"+a.id},e))},render:function(){var e=this,a=e.updater,l=a.get();a.digest(),setTimeout(e.wrapAsync(function(){var a=i("#wrapper_"+e.id);a.css(l.posTo);var o=l.cntId;if(l.full){var r=window.innerHeight,n=i("#"+o+"_header"),s=i("#"+o+"_footer");n&&n.length&&(r-=n.outerHeight()),s&&s.length&&(r-=s.outerHeight());var d={height:r-2,overflowY:"auto"};l.card&&(d.backgroundColor="#e8ebf2",d.padding="16px 24px"),i("#"+o).css(d)}var c=i("#mask_"+e.id);c.length>0?c.addClass("_zs_gallerydY"):a.on("click",function(a){t.inside(a.target,o+"_content")||i("#"+e.id).trigger("dlg_close")}),e.owner.mountVframe(o,l.view,l),a.on("scroll",function(){i(document).trigger("dialogScolll")})}),250)},__aF:function(e){var a=o.get("cnt_"+this.id);a&&a.invoke("fire",["unload",e])},"__aH<click>":function(e){var a=i(e.eventTarget),l="_zs_galleryeg";if(!a.hasClass(l)){a.addClass(l),a.append('<span class="mx-anim-loading _zs_galleryef"></span>');var t=this,r=t.updater.get(),n=r.cntId;o.get(n).invoke("check").then(function(e){a.find("._zs_galleryef").remove(),a.removeClass(l);var o=i("#"+n+"_footer_error");e.ok?(o.html(""),t["__aG<click>"](),r.callback&&r.callback(e.data||{})):e.msg?o.html('<i class="mc-iconfont displacement-2">&#xe6ad;</i>'+e.msg):o.html("")})}},"__aG<click>":function(){i("#"+this.id).trigger("dlg_close")},"$doc<keyup>":function(e){if(27==e.keyCode){var a=s[s.length-1];if(a==this&&a.updater.get("closable"))i("#"+a.id).trigger("dlg_close")}}},{__aI:function(e,a){var l=t.guid("dlg_");if(a.mask){var o=i('<div class="_zs_gallerydW" id="mask_'+l+'" />');o.css({zIndex:n-1}),i(document.body).append(o)}var r="wrapper_"+l,d=n,c=a.width,g=a.left,_=a.top,p=i('<div class="_zs_gallerydX" id="'+r+'"\n    style="z-index:'+d+'">\n    <div class="_zs_gallerydZ '+(a.full?"_zs_galleryec":"")+'" id="'+l+'"\n        style="top:'+_+"px; left:"+g+"px; width:"+c+'px;"></div>\n</div>');p.css(a.posFrom),i(document.body).append(p),window.innerWidth-document.body.clientWidth>0&&(document.body.style.paddingRight=window.innerWidth-document.body.clientWidth+"px"),document.body.style.overflowY="hidden",p.css({overflowY:a.modal?"hidden":"auto"});var f,m=e.owner.mountVframe(l,"mx-dialog/index",a),u=i("#"+l);return u.on("dlg_close",function(){u.data("closed")||u.trigger({type:"beforeClose",closeFn:function(){if(!u.data("closing")&&!f){var t=function(){u.data("closing",1),i("#wrapper_"+l).css(a.posFrom),i("#mask_"+l).removeClass("_zs_gallerydY"),setTimeout(function(){u.trigger("close"),u.data("closed",1),e.owner&&e.owner.unmountVframe(l),i("#wrapper_"+l).remove(),i("#mask_"+l).remove(),0==s.length&&(document.body.style.paddingRight="",document.body.style.overflowY="")},250)},o={prevent:function(){f=1},resolve:function(){o.p=1,f=0,t()},reject:function(){o.p=1,f=0}};m.invoke("__aF",[o]),f||o.p||t()}}})})},alert:function(e,a,l,i){var o=(i=i||{}).btns+""!="false";return this.mxDialog("mx-dialog/alert",{title:e,content:a,enterCallback:l,hasBtns:o},t.mix({width:320,closable:!1,mask:!1},i))},confirm:function(e,a){return this.mxDialog("mx-dialog/confirm",e,t.mix({width:320,closable:!1,mask:!1},a||{}))},mxDialogGroup:function(e,a){return e.height=a.height||500,this.mxDialog("mx-dialog/group",e,t.mix({width:800,closable:!0,mask:!0},a||{}))},mxModal:function(e,a,l){return l=l||{},this.mxDialog(e,a,t.mix({closable:!0,mask:!0},t.mix(l||{},{full:!0,fullHeader:t.mix({title:"",tip:"",iconTip:""},l.header||{}),fullFooter:t.mix({enter:!0,enterText:r["dialog.submit"],cancel:!0,cancelText:r["dialog.cancel"]},l.footer||{}),modal:!1,height:window.innerHeight,placement:"right",card:l.card+""!="false"})))},mxDialog:function(e,a,l){var o,r,n,s=this,d={beforeClose:function(e){r=e},close:function(){o&&o.trigger("dlg_close")},afterClose:function(e){n=e}},c={view:e};return seajs.use(e,s.wrapAsync(function(g){var _="$dlg_"+e;if(!s[_]){s[_]=1;var p,f,m,u,x=g.dialogOptions||{},h=(l=l||{}).placement||x.placement||"center",y=l.width||x.width||400,v=l.height||x.height||260,z=window.innerWidth,b=window.innerHeight,w=l.target||x.target;if(w){var k=void 0;k="string"!=typeof w||/^#/.test(w)||/^\./.test(w)?i(w):i("#"+w);var C=l.offset||x.offset||{};C.top=+C.top||0,C.left=+C.left||0;var T=k.offset(),R=T.top+k.outerHeight()+10-i(window).scrollTop()+C.top,H=T.left-(y-k.outerWidth())/2+C.left;m={opacity:0,top:R-50,left:H},u={opacity:1,top:R,left:H}}else switch(h){case"center":p=(z-y)/2,f=Math.max((b-v)/2,0),m={opacity:0,top:"-50px"},u={opacity:1,top:0};break;case"right":p=z-y,f=0,m={opacity:0,top:0,left:z},u={opacity:1,top:0,left:0}}t.mix(c,{mask:!0,modal:!1,width:y,closable:!0,left:p,top:f,posFrom:m,posTo:u},x,l),t.mix(c,a),c.dialog=d,(o=s.__aI(s,c)).on("beforeClose",function(e){(!r||r&&r())&&e.closeFn()}),o.on("close",function(){delete s[_],n&&n()})}})),d},mxCloseAllDialogs:function(){s.forEach(function(e){var a=i("#"+e.id);a&&a.trigger("dlg_close")})}})});