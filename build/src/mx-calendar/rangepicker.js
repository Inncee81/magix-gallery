define("mx-calendar/rangepicker",["magix","$","../mx-util/monitor","mx-calendar/util","mx-medusa/util","./range"],(t,e,r)=>{t("./range");var a=t("magix"),s=t("$"),i=t("../mx-util/monitor"),n=t("mx-calendar/util"),l=n.dateFormat,_=n.getDefaultDate,o=n.getQuickInfos,g=n.getOffsetDate,d=t("mx-medusa/util");a.applyStyle("_zs_galleryo","._zs_gallerybw{position:relative;padding:0 10px}._zs_gallerybw._zs_gallerybx ._zs_galleryby{padding:0 5px}._zs_gallerybw._zs_gallerybz ._zs_galleryby{position:absolute;top:50%;left:50%;width:40px;height:30px;margin-left:-20px;margin-top:-15px;line-height:30px;text-align:center}._zs_gallerybw._zs_gallerybz ._zs_gallerybA{display:inline-block;width:50%;text-align:center}._zs_gallerybw._zs_gallerybz ._zs_gallerybB{padding-right:10px}._zs_gallerybw._zs_gallerybz ._zs_gallerybC{padding-left:10px}._zs_gallerybw._zs_gallerybD ._zs_gallerybB{color:var(--color-brand)}._zs_gallerybw._zs_gallerybD ._zs_gallerybC{color:var(--color-brand-vs)}[mx-disabled] ._zs_gallerybw._zs_gallerybD ._zs_gallerybB,[mx-disabled] ._zs_gallerybw._zs_gallerybD ._zs_gallerybC,[mx-disabled]:hover ._zs_gallerybw._zs_gallerybD ._zs_gallerybB,[mx-disabled]:hover ._zs_gallerybw._zs_gallerybD ._zs_gallerybC{color:#999}");var u=a.View.extend({tmpl:function(t,e,r,a,s,i,n,l){if(r||(r=t),!s){var _={"&":"amp","<":"lt",">":"gt",'"':"#34","'":"#39","`":"#96"},o=/[&<>"'`]/g,g=function(t){return"&"+_[t]+";"};s=function(t){return""+(null==t?"":t)},a=function(t){return s(t).replace(o,g)}}if(!i){var d={"!":"%21","'":"%27","(":"%28",")":"%29","*":"%2A"},u=function(t){return d[t]},c=/[!')(*]/g;i=function(t){return encodeURIComponent(s(t)).replace(c,u)}}if(!l){var p=/[\\'"]/g;l=function(t){return s(t).replace(p,"\\$&")}}n||(n=function(t,e,r,a){for(a=t[y];--a;)if(t[r=y+a]===e)return r;return t[r=y+t[y]++]=e,r});var y="",f="",h=t.textAlign,b=t.rangeInfo,v=t.viewId,m=t.result,x=t.show,z=t.left,S=t.top;return f+='<div class="mx-trigger _zs_gallerybw '+a(h)+" ",b.vs&&(f+=" _zs_gallerybD "),f+='" id="trigger_'+a(v)+'" mx-click="'+e+'__p()" mx-change="'+e+'__m()">',m.endStr?f+='<span mxa="_zs_gallery[:_" class="_zs_gallerybA _zs_gallerybB">'+a(m.startStr)+'</span><span mxa="_zs_gallery[:a" class="_zs_galleryby color-9">'+a(m.centetTip)+'</span><span mxa="_zs_gallery[:b" class="_zs_gallerybA _zs_gallerybC">'+a(m.endStr)+"</span>":f+=" "+a(m.startStr)+" ",f+='</div><div mxv="rangeInfo" class="mx-output mx-output-bottom ',x&&(f+=" mx-output-open "),f+='" style="left:'+a(z)+"px;top:"+a(S)+'px;" id="rpcnt_'+a(v)+'" mx-view="mx-calendar/range?configs='+n(r,b)+'" mx-change="'+e+'__O()" mx-cancel="'+e+'__n()"></div>'},init:function(t){var e=this;i.__h(),e.on("destroy",function(){i.__i(e),i.__j()}),e.updater.snapshot(),e.assign(t)},assign:function(t){var e=this.updater.altered();this.__k=t.disabled+""=="true"||s("#"+this.id)[0].hasAttribute("mx-disabled");var r={left:"_zs_gallerybx",center:"_zs_gallerybz"}[t.textAlign||"center"]||"_zs_gallerybz",a=/^true$/i.test(t.vsenable)||!1,i=!1;a&&(i=/^true$/i.test(t.vs)||!1);var g=a&&/^true$/i.test(t.single)||!1,d=t.timeType,u=t.formatter||"YYYY-MM-dd"+(d?" hh:mm:ss":""),c=t.dateType,p=/^true$/i.test(t.startDisabled)||!1,y=/^true$/i.test(t.endDisabled)||!1,f=!/^false$/i.test(t.shortcuts),h=f?t.shortkeys||["today","yesterday","preWeekMon","lastestWeekMon","preMonth","lastestThisMonth"]:[];if(p){f=!1;for(var b=0;b<h.length;b++)h[b].indexOf("dynamic")<0&&h[b].indexOf("forever")<0&&h.splice(b--,1)}y&&(f=!1,h=[]);var v=t.start,m=t.end,x=t.min,z=t.max;v||(v=_(x,z,u)),m||f&&!(h.indexOf("forever")<0)||(m=_(x,z,u));var S,w,k=new Date(l(v,u)),D=l(k,u);m==n.foreverStr?S=w=n.foreverStr:(S=new Date(l(m,u)),w=l(S,u));for(var I,T,$=o(h,D,u),A=0;A<$.length;A++){var O=$[A];O.start==D&&O.end==w&&(I=O.text,T=O.key)}var q={start:k,startStr:D,end:S,endStr:w,formatter:u,quickDateText:I,quickDateKey:T},C={min:x,max:z,timeType:d,dateType:c,formatter:u,quickDates:h,quickGap:t.quickGap,align:t.align,vsEnable:a,vs:i,vsSingle:g,startDisabled:p,endDisabled:y,dates:q,disabledWeeks:t.disabledWeeks||[]};return this.updater.set({viewId:this.id,rangeInfo:C,textAlign:r}),this.___=s("#"+this.id),this.___.val(JSON.stringify({start:q.startStr,end:q.endStr,vs:i})),e||(e=this.updater.altered()),!!e&&(this.updater.snapshot(),!0)},render:function(){this.__N()},__N:function(){var t,e=this.updater.get("rangeInfo"),r=e.dates,a=e.vs,s=e.vsSingle,i=e.formatter,_=r.startStr,o=r.endStr,u=r.quickDateText,c={centetTip:a?d["calendar.vs"]:d["calendar.to"]},p=l(g(0),i),y=l(g(-1),i),f=l(g(1),i),h=((t={})[p]=d["calendar.today"],t[y]=d["calendar.yesterday"],t[f]=d["calendar.tomorrow"],t),b=function(t){return h[t]||t};a?(c.startStr=b(_),c.endStr=b(o)):s?c.startStr=b(_):u?u==n.foreverStr?(c.startStr=_,c.endStr=n.foreverStr):c.startStr=u:(c.startStr=_,c.endStr=o),this.updater.digest({result:c})},"__m<change,focusin,focusout>":function(t){t.dates||t.stopPropagation()},"__p<click>":function(t){this.__k||(t.preventDefault(),this.updater.get("show")?this.__n():this.__o())},__o:function(){var t=this.updater,e=t.get("rangeInfo");if(!t.get("show")){t.digest({show:!0});var r=s("#trigger_"+this.id),a=s("#rpcnt_"+this.id),n=0,l=r.outerHeight();"right"==e.align&&(n=r.outerWidth()-a.outerWidth()),t.digest({top:l,left:n}),i.__q(this)}},__n:function(){this.updater.get("show")&&(this.updater.digest({show:!1}),i.__i(this))},"__O<change>":function(t){t.stopPropagation();var e=this.updater.get("rangeInfo"),r=t.dates,s=t.vs;a.mix(e,{dates:r,vs:s}),this.__N(),this.__n();var i=JSON.stringify({start:r.startStr,end:r.endStr,vs:s});this.___.val(i).trigger({type:"change",start:r.startStr,end:r.endStr,vs:s,dates:r})},"__n<cancel>":function(t){t.stopPropagation(),this.__n()},__l:function(t){var e=a.inside(t,this.id)||a.inside(t,this.___[0]);if(!e)for(var r=this.owner.children(),s=r.length-1;s>=0;s--){var i=a.Vframe.get(r[s]);if(i&&(e=i.invoke("__l",[t])),e)break}return e}});r.exports=u});