define("mx-calendar/range",["magix","$","mx-calendar/util","../mx-medusa/util","mx-switch/index","./datepicker"],(e,a,l)=>{e("mx-switch/index"),e("./datepicker");var r=e("magix"),t=e("$"),s=e("mx-calendar/util"),_=s.dateFormat,i=s.dateParse,n=s.getDefaultDate,g=s.getQuickInfos,d=s.foreverStr,c=e("../mx-medusa/util");r.applyStyle("_zs_galleryo","._zs_galleryce{border:1px solid #eee}._zs_galleryce,._zs_galleryaJ{box-shadow:0 2px 4px rgba(51,51,51,.08)}._zs_galleryaJ{position:relative;z-index:1000;min-width:280px;width:100%;padding:10px;border-radius:4px;background-color:#fff;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-user-select:none;border:1px solid #eee}._zs_galleryaJ ._zs_gallerycf{margin-bottom:10px;color:#999}._zs_galleryaJ ._zs_galleryaK{position:relative;margin-bottom:15px;line-height:24px}._zs_galleryaJ ._zs_galleryaK ._zs_galleryaL{float:left;width:50%;min-width:110px;text-align:center;cursor:text}._zs_galleryaJ ._zs_galleryaK ._zs_galleryaL ._zs_gallerycg,._zs_galleryaJ ._zs_galleryaK ._zs_galleryaL ._zs_gallerybL{height:24px;padding:0;line-height:24px;border-radius:4px;background-color:#f0f0f0;border:0}._zs_galleryaJ ._zs_galleryaK ._zs_galleryaL ._zs_galleryay{color:#333}._zs_galleryaJ ._zs_galleryaK ._zs_galleryaL ._zs_galleryaM ._zs_galleryay{color:#4d7fff}._zs_galleryaJ ._zs_galleryaK ._zs_galleryaL ._zs_galleryaN ._zs_galleryay{color:#14c9ce}._zs_galleryaJ ._zs_galleryaK ._zs_galleryaL ._zs_gallerycg{cursor:not-allowed;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-user-select:none;color:#ccc}._zs_galleryaJ ._zs_galleryaK ._zs_gallerych{padding-right:9px}._zs_galleryaJ ._zs_galleryaK ._zs_galleryci{padding-left:9px}._zs_galleryaJ ._zs_galleryaK ._zs_gallerycj{position:absolute;top:0;left:50%;width:18px;height:24px;margin-left:-9px;text-align:center}._zs_galleryaJ ._zs_galleryaO ._zs_galleryaP{float:left;width:44%;height:24px;margin-right:6%;margin-bottom:10px;padding:0 10px;line-height:24px;border-radius:4px;cursor:pointer;overflow:hidden;white-space:nowrap}._zs_galleryaJ ._zs_galleryaO ._zs_galleryaP:hover{background:#f0f0f0}._zs_galleryaJ ._zs_galleryaO ._zs_galleryaP._zs_galleryaQ,._zs_galleryaJ ._zs_galleryaO ._zs_galleryaP._zs_galleryaQ:hover{color:#fff;background:#4d7fff}._zs_galleryaJ ._zs_galleryaO._zs_galleryck ._zs_galleryaP{width:32%;margin-right:1%}._zs_galleryaJ ._zs_gallerycl{padding-top:10px;border-top:1px solid #e6e6e6}._zs_galleryaJ._zs_gallerycm{min-width:320px}._zs_galleryaJ._zs_gallerycm ._zs_galleryaL{min-width:140px}._zs_galleryaJ._zs_gallerycn{border:0}._zs_galleryaJ ._zs_galleryaR{color:#fff;background-color:#4d7fff}._zs_galleryaJ ._zs_galleryaR._zs_galleryco,._zs_galleryaJ ._zs_galleryaR:active,._zs_galleryaJ ._zs_galleryaR:hover{color:#fff;background-color:#4776ed}");var o=r.View.extend({tmpl:function(e,a,l,r,t,s,_,i){if(l||(l=e),!t){var n={"&":"amp","<":"lt",">":"gt",'"':"#34","'":"#39","`":"#96"},g=/[&<>"'`]/g,d=function(e){return"&"+n[e]+";"};t=function(e){return""+(null==e?"":e)},r=function(e){return t(e).replace(g,d)}}if(!s){var c={"!":"%21","'":"%27","(":"%28",")":"%29","*":"%2A"},o=function(e){return c[e]},y=/[!')(*]/g;s=function(e){return encodeURIComponent(t(e)).replace(y,o)}}if(!i){var z=/[\\'"]/g;i=function(e){return t(e).replace(z,"\\$&")}}_||(_=function(e,a,l,r){for(r=e[m];--r;)if(e[l=m+r]===a)return l;return e[l=m+e[m]++]=a,l});var m="",x="",u=e.timeType,f=e.inlay,v=e.title,p=e.vsEnable,k=e.vs,h=e.startDisabled,b=e.dates,w=e.min,J=e.endDisabled,q=e.max,S=e.disabledWeeks,T=e.dateType,D=e.vsSingle,K=e.endMinFn,I=e.align,L=e.quickInfos,P=e.quickGap,j=e.quickTip,M=e.submitText,O=e.cancelText;if(x+='<div mxv class="_zs_galleryaJ ',u&&(x+=" _zs_gallerycm "),x+=" ",f&&(x+=" _zs_gallerycn "),x+='" mx-contextmenu="'+a+'__H()"><div mxv mxa="_zs_gallery{:_" class="_zs_galleryaK"><div mxa="_zs_gallery{:a" class="_zs_gallerycf clearfix"><span mxa="_zs_gallery{:b" class="fl">'+r(v)+"：</span>",p&&(x+='<span class="fr" mx-change="'+a+'__J()" mx-view="mx-switch/index?state='+s(k)+'"></span>'),x+='</div><div mxv mxa="_zs_gallery{:c" class="clearfix pr"><div mxv mxa="_zs_gallery{:d" class="_zs_galleryaL _zs_gallerych">',h?x+='<div mxa="_zs_gallery{:e" class="_zs_gallerycg">'+r(b.startStr)+"</div>":(x+='<div mxv="disabledWeeks" ',k&&(x+=' class="_zs_galleryaM" '),x+=' mx-change="'+a+"__I({trigger:'start'})\" mx-view=\"mx-calendar/datepicker?min="+s(w)+"&max="+s(J?b.endStr:q)+"&disabledWeeks="+_(l,S)+"&timeType="+s(u)+"&dateType="+s(T)+"&selected="+s(b.startStr)+'"></div>'),x+='</div><div mxs="_zs_gallery{:_" class="_zs_gallerycj">-</div><div mxv mxa="_zs_gallery{:f" class="_zs_galleryaL _zs_galleryci">',!k&&D||J?x+='<div mxa="_zs_gallery{:g" class="_zs_gallerycg">'+r(b.endStr)+"</div>":(x+='<div mxv="disabledWeeks" ',k&&(x+=' class="_zs_galleryaN" '),x+=' mx-change="'+a+"__I({trigger:'end'})\" mx-view=\"mx-calendar/datepicker?min="+s(k?w:K(b.startStr,w))+"&max="+s(q)+"&disabledWeeks="+_(l,S)+"&timeType="+s(u)+"&dateType="+s(T)+"&align="+s(I)+"&selected="+s(b.endStr)+'"></div>'),x+="</div></div></div>",L.length&&!k&&!D){x+='<div class="_zs_galleryaO ',L.length>P&&(x+="_zs_galleryck"),x+='"><div mxa="_zs_gallery{:h" class="_zs_gallerycf">'+r(j)+'：</div><div mxa="_zs_gallery{:i" class="clearfix">';for(var R=0,W=L.length;R<W;R++){var Q=L[R];x+='<span class="_zs_galleryaP ',b.quickDateKey==Q.key&&(x+="_zs_galleryaQ"),x+='" mx-click="'+a+"__q({quick:true,quickInfo:'"+_(l,Q)+'\'})" title="'+r(Q.text)+'">'+r(Q.text)+"</span>"}x+="</div></div>"}return x+='<div mxa="_zs_gallery{:j" class="_zs_gallerycl clearfix"><button mxa="_zs_gallery{:k" mx-click="'+a+'__q()" type="button" class="btn btn-small _zs_galleryaR mr10">'+r(M)+'</button><button mxa="_zs_gallery{:l" mx-click="'+a+'__K()" type="button" class="btn btn-small">'+r(O)+"</button></div></div>"},init:function(e){var a=t.extend(!0,{},e.configs);a.inlay=a.inlay+""=="true",a.dates=a.dates||{},a.formatter=a.formatter||"YYYY-MM-dd",a.title=a.title||c["calendar.range.title"];var l=a.dates,r=a.formatter,s=(a.quickDates,l.startStr),_=l.endStr,d=a.min,o=a.max;s||(l.startStr=s=n(d,o,r),l.start=i(s)),l.start||(l.start=i(l.startStr)),_||(l.endStr=_=n(d,o,r),l.end=i(_)),l.end||(l.end=i(l.endStr));var y=g(a.quickDates,s,r);if(!l.quickDateKey)for(var z=0;z<y.length;z++){var m=y[z];if(m.start==s&&m.end==_){l.quickDateKey=m.key,l.quickDateText=m.text;break}}a.quickInfos=y,a.quickGap=a.quickGap||7,a.quickTip=c["calendar.quick"],a.submitText=c["dialog.submit"],a.cancelText=c["dialog.cancel"],a.endMinFn=function(e,a){if(!a)return e;var l=new Date(e),r=new Date(a);return l.getTime()>r.getTime()?e:a},this.updater.set(a)},render:function(){this.updater.digest(),this.__j=t("#"+this.id)},"__I<change>":function(e){e.stopPropagation();var a=this.updater,l=a.get("dates"),r=a.get("vs"),t=a.get("vsSingle"),s=a.get("formatter"),i=a.get("quickDates"),n=a.get("quickInfos"),c=e.params.trigger,o=e.date+(e.time?" "+e.time:"");l[c+"Str"]=o;var y,z=l.startStr,m=l.endStr,x=new Date(_(z,s));m==d?y=d:(y=new Date(_(m,s)),!r&&!t&&y.getTime()<x.getTime()&&(m=_(y=x,s)));n=g(i,z,s);for(var u,f,v=0;v<n.length;v++){var p=n[v];if(p.start==z&&p.end==m){u=p.text,f=p.key;break}}this.updater.digest({quickInfos:n,dates:{start:x,end:y,startStr:z,endStr:m,quickDateText:u,quickDateKey:f}})},"__J<change>":function(e){e.stopPropagation(),this.updater.digest({vs:e.state})},"__q<click>":function(e){var a=this.updater,l=a.get(),t=l.dates,s=l.formatter,i=l.quickDates,n=e.params;if(n.quick){var c=n.quickInfo,o=new Date(_(c.start,s)),y=void 0;if(c.end==d)y=d;else{y=new Date(_(c.end,s));var z=void 0,m=void 0,x=void 0,u=void 0;l.min&&(x=(z=new Date(_(l.min,s))).getTime()),l.max&&(u=(m=new Date(_(l.max,s))).getTime());var f=o.getTime(),v=y.getTime();x&&f<x?o=z:u&&f>u&&(o=m),u&&v>u?y=m:x&&v<x&&(y=z),y.getTime()<o.getTime()&&(y=o)}for(var p=_(o,s),k=y==d?d:_(y,s),h=g(i,p,s),b=void 0,w=void 0,J=0;J<h.length;J++){var q=h[J];if(q.start==p&&q.end==k){b=q.text,w=q.key;break}}t={start:o,end:y,startStr:p,endStr:k,quickDateText:b,quickDateKey:w}}else{var S=l.vs,T=l.vsSingle;p=t.startStr,k=t.endStr,o=t.start,y=t.end;(k==d&&S||!S&&!T&&y.getTime()<o.getTime())&&(k=p,y=new Date(_(k,s))),r.mix(t,{end:y,endStr:k})}a.digest({dates:t}),this.__j.trigger({type:"change",vs:l.vs,dates:t})},"__K<click>":function(){this.__j.trigger("cancel")},"__H<contextmenu>":function(e){e.preventDefault()}});l.exports=o});