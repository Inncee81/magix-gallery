define("mx-calendar/range",["magix","$","mx-calendar/util","../mx-medusa/util","mx-switch/index","./datepicker"],(e,a,l)=>{e("mx-switch/index"),e("./datepicker");var t=e("magix"),r=e("$"),s=e("mx-calendar/util"),i=s.dateFormat,_=s.dateParse,n=s.getDefaultDate,g=s.getQuickInfos,d=s.foreverStr,c=e("../mx-medusa/util");t.applyStyle("_zs_galleryn",'._zs_gallerycu{border:1px solid #f5f5f6}._zs_gallerycu,._zs_galleryaR{box-shadow:0 1px 1px 0 rgba(0,0,0,.08)}._zs_galleryaR{position:relative;z-index:1000;min-width:280px;width:100%;padding:10px;border-radius:4px;background-color:#fff;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-user-select:none;border:1px solid #f5f5f6}._zs_galleryaR ._zs_gallerycv{margin-bottom:10px;color:#999}._zs_galleryaR ._zs_galleryaS{position:relative;margin-bottom:15px;line-height:24px}._zs_galleryaR ._zs_galleryaS ._zs_galleryaT{float:left;width:50%;min-width:110px;text-align:center;cursor:text}._zs_galleryaR ._zs_galleryaS ._zs_galleryaT [mx-view*="mx-calendar/datepicker"]{width:100%}._zs_galleryaR ._zs_galleryaS ._zs_galleryaT ._zs_gallerycw,._zs_galleryaR ._zs_galleryaS ._zs_galleryaT ._zs_gallerycb{height:24px;padding:0;line-height:24px;border-radius:4px;background-color:#f0f0f0;border:0}._zs_galleryaR ._zs_galleryaS ._zs_galleryaT ._zs_galleryaG{color:#333}._zs_galleryaR ._zs_galleryaS ._zs_galleryaT ._zs_galleryaU ._zs_galleryaG{color:#4d7fff}._zs_galleryaR ._zs_galleryaS ._zs_galleryaT ._zs_galleryaV ._zs_galleryaG{color:#14c9ce}._zs_galleryaR ._zs_galleryaS ._zs_galleryaT ._zs_gallerycw{display:inline-block;width:100%;cursor:not-allowed;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-user-select:none;color:#ccc;vertical-align:middle}._zs_galleryaR ._zs_galleryaS ._zs_gallerycx{padding-right:9px}._zs_galleryaR ._zs_galleryaS ._zs_gallerycy{padding-left:9px}._zs_galleryaR ._zs_galleryaS ._zs_gallerycz{position:absolute;top:0;left:50%;width:18px;height:24px;margin-left:-9px;text-align:center}._zs_galleryaR ._zs_galleryaW ._zs_galleryaX{float:left;width:44%;height:24px;margin-right:6%;margin-bottom:10px;padding:0 10px;line-height:24px;border-radius:4px;cursor:pointer;overflow:hidden;white-space:nowrap}._zs_galleryaR ._zs_galleryaW ._zs_galleryaX:hover{background:#f0f0f0}._zs_galleryaR ._zs_galleryaW ._zs_galleryaX._zs_galleryaY,._zs_galleryaR ._zs_galleryaW ._zs_galleryaX._zs_galleryaY:hover{color:#4d7fff;background:#f6f9ff}._zs_galleryaR ._zs_galleryaW._zs_gallerycA ._zs_galleryaX{width:32%;margin-right:1%}._zs_galleryaR ._zs_gallerycB{padding-top:10px;border-top:1px solid #e6e6e6}._zs_galleryaR._zs_gallerycC{min-width:320px}._zs_galleryaR._zs_gallerycC ._zs_galleryaT{min-width:140px}._zs_galleryaR._zs_gallerycD{border:0}');var o=t.View.extend({tmpl:function(e,a,l,t,r,s,i,_){if(l||(l=e),!r){var n={"&":"amp","<":"lt",">":"gt",'"':"#34","'":"#39","`":"#96"},g=/[&<>"'`]/g,d=function(e){return"&"+n[e]+";"};r=function(e){return""+(null==e?"":e)},t=function(e){return r(e).replace(g,d)}}if(!s){var c={"!":"%21","'":"%27","(":"%28",")":"%29","*":"%2A"},o=function(e){return c[e]},y=/[!')(*]/g;s=function(e){return encodeURIComponent(r(e)).replace(y,o)}}if(!_){var m=/[\\'"]/g;_=function(e){return r(e).replace(m,"\\$&")}}i||(i=function(e,a,l,t){for(t=e[z];--t;)if(e[l=z+t]===a)return l;return e[l=z+e[z]++]=a,l});var z="",x="",u=e.timeType,v=e.inlay,f=e.title,p=e.vsEnable,h=e.vs,k=e.startDisabled,b=e.dates,S=e.min,w=e.endDisabled,T=e.max,q=e.formatter,D=e.disabledWeeks,R=e.dateType,I=e.vsSingle,W=e.endMinFn,K=e.align,Y=e.quickInfos,G=e.quickGap,X=e.quickTip,j=e.submitText,C=e.cancelText;if(x+='<div mxv class="_zs_galleryaR ',u&&(x+=" _zs_gallerycC "),x+=" ",v&&(x+=" _zs_gallerycD "),x+='" mx-contextmenu="'+a+'__H()"><div mxv mxa="_zs_gallery[:_" class="_zs_galleryaS"><div mxa="_zs_gallery[:a" class="_zs_gallerycv clearfix"><span mxa="_zs_gallery[:b" class="fl">'+t(f)+"：</span>",p&&(x+='<span class="fr" mx-change="'+a+'__J()" mx-view="mx-switch/index?state='+s(h)+'"></span>'),x+='</div><div mxv mxa="_zs_gallery[:c" class="clearfix pr"><div mxv mxa="_zs_gallery[:d" class="_zs_galleryaT _zs_gallerycx">',k?x+='<div mxa="_zs_gallery[:e" class="_zs_gallerycw">'+t(b.startStr)+"</div>":(x+='<div mxv="disabledWeeks" ',h&&(x+=' class="_zs_galleryaU" '),x+=' mx-change="'+a+"__I({trigger:'start'})\" mx-view=\"mx-calendar/datepicker?min="+s(S)+"&max="+s(w?b.endStr:T)+"&formatter="+s(q)+"&disabledWeeks="+i(l,D)+"&timeType="+s(u)+"&dateType="+s(R)+"&selected="+s(b.startStr)+'"></div>'),x+='</div><div mxs="_zs_gallery[:_" class="_zs_gallerycz">-</div><div mxv mxa="_zs_gallery[:f" class="_zs_galleryaT _zs_gallerycy">',!h&&I||w?x+='<div mxa="_zs_gallery[:g" class="_zs_gallerycw">'+t(b.endStr)+"</div>":(x+='<div mxv="disabledWeeks" ',h&&(x+=' class="_zs_galleryaV" '),x+=' mx-change="'+a+"__I({trigger:'end'})\" mx-view=\"mx-calendar/datepicker?min="+s(h?S:W(b.startStr,S))+"&max="+s(T)+"&formatter="+s(q)+"&disabledWeeks="+i(l,D)+"&timeType="+s(u)+"&dateType="+s(R)+"&align="+s(K)+"&selected="+s(b.endStr)+'"></div>'),x+="</div></div></div>",Y.length&&!h&&!I){x+='<div class="_zs_galleryaW ',Y.length>G&&(x+="_zs_gallerycA"),x+='"><div mxa="_zs_gallery[:h" class="_zs_gallerycv">'+t(X)+'：</div><div mxa="_zs_gallery[:i" class="clearfix">';for(var M=0,A=Y.length;M<A;M++){var F=Y[M];x+='<span class="_zs_galleryaX ',b.quickDateKey==F.key&&(x+="_zs_galleryaY"),x+='" mx-click="'+a+"__q({quick:true,quickInfo:'"+i(l,F)+'\'})" title="'+t(F.text)+'">'+t(F.text)+"</span>"}x+="</div></div>"}return x+='<div mxa="_zs_gallery[:j" class="_zs_gallerycB clearfix"><button mxa="_zs_gallery[:k" mx-click="'+a+'__q()" type="button" class="btn btn-small btn-brand mr10">'+t(j)+'</button><button mxa="_zs_gallery[:l" mx-click="'+a+'__K()" type="button" class="btn btn-small">'+t(C)+"</button></div></div>"},init:function(e){var a=r.extend(!0,{},e.configs);a.inlay=a.inlay+""=="true",a.dates=a.dates||{},a.formatter=a.formatter||"YYYY-MM-dd",a.title=a.title||c["calendar.range.title"];var l=a.dates,t=a.formatter,s=(a.quickDates,l.startStr),i=l.endStr,d=a.min,o=a.max;s||(l.startStr=s=n(d,o,t),l.start=_(s)),l.start||(l.start=_(l.startStr)),i||(l.endStr=i=n(d,o,t),l.end=_(i)),l.end||(l.end=_(l.endStr));var y=g(a.quickDates,s,t);if(!l.quickDateKey)for(var m=0;m<y.length;m++){var z=y[m];if(z.start==s&&z.end==i){l.quickDateKey=z.key,l.quickDateText=z.text;break}}a.quickInfos=y,a.quickGap=a.quickGap||7,a.quickTip=c["calendar.quick"],a.submitText=c["dialog.submit"],a.cancelText=c["dialog.cancel"],a.endMinFn=function(e,a){if(!a)return e;var l=new Date(e),t=new Date(a);return l.getTime()>t.getTime()?e:a},this.updater.set(a)},render:function(){this.updater.digest(),this.__j=r("#"+this.id)},"__I<change>":function(e){e.stopPropagation();var a=this.updater,l=a.get("dates"),t=a.get("vs"),r=a.get("vsSingle"),s=a.get("formatter"),_=a.get("quickDates"),n=a.get("quickInfos"),c=e.params.trigger,o=e.date+(e.time?" "+e.time:"");l[c+"Str"]=o;var y,m=l.startStr,z=l.endStr,x=new Date(i(m,s));z==d?y=d:(y=new Date(i(z,s)),!t&&!r&&y.getTime()<x.getTime()&&(z=i(y=x,s)));n=g(_,m,s);for(var u,v,f=0;f<n.length;f++){var p=n[f];if(p.start==m&&p.end==z){u=p.text,v=p.key;break}}this.updater.digest({quickInfos:n,dates:{start:x,end:y,startStr:m,endStr:z,quickDateText:u,quickDateKey:v}})},"__J<change>":function(e){e.stopPropagation(),this.updater.digest({vs:e.state})},"__q<click>":function(e){var a=this.updater,l=a.get(),r=l.dates,s=l.formatter,_=l.quickDates,n=e.params;if(n.quick){var c=n.quickInfo,o=new Date(i(c.start,s)),y=void 0;if(c.end==d)y=d;else{y=new Date(i(c.end,s));var m=void 0,z=void 0,x=void 0,u=void 0;l.min&&(x=(m=new Date(i(l.min,s))).getTime()),l.max&&(u=(z=new Date(i(l.max,s))).getTime());var v=o.getTime(),f=y.getTime();x&&v<x?o=m:u&&v>u&&(o=z),u&&f>u?y=z:x&&f<x&&(y=m),y.getTime()<o.getTime()&&(y=o)}for(var p=i(o,s),h=y==d?d:i(y,s),k=g(_,p,s),b=void 0,S=void 0,w=0;w<k.length;w++){var T=k[w];if(T.start==p&&T.end==h){b=T.text,S=T.key;break}}r={start:o,end:y,startStr:p,endStr:h,quickDateText:b,quickDateKey:S}}else{var q=l.vs,D=l.vsSingle;p=r.startStr,h=r.endStr,o=r.start,y=r.end;(h==d&&q||!q&&!D&&h!=d&&y.getTime()<o.getTime())&&(h=p,y=new Date(i(h,s))),t.mix(r,{end:y,endStr:h})}a.digest({dates:r}),this.__j.trigger({type:"change",vs:l.vs,dates:r})},"__K<click>":function(){this.__j.trigger("cancel")},"__H<contextmenu>":function(e){e.preventDefault()}});l.exports=o});