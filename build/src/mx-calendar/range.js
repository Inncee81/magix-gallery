define("mx-calendar/range",["magix","$","mx-calendar/util","../mx-medusa/util","mx-switch/index","./datepicker"],(e,a,t)=>{e("mx-switch/index"),e("./datepicker");var r=e("magix"),l=e("$"),s=e("mx-calendar/util"),i=s.dateFormat,n=s.dateParse,c=s.getDefaultDate,_=s.getQuickInfos,g=s.foreverStr,d=e("../mx-medusa/util");r.applyStyle("_zs_galleryr",'._zs_gallerycm{--mx-calendar-range-input-width:calc(var(--font-size)*8);position:relative;z-index:1000;min-width:calc(var(--mx-calendar-range-input-width)*2 + 40px);width:100%;padding:10px;border-radius:var(--border-radius);background-color:#fff;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-user-select:none}._zs_gallerycm ._zs_gallerycn{color:#999}._zs_gallerycm ._zs_galleryco{position:relative;line-height:var(--input-small-height)}._zs_gallerycm ._zs_galleryco ._zs_gallerycp{float:left;width:50%;min-width:var(--mx-calendar-range-input-width);text-align:center;cursor:text}._zs_gallerycm ._zs_galleryco ._zs_gallerycp [mx-view*="mx-calendar/datepicker"]{width:100%}._zs_gallerycm ._zs_galleryco ._zs_gallerycp ._zs_gallerycq,._zs_gallerycm ._zs_galleryco ._zs_gallerycp ._zs_gallerybD{height:var(--input-small-height);padding:0;line-height:var(--input-small-height);border-radius:var(--border-radius);background-color:var(--color-bg-hover);border:0;color:#333}._zs_gallerycm ._zs_galleryco ._zs_gallerycp ._zs_gallerycr ._zs_gallerybD{color:var(--color-brand)}._zs_gallerycm ._zs_galleryco ._zs_gallerycp ._zs_gallerycs ._zs_gallerybD{color:var(--color-brand-vs)}._zs_gallerycm ._zs_galleryco ._zs_gallerycp ._zs_gallerycq{display:inline-block;width:100%;min-width:100px;cursor:not-allowed;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-user-select:none;color:#999;vertical-align:middle}._zs_gallerycm ._zs_galleryco ._zs_galleryct{padding-right:9px}._zs_gallerycm ._zs_galleryco ._zs_gallerycu{padding-left:9px}._zs_gallerycm ._zs_galleryco ._zs_gallerycv{position:absolute;top:0;left:50%;width:18px;height:var(--input-small-height);margin-left:-9px;text-align:center}._zs_gallerycm ._zs_gallerycw{margin-top:15px}._zs_gallerycm ._zs_gallerycw ._zs_gallerycx{float:left;width:44%;height:var(--input-small-height);margin-right:6%;margin-top:10px;padding:0 10px;line-height:var(--input-small-height);border-radius:var(--border-radius);cursor:pointer;overflow:hidden;white-space:nowrap}._zs_gallerycm ._zs_gallerycw ._zs_gallerycx:hover{background-color:var(--color-bg-hover)}._zs_gallerycm ._zs_gallerycw ._zs_gallerycx._zs_gallerycy,._zs_gallerycm ._zs_gallerycw ._zs_gallerycx._zs_gallerycy:hover{color:var(--color-brand);background-color:var(--color-brand-opacity)}._zs_gallerycm ._zs_gallerycw._zs_gallerycz ._zs_gallerycx{width:32%;margin-right:1%}._zs_gallerycm._zs_gallerycA{--mx-calendar-range-input-width:calc(var(--font-size)*11)}');var o=r.View.extend({tmpl:function(e,a,t,r,l,s,i,n){if(t||(t=e),!l){var c={"&":"amp","<":"lt",">":"gt",'"':"#34","'":"#39","`":"#96"},_=/[&<>"'`]/g,g=function(e){return"&"+c[e]+";"};l=function(e){return""+(null==e?"":e)},r=function(e){return l(e).replace(_,g)}}if(!s){var d={"!":"%21","'":"%27","(":"%28",")":"%29","*":"%2A"},o=function(e){return d[e]},m=/[!')(*]/g;s=function(e){return encodeURIComponent(l(e)).replace(m,o)}}if(!n){var y=/[\\'"]/g;n=function(e){return l(e).replace(y,"\\$&")}}i||(i=function(e,a,t,r){for(r=e[u];--r;)if(e[t=u+r]===a)return t;return e[t=u+e[u]++]=a,t});var u="",v="",z=e.timeType,x=e.title,p=e.vsEnable,f=e.vs,h=e.startDisabled,k=e.dates,b=e.min,w=e.endDisabled,q=e.max,D=e.formatter,S=e.disabledWeeks,T=e.dateType,I=e.vsSingle,K=e.endMinFn,M=e.align,W=e.quickInfos,Y=e.quickGap,A=e.quickTip,F=e.submitText,G=e.cancelText;if(v+='<div mxv class="_zs_gallerycm ',z&&(v+=" _zs_gallerycA "),v+='" mx-contextmenu="'+a+'__J()"><div mxv mxa="_zs_gallery[:_" class="_zs_galleryco"><div mxa="_zs_gallery[:a" class="_zs_gallerycn clearfix"><span mxa="_zs_gallery[:b" class="fl">'+r(x)+"：</span>",p&&(v+='<span class="fr" mx-change="'+a+'__L()" mx-view="mx-switch/index?state='+s(f)+'"></span>'),v+='</div><div mxv mxa="_zs_gallery[:c" class="clearfix pr"><div mxv mxa="_zs_gallery[:d" class="_zs_gallerycp _zs_galleryct">',h?v+='<div mxa="_zs_gallery[:e" class="_zs_gallerycq">'+r(k.startStr)+"</div>":(v+='<div mxv="disabledWeeks" ',f&&(v+=' class="_zs_gallerycr" '),v+=' mx-change="'+a+"__K({trigger:'start'})\" mx-view=\"mx-calendar/datepicker?min="+s(b)+"&max="+s(w?k.endStr:q)+"&formatter="+s(D)+"&disabledWeeks="+i(t,S)+"&timeType="+s(z)+"&dateType="+s(T)+"&selected="+s(k.startStr)+'"></div>'),v+='</div><div mxs="_zs_gallery[:_" class="_zs_gallerycv">-</div><div mxv mxa="_zs_gallery[:f" class="_zs_gallerycp _zs_gallerycu">',!f&&I||w?v+='<div mxa="_zs_gallery[:g" class="_zs_gallerycq">'+r(k.endStr)+"</div>":(v+='<div mxv="disabledWeeks" ',f&&(v+=' class="_zs_gallerycs" '),v+=' mx-change="'+a+"__K({trigger:'end'})\" mx-view=\"mx-calendar/datepicker?min="+s(f?b:K(k.startStr,b))+"&max="+s(q)+"&formatter="+s(D)+"&disabledWeeks="+i(t,S)+"&timeType="+s(z)+"&dateType="+s(T)+"&align="+s(M)+"&selected="+s(k.endStr)+'"></div>'),v+="</div></div></div>",W.length&&!f&&!I){v+='<div class="_zs_gallerycw ',W.length>Y&&(v+="_zs_gallerycz"),v+='"><div mxa="_zs_gallery[:h" class="_zs_gallerycn">'+r(A)+'：</div><div mxa="_zs_gallery[:i" class="clearfix">';for(var P=0,$=W.length;P<$;P++){var J=W[P];v+='<span class="_zs_gallerycx ',k.quickDateKey==J.key&&(v+="_zs_gallerycy"),v+='" mx-click="'+a+"__r({quick:true,quickInfo:'"+i(t,J)+'\'})" title="'+r(J.text)+'">'+r(J.text)+"</span>"}v+="</div></div>"}return v+='</div><div mxa="_zs_gallery[:j" class="mx-output-footer"><button mxa="_zs_gallery[:k" mx-click="'+a+'__r()" type="button" class="btn btn-small btn-brand mr10">'+r(F)+'</button><button mxa="_zs_gallery[:l" mx-click="'+a+'__M()" type="button" class="btn btn-small">'+r(G)+"</button></div>"},init:function(e){var a=l.extend(!0,{},e.configs);a.dates=a.dates||{},a.formatter=a.formatter||"YYYY-MM-dd",a.title=a.title||d["calendar.range.title"];var t=a.dates,r=a.formatter,s=(a.quickDates,t.startStr),i=t.endStr,g=a.min,o=a.max;s||(t.startStr=s=c(g,o,r),t.start=n(s)),t.start||(t.start=n(t.startStr)),i||(t.endStr=i=c(g,o,r),t.end=n(i)),t.end||(t.end=n(t.endStr));var m=_(a.quickDates,s,r);if(!t.quickDateKey)for(var y=0;y<m.length;y++){var u=m[y];if(u.start==s&&u.end==i){t.quickDateKey=u.key,t.quickDateText=u.text;break}}a.quickInfos=m,a.quickGap=a.quickGap||7,a.quickTip=d["calendar.quick"],a.submitText=d["dialog.submit"],a.cancelText=d["dialog.cancel"],a.endMinFn=function(e,a){if(!a)return e;var t=new Date(e),r=new Date(a);return t.getTime()>r.getTime()?e:a},this.updater.set(a)},render:function(){this.updater.digest(),this.__a=l("#"+this.id)},"__K<change>":function(e){e.stopPropagation();var a=this.updater,t=a.get("dates"),r=a.get("vs"),l=a.get("vsSingle"),s=a.get("formatter"),n=a.get("quickDates"),c=a.get("quickInfos"),d=e.params.trigger,o=e.date+(e.time?" "+e.time:"");t[d+"Str"]=o;var m,y=t.startStr,u=t.endStr,v=new Date(i(y,s));u==g?m=g:(m=new Date(i(u,s)),!r&&!l&&m.getTime()<v.getTime()&&(u=i(m=v,s)));c=_(n,y,s);for(var z,x,p=0;p<c.length;p++){var f=c[p];if(f.start==y&&f.end==u){z=f.text,x=f.key;break}}this.updater.digest({quickInfos:c,dates:{start:v,end:m,startStr:y,endStr:u,quickDateText:z,quickDateKey:x}})},"__L<change>":function(e){e.stopPropagation(),this.updater.digest({vs:e.state})},"__r<click>":function(e){var a=this.updater,t=a.get(),l=t.dates,s=t.formatter,n=t.quickDates,c=e.params;if(c.quick){var d=c.quickInfo,o=new Date(i(d.start,s)),m=void 0;if(d.end==g)m=g;else{m=new Date(i(d.end,s));var y=void 0,u=void 0,v=void 0,z=void 0;t.min&&(v=(y=new Date(i(t.min,s))).getTime()),t.max&&(z=(u=new Date(i(t.max,s))).getTime());var x=o.getTime(),p=m.getTime();v&&x<v?o=y:z&&x>z&&(o=u),z&&p>z?m=u:v&&p<v&&(m=y),m.getTime()<o.getTime()&&(m=o)}for(var f=i(o,s),h=m==g?g:i(m,s),k=_(n,f,s),b=void 0,w=void 0,q=0;q<k.length;q++){var D=k[q];if(D.start==f&&D.end==h){b=D.text,w=D.key;break}}l={start:o,end:m,startStr:f,endStr:h,quickDateText:b,quickDateKey:w}}else{var S=t.vs,T=t.vsSingle;f=l.startStr,h=l.endStr,o=l.start,m=l.end;(h==g&&S||!S&&!T&&h!=g&&m.getTime()<o.getTime())&&(h=f,m=new Date(i(h,s))),r.mix(l,{end:m,endStr:h})}a.digest({dates:l}),this.__a.trigger({type:"change",vs:t.vs,dates:l})},"__M<click>":function(){this.__a.trigger("cancel")},"__J<contextmenu>":function(e){e.preventDefault()}});t.exports=o});