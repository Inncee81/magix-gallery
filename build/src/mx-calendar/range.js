define("mx-calendar/range",["magix","$","mx-calendar/util","../mx-medusa/util","mx-switch/index","./datepicker"],(e,a,l)=>{e("mx-switch/index"),e("./datepicker");var t=e("magix"),r=e("$"),s=e("mx-calendar/util"),i=s.dateFormat,_=s.dateParse,n=s.getDefaultDate,g=s.getQuickInfos,d=s.foreverStr,c=e("../mx-medusa/util");t.applyStyle("_zs_galleryo",'._zs_galleryct{border:1px solid #f5f5f6}._zs_galleryct,._zs_galleryaZ{box-shadow:0 1px 1px 0 rgba(0,0,0,.08)}._zs_galleryaZ{position:relative;z-index:1000;min-width:280px;width:100%;padding:10px;border-radius:4px;background-color:#fff;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-user-select:none;border:1px solid #f5f5f6}._zs_galleryaZ ._zs_gallerycu{margin-bottom:10px;color:#999}._zs_galleryaZ ._zs_galleryb_{position:relative;margin-bottom:15px;line-height:24px}._zs_galleryaZ ._zs_galleryb_ ._zs_galleryba{float:left;width:50%;min-width:110px;text-align:center;cursor:text}._zs_galleryaZ ._zs_galleryb_ ._zs_galleryba [mx-view*="mx-calendar/datepicker"]{width:100%}._zs_galleryaZ ._zs_galleryb_ ._zs_galleryba ._zs_gallerycv,._zs_galleryaZ ._zs_galleryb_ ._zs_galleryba ._zs_galleryca{height:24px;padding:0;line-height:24px;border-radius:4px;background-color:#f0f0f0;border:0}._zs_galleryaZ ._zs_galleryb_ ._zs_galleryba ._zs_galleryaO{color:#333}._zs_galleryaZ ._zs_galleryb_ ._zs_galleryba ._zs_gallerybb ._zs_galleryaO{color:#4d7fff}._zs_galleryaZ ._zs_galleryb_ ._zs_galleryba ._zs_gallerybc ._zs_galleryaO{color:#14c9ce}._zs_galleryaZ ._zs_galleryb_ ._zs_galleryba ._zs_gallerycv{display:inline-block;width:100%;cursor:not-allowed;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-user-select:none;color:#ccc;vertical-align:middle}._zs_galleryaZ ._zs_galleryb_ ._zs_gallerycw{padding-right:9px}._zs_galleryaZ ._zs_galleryb_ ._zs_gallerycx{padding-left:9px}._zs_galleryaZ ._zs_galleryb_ ._zs_gallerycy{position:absolute;top:0;left:50%;width:18px;height:24px;margin-left:-9px;text-align:center}._zs_galleryaZ ._zs_gallerybd ._zs_gallerybe{float:left;width:44%;height:24px;margin-right:6%;margin-bottom:10px;padding:0 10px;line-height:24px;border-radius:4px;cursor:pointer;overflow:hidden;white-space:nowrap}._zs_galleryaZ ._zs_gallerybd ._zs_gallerybe:hover{background:#f0f0f0}._zs_galleryaZ ._zs_gallerybd ._zs_gallerybe._zs_gallerybf,._zs_galleryaZ ._zs_gallerybd ._zs_gallerybe._zs_gallerybf:hover{color:#4d7fff;background:#f6f9ff}._zs_galleryaZ ._zs_gallerybd._zs_gallerycz ._zs_gallerybe{width:32%;margin-right:1%}._zs_galleryaZ ._zs_gallerycA{padding-top:10px;border-top:1px solid #e6e6e6}._zs_galleryaZ._zs_gallerycB{min-width:320px}._zs_galleryaZ._zs_gallerycB ._zs_galleryba{min-width:140px}._zs_galleryaZ._zs_gallerycC{border:0}');var o=t.View.extend({tmpl:function(e,a,l,t,r,s,i,_){if(l||(l=e),!r){var n={"&":"amp","<":"lt",">":"gt",'"':"#34","'":"#39","`":"#96"},g=/[&<>"'`]/g,d=function(e){return"&"+n[e]+";"};r=function(e){return""+(null==e?"":e)},t=function(e){return r(e).replace(g,d)}}if(!s){var c={"!":"%21","'":"%27","(":"%28",")":"%29","*":"%2A"},o=function(e){return c[e]},y=/[!')(*]/g;s=function(e){return encodeURIComponent(r(e)).replace(y,o)}}if(!_){var z=/[\\'"]/g;_=function(e){return r(e).replace(z,"\\$&")}}i||(i=function(e,a,l,t){for(t=e[m];--t;)if(e[l=m+t]===a)return l;return e[l=m+e[m]++]=a,l});var m="",x="",u=e.timeType,v=e.inlay,b=e.title,f=e.vsEnable,p=e.vs,h=e.startDisabled,k=e.dates,w=e.min,q=e.endDisabled,S=e.max,T=e.disabledWeeks,D=e.dateType,Z=e.vsSingle,I=e.endMinFn,K=e.align,W=e.quickInfos,j=e.quickGap,M=e.quickTip,Y=e.submitText,A=e.cancelText;if(x+='<div mxv class="_zs_galleryaZ ',u&&(x+=" _zs_gallerycB "),x+=" ",v&&(x+=" _zs_gallerycC "),x+='" mx-contextmenu="'+a+'__H()"><div mxv mxa="_zs_gallery(:_" class="_zs_galleryb_"><div mxa="_zs_gallery(:a" class="_zs_gallerycu clearfix"><span mxa="_zs_gallery(:b" class="fl">'+t(b)+"：</span>",f&&(x+='<span class="fr" mx-change="'+a+'__J()" mx-view="mx-switch/index?state='+s(p)+'"></span>'),x+='</div><div mxv mxa="_zs_gallery(:c" class="clearfix pr"><div mxv mxa="_zs_gallery(:d" class="_zs_galleryba _zs_gallerycw">',h?x+='<div mxa="_zs_gallery(:e" class="_zs_gallerycv">'+t(k.startStr)+"</div>":(x+='<div mxv="disabledWeeks" ',p&&(x+=' class="_zs_gallerybb" '),x+=' mx-change="'+a+"__I({trigger:'start'})\" mx-view=\"mx-calendar/datepicker?min="+s(w)+"&max="+s(q?k.endStr:S)+"&disabledWeeks="+i(l,T)+"&timeType="+s(u)+"&dateType="+s(D)+"&selected="+s(k.startStr)+'"></div>'),x+='</div><div mxs="_zs_gallery(:_" class="_zs_gallerycy">-</div><div mxv mxa="_zs_gallery(:f" class="_zs_galleryba _zs_gallerycx">',!p&&Z||q?x+='<div mxa="_zs_gallery(:g" class="_zs_gallerycv">'+t(k.endStr)+"</div>":(x+='<div mxv="disabledWeeks" ',p&&(x+=' class="_zs_gallerybc" '),x+=' mx-change="'+a+"__I({trigger:'end'})\" mx-view=\"mx-calendar/datepicker?min="+s(p?w:I(k.startStr,w))+"&max="+s(S)+"&disabledWeeks="+i(l,T)+"&timeType="+s(u)+"&dateType="+s(D)+"&align="+s(K)+"&selected="+s(k.endStr)+'"></div>'),x+="</div></div></div>",W.length&&!p&&!Z){x+='<div class="_zs_gallerybd ',W.length>j&&(x+="_zs_gallerycz"),x+='"><div mxa="_zs_gallery(:h" class="_zs_gallerycu">'+t(M)+'：</div><div mxa="_zs_gallery(:i" class="clearfix">';for(var B=0,C=W.length;B<C;B++){var F=W[B];x+='<span class="_zs_gallerybe ',k.quickDateKey==F.key&&(x+="_zs_gallerybf"),x+='" mx-click="'+a+"__q({quick:true,quickInfo:'"+i(l,F)+'\'})" title="'+t(F.text)+'">'+t(F.text)+"</span>"}x+="</div></div>"}return x+='<div mxa="_zs_gallery(:j" class="_zs_gallerycA clearfix"><button mxa="_zs_gallery(:k" mx-click="'+a+'__q()" type="button" class="btn btn-small btn-brand mr10">'+t(Y)+'</button><button mxa="_zs_gallery(:l" mx-click="'+a+'__K()" type="button" class="btn btn-small">'+t(A)+"</button></div></div>"},init:function(e){var a=r.extend(!0,{},e.configs);a.inlay=a.inlay+""=="true",a.dates=a.dates||{},a.formatter=a.formatter||"YYYY-MM-dd",a.title=a.title||c["calendar.range.title"];var l=a.dates,t=a.formatter,s=(a.quickDates,l.startStr),i=l.endStr,d=a.min,o=a.max;s||(l.startStr=s=n(d,o,t),l.start=_(s)),l.start||(l.start=_(l.startStr)),i||(l.endStr=i=n(d,o,t),l.end=_(i)),l.end||(l.end=_(l.endStr));var y=g(a.quickDates,s,t);if(!l.quickDateKey)for(var z=0;z<y.length;z++){var m=y[z];if(m.start==s&&m.end==i){l.quickDateKey=m.key,l.quickDateText=m.text;break}}a.quickInfos=y,a.quickGap=a.quickGap||7,a.quickTip=c["calendar.quick"],a.submitText=c["dialog.submit"],a.cancelText=c["dialog.cancel"],a.endMinFn=function(e,a){if(!a)return e;var l=new Date(e),t=new Date(a);return l.getTime()>t.getTime()?e:a},this.updater.set(a)},render:function(){this.updater.digest(),this.__j=r("#"+this.id)},"__I<change>":function(e){e.stopPropagation();var a=this.updater,l=a.get("dates"),t=a.get("vs"),r=a.get("vsSingle"),s=a.get("formatter"),_=a.get("quickDates"),n=a.get("quickInfos"),c=e.params.trigger,o=e.date+(e.time?" "+e.time:"");l[c+"Str"]=o;var y,z=l.startStr,m=l.endStr,x=new Date(i(z,s));m==d?y=d:(y=new Date(i(m,s)),!t&&!r&&y.getTime()<x.getTime()&&(m=i(y=x,s)));n=g(_,z,s);for(var u,v,b=0;b<n.length;b++){var f=n[b];if(f.start==z&&f.end==m){u=f.text,v=f.key;break}}this.updater.digest({quickInfos:n,dates:{start:x,end:y,startStr:z,endStr:m,quickDateText:u,quickDateKey:v}})},"__J<change>":function(e){e.stopPropagation(),this.updater.digest({vs:e.state})},"__q<click>":function(e){var a=this.updater,l=a.get(),r=l.dates,s=l.formatter,_=l.quickDates,n=e.params;if(n.quick){var c=n.quickInfo,o=new Date(i(c.start,s)),y=void 0;if(c.end==d)y=d;else{y=new Date(i(c.end,s));var z=void 0,m=void 0,x=void 0,u=void 0;l.min&&(x=(z=new Date(i(l.min,s))).getTime()),l.max&&(u=(m=new Date(i(l.max,s))).getTime());var v=o.getTime(),b=y.getTime();x&&v<x?o=z:u&&v>u&&(o=m),u&&b>u?y=m:x&&b<x&&(y=z),y.getTime()<o.getTime()&&(y=o)}for(var f=i(o,s),p=y==d?d:i(y,s),h=g(_,f,s),k=void 0,w=void 0,q=0;q<h.length;q++){var S=h[q];if(S.start==f&&S.end==p){k=S.text,w=S.key;break}}r={start:o,end:y,startStr:f,endStr:p,quickDateText:k,quickDateKey:w}}else{var T=l.vs,D=l.vsSingle;f=r.startStr,p=r.endStr,o=r.start,y=r.end;(p==d&&T||!T&&!D&&y.getTime()<o.getTime())&&(p=f,y=new Date(i(p,s))),t.mix(r,{end:y,endStr:p})}a.digest({dates:r}),this.__j.trigger({type:"change",vs:l.vs,dates:r})},"__K<click>":function(){this.__j.trigger("cancel")},"__H<contextmenu>":function(e){e.preventDefault()}});l.exports=o});