define("mx-calendar/range",["magix","$","mx-calendar/util","../mx-medusa/util","mx-switch/index","./datepicker"],(e,a,r)=>{e("mx-switch/index"),e("./datepicker");var t=e("magix"),l=e("$"),i=e("mx-calendar/util"),s=i.dateFormat,c=i.dateParse,n=i.getDefaultDate,_=i.getQuickInfos,g=i.foreverStr,d=e("../mx-medusa/util");t.applyStyle("_zs_galleryq",'._zs_gallerycf{--mx-calendar-range-input-width:calc(var(--font-size)*8);position:relative;z-index:1000;min-width:calc(var(--mx-calendar-range-input-width)*2 + 40px);width:100%;padding:10px;border-radius:var(--border-radius);background-color:#fff;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-user-select:none}._zs_gallerycf ._zs_gallerycg{color:#999}._zs_gallerycf ._zs_gallerych{position:relative;line-height:var(--input-small-height)}._zs_gallerycf ._zs_gallerych ._zs_galleryci{float:left;width:50%;min-width:var(--mx-calendar-range-input-width);text-align:center;cursor:text}._zs_gallerycf ._zs_gallerych ._zs_galleryci [mx-view*="mx-calendar/datepicker"]{width:100%}._zs_gallerycf ._zs_gallerych ._zs_galleryci ._zs_gallerycj,._zs_gallerycf ._zs_gallerych ._zs_galleryci ._zs_gallerybw{height:var(--input-small-height);padding:0;line-height:var(--input-small-height);border-radius:var(--border-radius);background-color:var(--color-bg-hover);border:0;color:#333}._zs_gallerycf ._zs_gallerych ._zs_galleryci ._zs_galleryck ._zs_gallerybw{color:var(--color-brand)}._zs_gallerycf ._zs_gallerych ._zs_galleryci ._zs_gallerycl ._zs_gallerybw{color:var(--color-brand-vs)}._zs_gallerycf ._zs_gallerych ._zs_galleryci ._zs_gallerycj{display:inline-block;width:100%;cursor:not-allowed;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-user-select:none;color:#999;vertical-align:middle}._zs_gallerycf ._zs_gallerych ._zs_gallerycm{padding-right:9px}._zs_gallerycf ._zs_gallerych ._zs_gallerycn{padding-left:9px}._zs_gallerycf ._zs_gallerych ._zs_galleryco{position:absolute;top:0;left:50%;width:18px;height:var(--input-small-height);margin-left:-9px;text-align:center}._zs_gallerycf ._zs_gallerycp{margin-top:15px}._zs_gallerycf ._zs_gallerycp ._zs_gallerycq{float:left;width:44%;height:var(--input-small-height);margin-right:6%;margin-top:10px;padding:0 10px;line-height:var(--input-small-height);border-radius:var(--border-radius);cursor:pointer;overflow:hidden;white-space:nowrap}._zs_gallerycf ._zs_gallerycp ._zs_gallerycq:hover{background-color:var(--color-bg-hover)}._zs_gallerycf ._zs_gallerycp ._zs_gallerycq._zs_gallerycr,._zs_gallerycf ._zs_gallerycp ._zs_gallerycq._zs_gallerycr:hover{color:var(--color-brand);background-color:var(--color-brand-opacity)}._zs_gallerycf ._zs_gallerycp._zs_gallerycs ._zs_gallerycq{width:32%;margin-right:1%}._zs_gallerycf._zs_galleryct{--mx-calendar-range-input-width:calc(var(--font-size)*11)}');var o=t.View.extend({tmpl:function(e,a,r,t,l,i,s,c){if(r||(r=e),!l){var n={"&":"amp","<":"lt",">":"gt",'"':"#34","'":"#39","`":"#96"},_=/[&<>"'`]/g,g=function(e){return"&"+n[e]+";"};l=function(e){return""+(null==e?"":e)},t=function(e){return l(e).replace(_,g)}}if(!i){var d={"!":"%21","'":"%27","(":"%28",")":"%29","*":"%2A"},o=function(e){return d[e]},m=/[!')(*]/g;i=function(e){return encodeURIComponent(l(e)).replace(m,o)}}if(!c){var y=/[\\'"]/g;c=function(e){return l(e).replace(y,"\\$&")}}s||(s=function(e,a,r,t){for(t=e[u];--t;)if(e[r=u+t]===a)return r;return e[r=u+e[u]++]=a,r});var u="",v="",z=e.timeType,f=e.title,x=e.vsEnable,p=e.vs,h=e.startDisabled,k=e.dates,b=e.min,w=e.endDisabled,q=e.max,S=e.formatter,T=e.disabledWeeks,D=e.dateType,I=e.vsSingle,K=e.endMinFn,M=e.align,j=e.quickInfos,W=e.quickGap,Y=e.quickTip,F=e.submitText,G=e.cancelText;if(v+='<div mxv class="_zs_gallerycf ',z&&(v+=" _zs_galleryct "),v+='" mx-contextmenu="'+a+'__J()"><div mxv mxa="_zs_gallery}:_" class="_zs_gallerych"><div mxa="_zs_gallery}:a" class="_zs_gallerycg clearfix"><span mxa="_zs_gallery}:b" class="fl">'+t(f)+"：</span>",x&&(v+='<span class="fr" mx-change="'+a+'__L()" mx-view="mx-switch/index?state='+i(p)+'"></span>'),v+='</div><div mxv mxa="_zs_gallery}:c" class="clearfix pr"><div mxv mxa="_zs_gallery}:d" class="_zs_galleryci _zs_gallerycm">',h?v+='<div mxa="_zs_gallery}:e" class="_zs_gallerycj">'+t(k.startStr)+"</div>":(v+='<div mxv="disabledWeeks" ',p&&(v+=' class="_zs_galleryck" '),v+=' mx-change="'+a+"__K({trigger:'start'})\" mx-view=\"mx-calendar/datepicker?min="+i(b)+"&max="+i(w?k.endStr:q)+"&formatter="+i(S)+"&disabledWeeks="+s(r,T)+"&timeType="+i(z)+"&dateType="+i(D)+"&selected="+i(k.startStr)+'"></div>'),v+='</div><div mxs="_zs_gallery}:_" class="_zs_galleryco">-</div><div mxv mxa="_zs_gallery}:f" class="_zs_galleryci _zs_gallerycn">',!p&&I||w?v+='<div mxa="_zs_gallery}:g" class="_zs_gallerycj">'+t(k.endStr)+"</div>":(v+='<div mxv="disabledWeeks" ',p&&(v+=' class="_zs_gallerycl" '),v+=' mx-change="'+a+"__K({trigger:'end'})\" mx-view=\"mx-calendar/datepicker?min="+i(p?b:K(k.startStr,b))+"&max="+i(q)+"&formatter="+i(S)+"&disabledWeeks="+s(r,T)+"&timeType="+i(z)+"&dateType="+i(D)+"&align="+i(M)+"&selected="+i(k.endStr)+'"></div>'),v+="</div></div></div>",j.length&&!p&&!I){v+='<div class="_zs_gallerycp ',j.length>W&&(v+="_zs_gallerycs"),v+='"><div mxa="_zs_gallery}:h" class="_zs_gallerycg">'+t(Y)+'：</div><div mxa="_zs_gallery}:i" class="clearfix">';for(var P=0,$=j.length;P<$;P++){var J=j[P];v+='<span class="_zs_gallerycq ',k.quickDateKey==J.key&&(v+="_zs_gallerycr"),v+='" mx-click="'+a+"__r({quick:true,quickInfo:'"+s(r,J)+'\'})" title="'+t(J.text)+'">'+t(J.text)+"</span>"}v+="</div></div>"}return v+='</div><div mxa="_zs_gallery}:j" class="mx-output-footer"><button mxa="_zs_gallery}:k" mx-click="'+a+'__r()" type="button" class="btn btn-small btn-brand mr10">'+t(F)+'</button><button mxa="_zs_gallery}:l" mx-click="'+a+'__M()" type="button" class="btn btn-small">'+t(G)+"</button></div>"},init:function(e){var a=l.extend(!0,{},e.configs);a.dates=a.dates||{},a.formatter=a.formatter||"YYYY-MM-dd",a.title=a.title||d["calendar.range.title"];var r=a.dates,t=a.formatter,i=(a.quickDates,r.startStr),s=r.endStr,g=a.min,o=a.max;i||(r.startStr=i=n(g,o,t),r.start=c(i)),r.start||(r.start=c(r.startStr)),s||(r.endStr=s=n(g,o,t),r.end=c(s)),r.end||(r.end=c(r.endStr));var m=_(a.quickDates,i,t);if(!r.quickDateKey)for(var y=0;y<m.length;y++){var u=m[y];if(u.start==i&&u.end==s){r.quickDateKey=u.key,r.quickDateText=u.text;break}}a.quickInfos=m,a.quickGap=a.quickGap||7,a.quickTip=d["calendar.quick"],a.submitText=d["dialog.submit"],a.cancelText=d["dialog.cancel"],a.endMinFn=function(e,a){if(!a)return e;var r=new Date(e),t=new Date(a);return r.getTime()>t.getTime()?e:a},this.updater.set(a)},render:function(){this.updater.digest(),this.___=l("#"+this.id)},"__K<change>":function(e){e.stopPropagation();var a=this.updater,r=a.get("dates"),t=a.get("vs"),l=a.get("vsSingle"),i=a.get("formatter"),c=a.get("quickDates"),n=a.get("quickInfos"),d=e.params.trigger,o=e.date+(e.time?" "+e.time:"");r[d+"Str"]=o;var m,y=r.startStr,u=r.endStr,v=new Date(s(y,i));u==g?m=g:(m=new Date(s(u,i)),!t&&!l&&m.getTime()<v.getTime()&&(u=s(m=v,i)));n=_(c,y,i);for(var z,f,x=0;x<n.length;x++){var p=n[x];if(p.start==y&&p.end==u){z=p.text,f=p.key;break}}this.updater.digest({quickInfos:n,dates:{start:v,end:m,startStr:y,endStr:u,quickDateText:z,quickDateKey:f}})},"__L<change>":function(e){e.stopPropagation(),this.updater.digest({vs:e.state})},"__r<click>":function(e){var a=this.updater,r=a.get(),l=r.dates,i=r.formatter,c=r.quickDates,n=e.params;if(n.quick){var d=n.quickInfo,o=new Date(s(d.start,i)),m=void 0;if(d.end==g)m=g;else{m=new Date(s(d.end,i));var y=void 0,u=void 0,v=void 0,z=void 0;r.min&&(v=(y=new Date(s(r.min,i))).getTime()),r.max&&(z=(u=new Date(s(r.max,i))).getTime());var f=o.getTime(),x=m.getTime();v&&f<v?o=y:z&&f>z&&(o=u),z&&x>z?m=u:v&&x<v&&(m=y),m.getTime()<o.getTime()&&(m=o)}for(var p=s(o,i),h=m==g?g:s(m,i),k=_(c,p,i),b=void 0,w=void 0,q=0;q<k.length;q++){var S=k[q];if(S.start==p&&S.end==h){b=S.text,w=S.key;break}}l={start:o,end:m,startStr:p,endStr:h,quickDateText:b,quickDateKey:w}}else{var T=r.vs,D=r.vsSingle;p=l.startStr,h=l.endStr,o=l.start,m=l.end;(h==g&&T||!T&&!D&&h!=g&&m.getTime()<o.getTime())&&(h=p,m=new Date(s(h,i))),t.mix(l,{end:m,endStr:h})}a.digest({dates:l}),this.___.trigger({type:"change",vs:r.vs,dates:l})},"__M<click>":function(){this.___.trigger("cancel")},"__J<contextmenu>":function(e){e.preventDefault()}});r.exports=o});