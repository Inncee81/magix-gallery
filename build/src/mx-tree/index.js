define("mx-tree/index",["magix","mx-tree/util","../mx-medusa/util","./branch"],(e,t,r)=>{e("./branch");var n=e("magix"),l=n.Vframe,a=e("mx-tree/util"),i=e("../mx-medusa/util");n.applyStyle("_zs_galleryaJ",':root{--mx-tree-oper-size:calc(var(--font-size) + 2px)}._zs_gallerykN{position:relative;height:32px;line-height:20px;padding-bottom:12px;background-color:#fff;overflow:hidden;transition:height .2s}._zs_gallerykN ._zs_gallerykO{float:left;width:var(--mx-tree-oper-size);height:var(--mx-tree-oper-size);margin-right:5px;line-height:var(--mx-tree-oper-size);font-size:var(--mx-tree-oper-size);color:#ccc;transition:color var(--duration);-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-user-select:none}._zs_gallerykN ._zs_gallerykP{cursor:pointer}._zs_gallerykN ._zs_gallerykP:hover{color:#666}._zs_gallerykQ ._zs_gallerykN{height:0;padding-bottom:0}._zs_gallerykR{position:relative}._zs_gallerykS{padding-left:calc(var(--mx-tree-oper-size) + 5px)}._zs_gallerykT,._zs_gallerykT ._zs_gallerykR{position:relative}._zs_gallerykT ._zs_gallerykR:after{content:"";position:absolute;top:22px;left:calc(var(--mx-tree-oper-size)/2);bottom:2px;width:1px;background-color:var(--color-border)}._zs_gallerykT ._zs_gallerykR:last-child:after{content:none}'),r.exports=n.View.extend({tmpl:function(e,t,r,n,l,a,i,o){if(r||(r=e),!l){var s={"&":"amp","<":"lt",">":"gt",'"':"#34","'":"#39","`":"#96"},c=/[&<>"'`]/g,u=function(e){return"&"+s[e]+";"};l=function(e){return""+(null==e?"":e)},n=function(e){return l(e).replace(c,u)}}if(!a){var _={"!":"%21","'":"%27","(":"%28",")":"%29","*":"%2A"},d=function(e){return _[e]},f=/[!')(*]/g;a=function(e){return encodeURIComponent(l(e)).replace(f,d)}}if(!o){var p=/[\\'"]/g;o=function(e){return l(e).replace(p,"\\$&")}}i||(i=function(e,t,r,n){for(n=e[g];--n;)if(e[r=g+n]===t)return r;return e[r=g+e[g]++]=t,r});var g="",h="",m=e.hasLine,v=e.viewId,x=e.readOnly,y=e.needExpand,z=e.textKey,k=e.valueKey,b=e.closeMap,V=e.list;return h+='<div mxv="readOnly,needExpand,closeMap,list" class="',m&&(h+=" _zs_gallerykT "),h+='" id="tree_'+n(v)+'" mx-change="'+t+'__ad()" mx-view="mx-tree/branch?readOnly='+i(r,x)+"&needExpand="+i(r,y)+"&textKey="+a(z)+"&valueKey="+a(k)+"&closeMap="+i(r,b)+"&list="+i(r,V)+'"></div>'},init:function(e){var t=this;t.__fl={},t.__fm=[],t.__a=$("#"+t.id),t.updater.snapshot(),t.assign(e)},assign:function(e){var t,r=this,l=r.updater.altered(),o=e.readOnly+""=="true",s=e.hasLine+""=="true",c=e.valueKey||"value",u=e.textKey||"text",_=e.parentKey||"pValue",d=e.needAll+""=="true",f=e.needExpand+""=="true",p=a.listToTree(e.list,c,_);if(d){var g={};g[c]=r.id+"_all",g[u]=i["select.all"],g.isAll=!0,g.children=p.list,t=[g]}else t=p.list;var h=e.close+""=="true",m={},v=function(e){e.forEach(function(e){m[e[c]]=h,e.children&&e.children.length>0&&v(e.children)})};v(t),r.__fl=n.mix(m,r.__fl);var x=function(e){e.forEach(function(e){e.close=r.__fl[e[c]],e.children&&e.children.length>0&&x(e.children)})};return x(t),r.__fm=r.__fm.map(function(e){return e+""}),(e.bottomValues||[]).forEach(function(e){e+="",r.__fm.indexOf(e)<0&&r.__fm.push(e)}),r.updater.set({viewId:r.id,valueKey:c,textKey:u,list:t,readOnly:o,hasLine:s,needExpand:f,closeMap:r.__fl,bottomValues:r.__fm}),r.__a.val(r.__fm),l||(l=r.updater.altered()),!!l&&(r.updater.snapshot(),!0)},render:function(){this.updater.digest();var e=this.updater.get("bottomValues");e.length>0&&this.setBottomValues(e)},"__ad<change>":function(e){e.stopPropagation();var t=this.getBottomValues();this.__a.val(this.__fm=t).trigger($.Event("change",{bottomValues:t}))},setBottomValues:function(e){this.loop(function(t){t.invoke("setValues",[e])})},getBottomValues:function(){var e=[];return this.loop(function(t){var r=t.invoke("getValues");e=e.concat(r)}),e},getBottomItems:function(){var e=[];return this.loop(function(t){var r=t.invoke("getItems");e=e.concat(r)}),e},loop:function(e){var t=this.owner.children(),r=function(t){for(var n=0,a=t;n<a.length;n++){var i=a[n],o=l.get(i);e(o);var s=o.children();s&&s.length>0&&r(s)}};r(t)}})});