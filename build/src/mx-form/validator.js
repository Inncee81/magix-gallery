define("mx-form/validator",["$","magix","mx-form/rule","./util"],(e,r,t)=>{var a=e("$"),l=e("magix"),o=e("mx-form/rule"),i=e("./util");l.applyStyle("_zs_galleryU","._zs_gallerygR{box-shadow:0 1px 1px 0 rgba(0,0,0,.08);border:1px solid #f5f5f6}html ._zs_gallerygS,html ._zs_gallerygS:focus,html ._zs_gallerygS:hover{border-color:#a40100}._zs_gallerygT{display:none;position:absolute;white-space:nowrap;word-wrap:normal;pointer-events:none;color:#a40100;font-size:12px}._zs_gallerygU,._zs_gallerygU:focus,._zs_gallerygU:hover{border-color:#ffb400}._zs_gallerygV{display:none;position:absolute;white-space:nowrap;word-wrap:normal;pointer-events:none;color:#ffb400;font-size:12px}");var s=function(e,r,t){var a,i,s,n=!0;for(var f in r)if(l.has(r,f)){if(o[f]){var p=o[f](t,i=r[f]);n=p.valid,s=p.tip}else n=!0,s="过滤掉不在校验规则内的";if(!n){a=f;break}}return{type:e,placement:r.placement,valid:n,action:a,rule:i,val:t,tip:s}},n=function(e){var r=a('[mxe="'+e+'"]');r.removeClass("_zs_gallerygU _zs_gallerygS"),r.each(function(e,r){var t=(r=a(r)).attr("id")+"_msg";a("#"+t).hide()})},f=function(e,r,t){var o=a('[mxe="'+r+'"]');if(o.length){switch(e){case"warn":o.addClass("_zs_gallerygU").removeClass("_zs_gallerygS");break;case"error":o.addClass("_zs_gallerygS").removeClass("_zs_gallerygU")}return"checkbox"!=o.prop("type")&&"radio"!=o.prop("type")||(o=a(o[0])),o.each(function(r,o){var i=(o=a(o)).parent(),s=o.attr("id");s||(s=l.guid(),o.attr("id",s));var n=s+"_msg",f=a("#"+n);f.length||("static"==i.css("position")&&i.css({position:"relative"}),o.after('<div id="'+n+'"/>'),f=a("#"+n));switch(e){case"warn":f[0].className="_zs_gallerygV";break;case"error":f[0].className="_zs_gallerygT"}f.html(t.tip).show();var p=t.placement||"bottom",c=o.outerWidth(),d=o.outerHeight(),g=o.offset(),v=i.offset();switch(p){case"right":f.css({lineHeight:"32px",top:g.top-v.top,left:g.left-v.left+c+10});break;case"bottom":f.css({lineHeight:"18px",top:g.top-v.top+d,left:g.left-v.left+10})}}),!0}};t.exports={isValid:function(e,r){e=l.mix({element:null,scrollIntoView:!0,checkSubs:!0},e||{});var t,o=this,i=!0,s=o.owner.children(),n=!1;if(r||(r=[],n=!0),e.checkSubs)for(var f=0;f<s.length;f++){!1===l.Vframe.get(s[f]).invoke("isValid",[r])&&(i=!1)}e.element?(t="string"!=typeof e.element||/^#/.test(e.element)||/^\./.test(e.element)?a(e.element):a("#"+e.element)).attr("mxe")||(t=t.find('[mxe^="'+o.id+'"]')):t=a("#"+o.id+' [mxe^="'+o.id+'"]');var p=[];t.each(function(e,r){o.__bS(a(r)),p.push(a(r).attr("mxe"))});var c=o.updater.$form;if(c)for(var d=0;d<p.length;d++){var g=p[d];if(c[g]&&"error"==c[g].type){r.push(g),i=!1;break}}if(n&&e.scrollIntoView){for(var v=1e20,h=void 0,m=r.length,_=void 0,u=void 0;m--;)(_=a('[mxe="'+r[m]+'"]')).length&&(u=_.offset()).top<v&&(h=_[0],v=u.top);h&&(h.scrollIntoViewIfNeeded?h.scrollIntoViewIfNeeded():h.scrollIntoView&&h.scrollIntoView())}return i},"$[mxc]<keyup,change,focusout>":function(e){var r=a(e.eventTarget),t=r.attr("mxe");t&&t.startsWith(this.id)&&this.__bS(r)},__bS:function(e){for(var r=this.updater,t=r.$form||(r.$form={}),o=e.attr("mxc"),p=!0,c=0,d=r.parse(o);c<d.length;c++){for(var g=d[c],v=g.f||{},h=g.p.split("."),m=h.pop(),_=void 0,u=r.get();u&&h.length;)u=u[h.shift()];if("checkbox"==e.prop("type")){var y=u[m],x=e.prop("checked");if(!0===y||!1===y)_=x;else if(_=e.val(),a.isArray(y)){var w=e.prop("name");if(w)y=[],i.addCheckbox(w,y,v);else{var b=i.indexOf(y,_);x?-1===b&&y.push(_):b>-1&&y.splice(b,1)}_=y}else a.isPlainObject(y)?(x?y[_]=_:delete y[_],_=y):_=x?_:""}else if("radio"==e.prop("type")){var z=e.prop("name");_=a("input[name="+z+"]:checked").val()}else _=e.val();if(p){var k=s("error",v,_),S=e.attr("mxe");if(k.valid){if(delete t[S],n(S),l.has(v,"warn")){var V=s("warn",v.warn,_);V.valid?(delete t[S],n(S)):(t[S]=V,f("warn",S,V))}}else t[S]=k,p=!1,f("error",S,k)}}},clearValid:function(){var e=this.updater.$form;if(e)for(var r in e)n(r);this.updater.$form={}},"$doc<htmlchanged>":function(e){var r=this.updater.$form;if(e.vId==this.id&&r)for(var t in r){var a=r[t];f(a.type,t,a)||delete r[t]}}}});