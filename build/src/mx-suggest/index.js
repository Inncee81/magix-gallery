define("mx-suggest/index",["magix","$","../mx-medusa/util","../mx-util/monitor"],(t,e,i)=>{var a=t("magix"),s=t("$"),l=t("../mx-medusa/util"),n=t("../mx-util/monitor");a.applyStyle("_zs_galleryaw",'[mx-view*="mx-suggest/index"]{position:relative;display:inline-block}'),i.exports=a.View.extend({tmpl:function(t,e,i,a,s,l,n,u){if(i||(i=t),!s){var _={"&":"amp","<":"lt",">":"gt",'"':"#34","'":"#39","`":"#96"},r=/[&<>"'`]/g,o=function(t){return"&"+_[t]+";"};s=function(t){return""+(null==t?"":t)},a=function(t){return s(t).replace(r,o)}}if(!l){var d={"!":"%21","'":"%27","(":"%28",")":"%29","*":"%2A"},c=function(t){return d[t]},h=/[!')(*]/g;l=function(t){return encodeURIComponent(s(t)).replace(h,c)}}if(!u){var p=/[\\'"]/g;u=function(t){return s(t).replace(p,"\\$&")}}n||(n=function(t,e,i,a){for(a=t[g];--a;)if(t[i=g+a]===e)return i;return t[i=g+t[g]++]=e,i});var g="",v="",x=t.placeholder,f=t.viewId,m=t.selectedText,y=t.show,k=t.loading,w=t.list,T=t.selectedValue,b=t.emptyText;if(v+='<div mxv mxa="_zs_galleryd%:_" class="search-box"><i mxs="_zs_galleryd%:_" class="mc-iconfont search-icon">&#xe651;</i><input class="input search-input" placeholder="'+a(x)+'" autocomplete="off" id="'+a(f)+'_input" value="'+a(m)+'" mx-keyup="'+e+'__dy()" mx-paste="'+e+'__dy()" mx-focusin="'+e+'__dy()" mx-focusout="'+e+'__m()" mx-change="'+e+'__m()"/><div class="mx-output mx-output-bottom ',y&&(v+=" mx-output-open "),v+='"><ul mxa="_zs_galleryd%:a" class="mx-output-list">',k)v+='<li mxs="_zs_galleryd%:a"><div class="loading" style="padding: 40px 0;"><span class="loading-anim"></span></div></li>';else{if(v+=" ",w.length>0){v+=" ";for(var C=0,V=w.length;C<V;C++){var z=w[C];v+='<li mxa="_zs_galleryd%:b" class="mx-output-item"><span class="mx-output-link ',T+""==z.value+""&&(v+=" mx-output-link-active "),v+="\" data-active=\"(selectedValue + '') === (item.value + '')\" mx-click=\""+e+"__ac({item:'"+n(i,z)+"'})\">"+s(z.text)+"</span></li>"}v+=" "}else v+='<li mxa="_zs_galleryd%:c" class="text-center color-9">'+a(b)+"</li>";v+=" "}return v+="</ul></div></div>"},init:function(t){var e=this;e.updater.snapshot(),e.assign(t),n.__h(),e.on("destroy",function(){n.__i(e),n.__j(),e.__dt&&clearTimeout(e.__dt)})},assign:function(t){var e=this.updater.altered(),i=t.placeholder||"";i||(i=l.search),this["key.value"]=t.listValue||"value",this["key.text"]=t.listText||"text";var a=this.__du(t.list||this.__dv);this.__dv=a;var n=t.item||{},u=t.selected||n.value||"",_=n.text||"";if(u)for(var r=0;r<a.length;r++)if(a[r].value==u){_=a[r].text;break}this.__dw=u;var o=(t.type||"text")+"";return"all"==o&&(o="text,value"),this.__dx=o.split(","),this.updater.set({viewId:this.id,list:a,selectedValue:u,selectedText:_,placeholder:i,show:!1,emptyText:l["empty.text"]}),this.___=s("#"+this.id),this.___.val(u),e||(e=this.updater.altered()),!!e&&(this.updater.snapshot(),!0)},__du:function(t){var e=this["key.value"],i=this["key.text"],a=[];return t&&t.length>0&&(a="object"==typeof t[0]?t.map(function(t){return{value:t[e],text:t[i]}}):t.map(function(t){return{value:t,text:t}})),a},render:function(){this.updater.digest()},"__dy<focusin,keyup,paste>":function(t){t.stopPropagation();var e=this;e.__dt&&clearTimeout(e.__dt);for(var i=e.updater.get(),a=i.list,s=i.selectedValue,l=-1,n=0;n<a.length;n++)if(a[n].value==s){l=n;break}40==t.keyCode||38==t.keyCode?(40==t.keyCode&&(l+=1)>=a.length&&(l=0),38==t.keyCode&&(l-=1)<0&&(l=a.length-1),e.updater.digest({selectedValue:a[l].value})):13==t.keyCode?(l<0&&(l=0),e.__ac(a[l])):e.__dt=setTimeout(e.wrapAsync(function(){e.__o()}),300)},showLoading:function(){this.updater.digest({loading:!0})},hideLoading:function(){this.updater.digest({loading:!1})},update:function(t){if(this.updater.get("show")){this.__dv=this.__du(t);var e=s("#"+this.id+"_input").val();this.updater.digest({list:this.__dv,selectedText:e}),n.__q(this)}},__l:function(t){return a.inside(t,this.id)},"__m<change,focusout>":function(t){t.stopPropagation()},__o:function(t){var e=this.__dv,i=s("#"+this.id+"_input").val(),a=(i+"").toLowerCase(),l=[],u=this.__dx;e.forEach(function(t){var e=!1;u.forEach(function(i){(t[i]+"").toLowerCase().indexOf(a)>-1&&(e=!0)}),e&&l.push(t)}),this.updater.digest({list:l,selectedText:i,show:!0}),n.__q(this),this.___.trigger({type:"show",keyword:i})},__n:function(){for(var t=this.updater.get().list,e=this.__dw+"",i="",a=0;a<t.length;a++){var s=t[a];if(s.value+""===e){i=s.text;break}}this.updater.digest({selectedValue:e,selectedText:i,show:!1}),n.__i(this),this.___.trigger("focusout")},"__ac<click>":function(t){t.stopPropagation();var e=t.params.item;this.__ac(e)},__ac:function(t){var e=!(t.value==this.__dw),i=t.text,a=this.__dw=t.value;this.__n(),e&&(this.___.val(a).trigger({type:"suggest",selected:{value:a,text:i}}),this.___.trigger("change"))},__af:function(t,e){this.___.val(t).trigger({type:"suggest",selected:{value:t,text:e}})}})});