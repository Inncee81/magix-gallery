define("mx-suggest/index",["magix","$","../mx-medusa/util","../mx-util/monitor"],(e,t,i)=>{var s=e("magix"),a=e("$"),l=e("../mx-medusa/util"),n=e("../mx-util/monitor");s.applyStyle("_zs_gallery_mx-suggest_index_",'[mx-view*="mx-suggest/index"] {\n  position: relative;\n  display: inline-block;\n}\n[mx-view*="mx-suggest/index"] ._zs_gallery_mx-suggest_index_-delete-icon {\n  position: absolute;\n  right: 6px;\n  top: 50%;\n  width: 12px;\n  height: 12px;\n  font-size: 12px;\n  margin-top: -6px;\n  color: #ccc;\n  cursor: pointer;\n  transition: all var(--duration);\n  background-color: #fff;\n}\n[mx-view*="mx-suggest/index"] ._zs_gallery_mx-suggest_index_-delete-icon:hover {\n  color: #999;\n}\n'),i.exports=s.View.extend({tmpl:function(e,t,i,s,a,l,n,r){if(i||(i=e),!a){var o={"&":"amp","<":"lt",">":"gt",'"':"#34","'":"#39","`":"#96"},u=/[&<>"'`]/g,c=function(e){return"&"+o[e]+";"};a=function(e){return""+(null==e?"":e)},s=function(e){return a(e).replace(u,c)}}if(!l){var d={"!":"%21","'":"%27","(":"%28",")":"%29","*":"%2A"},g=function(e){return d[e]},h=/[!')(*]/g;l=function(e){return encodeURIComponent(a(e)).replace(h,g)}}if(!r){var p=/[\\'"]/g;r=function(e){return a(e).replace(p,"\\$&")}}n||(n=function(e,t,i,s){for(s=e[v];--s;)if(e[i=v+s]===t)return i;return e[i=v+e[v]++]=t,i});var x,m,f,v="",y="",_=e.placeholder,w=e.viewId,k=e.selectedText,b=e.show,T=e.loading,$=e.list,z=e.selectedValue,V=e.emptyText;try{if(y+='<div mxv mxa="_zs_galleryee:_" class="search-box"><i mxs="_zs_galleryee:_" class="mc-iconfont search-icon">&#xe651;</i><input class="input search-input" placeholder="',f=4,m="=placeholder",y+=(x="<%=placeholder%>",s(_)+'" autocomplete="off" id="'),f=6,m="=viewId",y+=(x="<%=viewId%>",s(w)+'_input" value="'),f=7,m="=selectedText",y+=(x="<%=selectedText%>",s(k)+'" mx-keyup="'+t+'@{suggest}()" mx-paste="'+t+'@{suggest}()" mx-focusin="'+t+'@{suggest}()" mx-focusout="'+t+'@{stop}()" mx-change="'+t+'@{stop}()"/>'),f=13,m="if selectedText",x="<%if (selectedText) {%>",k&&(y+='<i mxs="_zs_galleryee:a" class="mc-iconfont _zs_gallery_mx-suggest_index_-delete-icon" mx-click="'+t+'@{clear}()">&#xe6f8;</i>',f=15,m="/if",x="<%}%>"),y+='<div class="mx-output mx-output-bottom ',f=17,m="if show",x="<%if (show) {%>",b&&(y+=" mx-output-open ",f=17,m="/if",x="<%}%>"),y+='"><ul mxa="_zs_galleryee:a" class="mx-output-list">',f=19,m="if loading",x="<%if (loading) {%>",T)y+='<li mxs="_zs_galleryee:b"><div class="loading" style="padding: 40px 0;"><span class="loading-anim"></span></div></li>',f=21,m="else",x="<%}else {%>";else{if(y+=" ",f=22,m="if (list.length > 0)",x="<%if (list.length > 0) {%>",$.length>0){y+=" ",f=23,m="each list as item",x="<%for (var $art_igehitggpf$art_i = 0, $art_cxriiwqtyyd$art_c = list.length; $art_igehitggpf$art_i < $art_cxriiwqtyyd$art_c; $art_igehitggpf$art_i++) {            var item = list[$art_igehitggpf$art_i]%>";for(var C=0,I=$.length;C<I;C++){var L=$[C];y+='<li mxa="_zs_galleryee:b" class="mx-output-item"><span class="mx-output-link ',f=25,m="if ((selectedValue + '') === (item.value + ''))",x="<%if ((selectedValue + '') === (item.value + '')) {%>",z+""==L.value+""&&(y+=" mx-output-link-active ",f=25,m="/if",x="<%}%>"),y+="\" data-active=\"(selectedValue + '') === (item.value + '')\" mx-click=\""+t+"@{select}({item:'",f=27,m="@item",y+=(x="<%@item%>",n(i,L)+"'})\">"),f=28,m="!item.text",y+=(x="<%!item.text%>",a(L.text)+"</span></li>"),f=31,m="/each",x="<%}%>"}y+=" ",f=32,m="else",x="<%}    else {%>"}else y+='<li mxa="_zs_galleryee:c" class="text-center color-9 pt20 pb20">',f=33,m="=emptyText",y+=(x="<%=emptyText%>",s(V)+"</li>"),f=34,m="/if",x="<%}%>";y+=" ",f=35,m="/if",x="<%}%>"}y+="</ul></div></div>"}catch(e){var E="render view error:"+(e.message||e);throw m&&(E+="\r\n\tsrc art:{{"+m+"}}\r\n\tat line:"+f),E+="\r\n\t"+(m?"translate to:":"expr:"),E+=x+"\r\n\tat file:mx-suggest/index.html"}return y},init:function(e){var t=this;t.updater.snapshot(),t.assign(e);var i=e.list||[];t["@{dynamic.list}"]=0==i.length,n["@{setup}"](),t.on("destroy",function(){n["@{remove}"](t),n["@{teardown}"](),t["@{suggest.delay.timer}"]&&clearTimeout(t["@{suggest.delay.timer}"])})},assign:function(e){var t=this.updater.altered(),i=e.placeholder||"";i||(i=l.search),this["@{dynamic.enter}"]=e.dynamicEnter+""=="true",this["@{key.value}"]=e.listValue||"value",this["@{key.text}"]=e.listText||"text";var s=this["@{wrap}"](e.list||this["@{list.bak}"]);this["@{list.bak}"]=s;var n=e.item||{},r=n.value||e.selected||"",o=n.text||"";if(r)for(var u=0;u<s.length;u++)if(s[u].value==r){o=s[u].text;break}this["@{value.bak}"]=r;var c=(e.type||"text")+"";return"all"==c&&(c="text,value"),this["@{search.type}"]=c.split(","),this.updater.set({viewId:this.id,list:s,selectedValue:r,selectedText:o,placeholder:i,show:!1,emptyText:l["empty.text"]}),this["@{owner.node}"]=a("#"+this.id),this["@{owner.node}"].val(r),t||(t=this.updater.altered()),!!t&&(this.updater.snapshot(),!0)},"@{wrap}":function(e){var t=this["@{key.value}"],i=this["@{key.text}"],s=[];return e&&e.length>0&&(s="object"==typeof e[0]?e.map(function(e){return{value:e[t],text:e[i]}}):e.map(function(e){return{value:e,text:e}})),s},render:function(){this.updater.digest()},"@{suggest}<focusin,keyup,paste>":function(e){e.stopPropagation();var t=this;t["@{suggest.delay.timer}"]&&clearTimeout(t["@{suggest.delay.timer}"]);for(var i=t.updater.get(),s=i.list,l=i.selectedValue,n=-1,r=0;r<s.length;r++)if(s[r].value==l){n=r;break}if(40==e.keyCode||38==e.keyCode)40==e.keyCode&&(n+=1)>=s.length&&(n=0),38==e.keyCode&&(n-=1)<0&&(n=s.length-1),t.updater.digest({selectedValue:s[n].value});else if(13==e.keyCode)if(t["@{dynamic.enter}"]){var o=a("#"+t.id+"_input").val();t["@{select}"]({value:o,text:o})}else t["@{enter}"](n);else t["@{suggest.delay.timer}"]=setTimeout(t.wrapAsync(function(){t["@{show}"]()}),250)},"@{clear}<click>":function(){this.updater.digest({selectedText:""}),this["@{select}"]({value:"",text:""})},"@{show}":function(e){var t=a("#"+this.id+"_input").val(),i=this["@{list.bak}"],s=[];if(this["@{dynamic.list}"]){if(!t)return this.updater.set({list:this["@{list.bak}"]=[]}),void this["@{hide}"]();s=i}else{var l=(t+"").toLowerCase(),r=this["@{search.type}"];i.forEach(function(e){var t=!1;r.forEach(function(i){(e[i]+"").toLowerCase().indexOf(l)>-1&&(t=!0)}),t&&s.push(e)})}this.updater.digest({list:s,selectedText:t,show:!0}),n["@{add}"](this),e||this["@{owner.node}"].trigger({type:"show",keyword:t})},"@{hide}":function(e){this["@{suggest.delay.timer}"]&&clearTimeout(this["@{suggest.delay.timer}"]);var t=(e=e||{text:a("#"+this.id+"_input").val()}).value||"",i=e.text||"";this.updater.digest({selectedValue:t,selectedText:i,show:!1,loading:!1}),n["@{remove}"](this),this["@{owner.node}"].trigger({type:"focusout",keyword:i})},"@{enter}":function(e){if(!a("#"+this.id+"_input").val()&&this["@{dynamic.list}"])this["@{select}"]({value:"",text:""});else{var t=this.updater.get().list;e<0&&(e=0),t[e]&&this["@{select}"](t[e])}},"@{select}<click>":function(e){e.stopPropagation();var t=e.params.item;this["@{select}"](t)},"@{select}":function(e){var t=!(e.value==this["@{value.bak}"]),i=this["@{value.bak}"]=e.value;this["@{hide}"](e),t&&(this["@{owner.node}"].val(i).trigger({type:"change",selected:i,item:e}),this["@{owner.node}"].trigger({type:"suggest",selected:{value:i,text:e.text}}))},"@{inside}":function(e){return s.inside(e,this.id)},"@{stop}<change,focusout>":function(e){e.stopPropagation()},showLoading:function(){this.updater.digest({loading:!0})},hideLoading:function(){this.updater.digest({loading:!1})},update:function(e){this["@{list.bak}"]=this["@{wrap}"](e),this["@{show}"](!0)}})});