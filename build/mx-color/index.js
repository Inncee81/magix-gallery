define("mx-color/index",["magix","$","../mx-dragdrop/index"],(o,e,t)=>{var r=o("magix"),i=o("$"),s=o("../mx-dragdrop/index");r.applyStyle("_zs_gallery_mx-color_index_",':root {\n  --mx-color-width: 224px;\n  --mx-color-slider-width: 18px;\n  --mx-color-picker-width: calc(var(--mx-color-width) - var(--mx-color-slider-width) - 10px);\n}\n._zs_gallery_mx-color_index_-shortcuts,\n._zs_gallery_mx-color_index_-cbd,\n._zs_gallery_mx-color_index_-foot {\n  width: var(--mx-color-width);\n}\n._zs_gallery_mx-color_index_-cbd {\n  margin: 10px 0;\n}\n._zs_gallery_mx-color_index_-shortcut {\n  position: relative;\n  float: left;\n  width: 15px;\n  height: 15px;\n  margin: -1px 0 0 -1px;\n  border: 1px solid #333;\n  cursor: pointer;\n}\n._zs_gallery_mx-color_index_-shortcut._zs_gallery_mx-color_index_-selected:before,\n._zs_gallery_mx-color_index_-shortcut._zs_gallery_mx-color_index_-selected:after {\n  content: \' \';\n  position: absolute;\n  left: 0;\n  top: 0;\n  width: 100%;\n  height: 100%;\n}\n._zs_gallery_mx-color_index_-shortcut._zs_gallery_mx-color_index_-selected:before {\n  z-index: 2;\n  border: solid 1px #fff;\n}\n._zs_gallery_mx-color_index_-shortcut._zs_gallery_mx-color_index_-selected:after {\n  z-index: 1;\n  border: solid 2px #333;\n}\n._zs_gallery_mx-color_index_-cpicker {\n  float: left;\n  position: relative;\n  width: var(--mx-color-picker-width);\n  height: var(--mx-color-picker-width);\n  cursor: pointer;\n}\n._zs_gallery_mx-color_index_-cpicker ._zs_gallery_mx-color_index_-cpicker-indicator {\n  position: absolute;\n  width: 8px;\n  height: 8px;\n  box-shadow: 0 0 0 1.5px #fff, inset 0 0 1px 1px rgba(0, 0, 0, 0.3), 0 0 1px 2px rgba(0, 0, 0, 0.4);\n  border-radius: 50%;\n}\n._zs_gallery_mx-color_index_-slide {\n  float: right;\n  position: relative;\n  width: var(--mx-color-slider-width);\n  height: var(--mx-color-picker-width);\n  cursor: pointer;\n}\n._zs_gallery_mx-color_index_-slide ._zs_gallery_mx-color_index_-slide-indicator {\n  position: absolute;\n  right: -6px;\n  top: -6px;\n  width: 0;\n  height: 0;\n  background-color: none;\n  border-right: 6px solid #333;\n  border-left: none;\n  border-bottom: 6px solid transparent;\n  border-top: 6px solid transparent;\n}\n._zs_gallery_mx-color_index_-color-value {\n  width: calc(var(--mx-color-width) - 100px - 20px);\n}\n._zs_gallery_mx-color_index_-submit-btn {\n  width: 50px;\n}\n._zs_gallery_mx-color_index_-bg-color {\n  height: var(--input-height);\n  width: 50px;\n  margin-right: 10px;\n  border-radius: var(--border-radius);\n  border: 1px solid var(--color-border);\n}\n._zs_gallery_mx-color_index_-alpha {\n  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAIAAADZF8uwAAAAGUlEQVQYV2M4gwH+YwCGIasIUwhT25BVBADtzYNYrHvv4gAAAABJRU5ErkJggg==);\n  width: var(--mx-color-width);\n  height: 12px;\n  margin-bottom: 10px;\n}\n._zs_gallery_mx-color_index_-alpha-tracker {\n  position: relative;\n  height: 100%;\n  cursor: pointer;\n}\n._zs_gallery_mx-color_index_-alpha-indicator {\n  position: absolute;\n  left: -2px;\n  top: 2px;\n  height: 8px;\n  width: 4px;\n  box-shadow: 0 0 0 1.5px #fff, inset 0 0 1px 1px rgba(0, 0, 0, 0.3), 0 0 1px 2px rgba(0, 0, 0, 0.4);\n  background: #fff;\n}\n._zs_gallery_mx-color_index_-dot {\n  display: inline-block;\n  width: var(--input-height);\n  height: var(--input-height);\n  border-radius: 50%;\n  vertical-align: middle;\n}\n[mx-view*="mx-color/index"] {\n  width: calc(var(--mx-color-width) + 22px);\n  min-width: calc(var(--mx-color-width) + 22px);\n  padding: 10px;\n  background-color: #fff;\n}\n[mx-view*="mx-color/picker"] ._zs_gallery_mx-color_index_-color-output {\n  min-width: 0;\n}\n[mx-view*="mx-color/picker"][mx-view*="dot=true"] {\n  min-width: var(--input-height);\n}\n[mx-view*="mx-color/picker"][mx-view*="dot=true"] ._zs_gallery_mx-color_index_-color-output {\n  max-width: none;\n}\n');var a="_zs_gallery_mx-color_index_-selected",n=["d81e06","f4ea2a","1afa29","1296db","13227a","d4237a","ffffff","e6e6e6","dbdbdb","cdcdcd","bfbfbf","8a8a8a","707070","515151","2c2c2c","000000","ea986c","eeb174","f3ca7e","f9f28b","c8db8c","aad08f","87c38f","83c6c2","7dc5eb","87a7d6","8992c8","a686ba","bd8cbb","be8dbd","e89abe","e8989a","e16632","e98f36","efb336","f6ef37","afcd51","7cba59","36ab60","1baba8","17ace3","3f81c1","4f68b0","594d9c","82529d","a4579d","db649b","dd6572","d84e06","e0620d","ea9518","f4ea2a","8cbb1a","2ba515","0e932e","0c9890","1295db","0061b2","0061b0","004198","122179","88147f","d3227b","d6204b"],l=function(o,e,t){var r,i,s,a,n;o=o%360/60,r=i=s=t-(n=t*e);var l=255*(r+=[n,a=n*(1-Math.abs(o%2-1)),0,0,a,n][o=~~o]),c=255*(i+=[a,n,n,a,0,0][o]),d=255*(s+=[0,0,a,n,n,a][o]);return{r:l,g:c,b:d,hex:"#"+(16777216|d|c<<8|l<<16).toString(16).slice(1)}};t.exports=r.View.extend({mixins:[s],tmpl:function(o,e,t,r,i,s,a,n){if(t||(t=o),!i){var l={"&":"amp","<":"lt",">":"gt",'"':"#34","'":"#39","`":"#96"},c=/[&<>"'`]/g,d=function(o){return"&"+l[o]+";"};i=function(o){return""+(null==o?"":o)},r=function(o){return i(o).replace(c,d)}}if(!s){var _={"!":"%21","'":"%27","(":"%28",")":"%29","*":"%2A"},p=function(o){return _[o]},x=/[!')(*]/g;s=function(o){return encodeURIComponent(i(o)).replace(x,p)}}if(!n){var h=/[\\'"]/g;n=function(o){return i(o).replace(h,"\\$&")}}var g,f="",v=o.id,m=o.shortcuts,u=o.alpha,b=o.btns;try{f+='<div id="scs_'+(g="<%=id%>",r(v))+'"><ul mxa="_zs_galleryaD:_" class="_zs_gallery_mx-color_index_-shortcuts clearfix">',g="<%for (var i = 0; i < shortcuts.length; i++) {%>";for(var y=0;y<m.length;y++)f+='<li class="_zs_gallery_mx-color_index_-shortcut" id="sc_'+(g="<%=shortcuts[i]%>",r(m[y]))+"_"+(g="<%=id%>",r(v))+'" style="background:#'+(g="<%=shortcuts[i]%>",r(m[y]))+'" mx-click="'+e+"@{shortcuts.picked}({color:'#"+(g="<%=$eq(shortcuts[i])%>",r(n(m[y])))+"'})\"></li>",g="<%}%>";f+='</ul></div><div mxa="_zs_galleryaD:a" class="_zs_gallery_mx-color_index_-cbd clearfix"><div class="_zs_gallery_mx-color_index_-cpicker" id="cz_'+(g="<%=id%>",r(v))+'" mx-mousedown="'+e+'@{color.zone.drag}()"><svg mxa="_zs_galleryaD:b" xmlns="http://www.w3.org/2000/svg" version="1.1" width="100%" height="100%"><defs><lineargradient id="gb_'+(g="<%=id%>",r(v))+'" x1="0%" y1="100%" x2="0%" y2="0%"><stop mxs="_zs_galleryaD:_" offset="0%" stop-color="#000000" stop-opacity="1"></stop><stop mxs="_zs_galleryaD:a" offset="100%" stop-color="#CC9A81" stop-opacity="0"></stop></lineargradient><lineargradient id="gw_'+(g="<%=id%>",r(v))+'" x1="0%" y1="100%" x2="100%" y2="100%"><stop mxs="_zs_galleryaD:b" offset="0%" stop-color="#FFFFFF" stop-opacity="1"></stop><stop mxs="_zs_galleryaD:a" offset="100%" stop-color="#CC9A81" stop-opacity="0"></stop></lineargradient></defs><rect x="0" y="0" width="100%" height="100%" fill="url(#gw_'+(g="<%=id%>",r(v))+')"></rect><rect x="0" y="0" width="100%" height="100%" fill="url(#gb_'+(g="<%=id%>",r(v))+')"></rect></svg><div class="_zs_gallery_mx-color_index_-cpicker-indicator" id="ci_'+(g="<%=id%>",r(v))+'"></div></div><div mxa="_zs_galleryaD:c" class="_zs_gallery_mx-color_index_-slide" mx-mousedown="'+e+'@{slide.drag}()"><svg mxa="_zs_galleryaD:d" xmlns="http://www.w3.org/2000/svg" version="1.1" width="100%" height="100%"><defs><lineargradient id="ghsv_'+(g="<%=id%>",r(v))+'" x1="0%" y1="100%" x2="0%" y2="0%"><stop mxs="_zs_galleryaD:c" offset="0%" stop-color="#FF0000" stop-opacity="1"></stop><stop mxs="_zs_galleryaD:d" offset="13%" stop-color="#FF00FF" stop-opacity="1"></stop><stop mxs="_zs_galleryaD:e" offset="25%" stop-color="#8000FF" stop-opacity="1"></stop><stop mxs="_zs_galleryaD:f" offset="38%" stop-color="#0040FF" stop-opacity="1"></stop><stop mxs="_zs_galleryaD:g" offset="50%" stop-color="#00FFFF" stop-opacity="1"></stop><stop mxs="_zs_galleryaD:h" offset="63%" stop-color="#00FF40" stop-opacity="1"></stop><stop mxs="_zs_galleryaD:i" offset="75%" stop-color="#0BED00" stop-opacity="1"></stop><stop mxs="_zs_galleryaD:j" offset="88%" stop-color="#FFFF00" stop-opacity="1"></stop><stop mxs="_zs_galleryaD:k" offset="100%" stop-color="#FF0000" stop-opacity="1"></stop></lineargradient></defs><rect x="0" y="0" width="100%" height="100%" fill="url(#ghsv_'+(g="<%=id%>",r(v))+')"></rect></svg><div class="_zs_gallery_mx-color_index_-slide-indicator" id="si_'+(g="<%=id%>",r(v))+'"></div></div></div>',g="<%if (alpha) {%>",u&&(f+='<div mxa="_zs_galleryaD:e" class="_zs_gallery_mx-color_index_-alpha pr"><div class="_zs_gallery_mx-color_index_-alpha-tracker" id="at_'+(g="<%=id%>",r(v))+'" mx-mousedown="'+e+'@{alpha.drag}()"><div class="_zs_gallery_mx-color_index_-alpha-indicator" id="ai_'+(g="<%=id%>",r(v))+'"></div></div></div>',g="<%}%>"),f+='<div mxv mxa="_zs_galleryaD:f" class="_zs_gallery_mx-color_index_-foot clearfix"><span class="fl _zs_gallery_mx-color_index_-bg-color" id="bc_'+(g="<%=id%>",r(v))+'"></span><input class="fl input _zs_gallery_mx-color_index_-color-value" id="v_'+(g="<%=id%>",r(v))+'" mx-keyup="'+e+'@{input.end}()" mx-paste="'+e+'@{input.end}()" mx-change="'+e+'@{stop}()" mx-focusin="'+e+'@{stop}()" mx-focusout="'+e+'@{stop}()"/>',g="<%if (btns) {%>",b&&(f+='<a mxs="_zs_galleryaD:l" href="javascript:;" class="fr btn btn-brand _zs_gallery_mx-color_index_-submit-btn" mx-click="'+e+'@{enter}()">确定</a>',g="<%}%>"),f+="</div>"}catch(o){var w="render view error:"+(o.message||o);throw w+="\r\n\texpr:",w+=g+"\r\n\tat file:mx-color/index.html"}return f},init:function(o){var e=o.data||{};this["@{color}"]=e.color||"#ffffff",this["@{show.alpha}"]=e.showAlpha+""=="true",this["@{show.btns}"]=e.showBtns+""=="true",this["@{hsv.info}"]={h:0,s:1,v:1}},render:function(){var o=this;o.updater.digest({id:o.id,alpha:o["@{show.alpha}"],btns:o["@{show.btns}"],shortcuts:n}),o["@{setColor}"](o["@{color}"])},"@{setHSV}":function(o,e){var t=this,r=t["@{hsv.info}"];r.h=o.h%360,r.s=o.s,r.v=o.v;var s=l(o.h,o.s,o.v).hex,n=i("#cz_"+t.id),c=n.width(),d=l(o.h,1,1);if(n.css("background",d.hex),t["@{hex.color}"]=s,t["@{sync.color}"](),!e){i("#scs_"+t.id+" li").removeClass(a);var _=i("#si_"+t.id).height()/2;_<0&&(_=0);var p=Math.round(r.h*c/360-_),x=i("#ci_"+t.id).width()/2;i("#si_"+t.id).css({top:p-6}),p=Math.round((1-r.v)*c-x);var h=Math.round(r.s*c-x);i("#ci_"+t.id).css({left:h,top:p})}i("#sc_"+s.substr(1,6)+"_"+t.id).addClass(a)},"@{setColor}":function(o){var e=parseInt(o.substr(1,2),16),t=parseInt(o.substr(3,2),16),r=parseInt(o.substr(5,2),16),i=parseInt(o.substr(7,2),16);isNaN(i)&&(i=255),this["@{hex.alpha}"]=("0"+i.toString(16)).slice(-2);var s=function(o,e,t){var r,i;return o/=255,e/=255,t/=255,{h:(0==(i=(r=Math.max(o,e,t))-Math.min(o,e,t))?null:r==o?(e-t)/i+(e<t?6:0):r==e?(t-o)/i+2:(o-e)/i+4)%6*60,s:0===i?0:i/r,v:r}}(e,t,r);this["@{setHSV}"](s),this["@{show.alpha}"]&&this["@{setAlpha}"](i)},"@{slide.drag}<mousedown>":function(o){var e=this,t=i(o.eventTarget),r=i("#si_"+e.id),s=o,a=i("#cz_"+e.id).width(),n=i("#si_"+e.id).height()/2,l=t.offset(),c=(o.pageY-l.top)/a*360;e["@{setHSV}"]({h:c,s:e["@{hsv.info}"].s,v:e["@{hsv.info}"].v});var d=parseInt(r.css("top"),10);e.dragdrop(o.eventTarget,function(o){var t=o.pageY-s.pageY;(t+=d)<=-n?t=-n:t>=a-n&&(t=a-n),r.css({top:t-6});var i=(t+n)/a*360;e["@{setHSV}"]({h:i,s:e["@{hsv.info}"].s,v:e["@{hsv.info}"].v},!0)},function(){e["@{fire.event}"]()})},"@{color.zone.drag}<mousedown>":function(o){var e=this,t=i("#cz_"+e.id).width(),r=i("#ci_"+e.id).width()/2,s=i(o.eventTarget).offset(),a=o.pageX-s.left,n=o.pageY-s.top,l=a/t,c=(t-n)/t;e["@{setHSV}"]({h:e["@{hsv.info}"].h,s:l,v:c});var d=i("#ci_"+e.id),_=parseInt(d.css("left"),10),p=parseInt(d.css("top"),10),x=o;e.dragdrop(o.eventTarget,function(o){var i=o.pageY-x.pageY,s=o.pageX-x.pageX;(i+=p)<=-r?i=-r:i>=t-r&&(i=t-r),(s+=_)<=-r?s=-r:s>=t-r&&(s=t-r),d.css({top:i,left:s});var a=(s+r)/t,n=(t-(i+r))/t;e["@{setHSV}"]({h:e["@{hsv.info}"].h,s:a,v:n})},function(){e["@{fire.event}"]()})},"@{setAlpha}":function(o){o/=255,o*=i("#at_"+this.id).width(),o-=i("#si_"+this.id).height()/2,i("#ai_"+this.id).css({left:o})},"@{sync.color}":function(){var o=this,e=o["@{hex.color}"];i("#at_"+o.id).css({background:"linear-gradient(to right, "+e+"00 0%,"+e+" 100%)"}),o["@{show.alpha}"]&&(e+=o["@{hex.alpha}"]),i("#bc_"+o.id).css("background",e),i("#v_"+o.id).val(e)},"@{alpha.drag}<mousedown>":function(o){var e=i(o.eventTarget),t=o,r=this,s=i("#ai_"+r.id),a=i("#at_"+r.id).width(),n=i("#si_"+r.id).height()/2,l=e.offset(),c=(o.pageX-l.left)/a*255|0;r["@{hex.alpha}"]=("0"+c.toString(16)).slice(-2),r["@{setAlpha}"](c),r["@{sync.color}"]();var d=parseInt(s.css("left"),10);r.dragdrop(o.eventTarget,function(o){var e=o.pageX-t.pageX;(e+=d)<=-n?e=-n:e>=a-n&&(e=a-n),s.css({left:e});var i=Math.round((e+n)/a*255);r["@{hex.alpha}"]=("0"+i.toString(16)).slice(-2),r["@{sync.color}"]()},function(){r["@{fire.event}"]()})},"@{shortcuts.picked}<click>":function(o){this["@{setColor}"](o.params.color),i(o.eventTarget).addClass(a),this["@{fire.event}"]()},"@{input.end}<keyup,paste>":function(o){var e=this;clearTimeout(e["@{end.delay.timer}"]);var t=i.trim(o.eventTarget.value);e["@{end.delay.timer}"]=setTimeout(e.wrapAsync(function(){7===t.length&&t!=e["@{color}"]&&(e["@{setColor}"](t),e["@{fire.event}"]())}),250)},"@{stop}<change,focusin,focusout>":function(o){o.stopPropagation()},"@{fire.event}":function(o){if(!this["@{show.btns}"]||o){var e=i("#v_"+this.id).val();i("#"+this.id).trigger({type:"change",color:this["@{color}"]=e})}},"@{enter}<click>":function(){this["@{fire.event}"](!0)}})});