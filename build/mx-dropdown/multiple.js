define("mx-dropdown/multiple",["magix","$","../mx-util/monitor","../mx-medusa/util","mx-checkbox/index"],(e,t,a)=>{e("mx-checkbox/index");var r=e("magix"),i=e("$"),l=e("../mx-util/monitor"),n=e("../mx-medusa/util");r.applyStyle("_zs_gallery_mx-dropdown_index_","._zs_gallery_mx-dropdown_index_-dropdown-menu-group {\n  min-width: 600px;\n}\n._zs_gallery_mx-dropdown_index_-dropdown-menu-group ._zs_gallery_mx-dropdown_index_-dropdown-group-item {\n  float: left;\n  width: 25%;\n}\n._zs_gallery_mx-dropdown_index_-dropdown-menu-group ._zs_gallery_mx-dropdown_index_-dropdown-group-wrapper {\n  margin-bottom: 10px;\n}\n._zs_gallery_mx-dropdown_index_-oper-wrapper {\n  padding-top: 10px;\n  padding-right: 10px;\n  padding-left: 18px;\n  padding-right: 18px;\n  line-height: 16px;\n}\n._zs_gallery_mx-dropdown_index_-oper-wrapper ._zs_gallery_mx-dropdown_index_-oper {\n  float: left;\n  padding-right: 20px;\n  color: #999;\n}\n._zs_gallery_mx-dropdown_index_-oper-wrapper ._zs_gallery_mx-dropdown_index_-oper:hover {\n  color: var(--color-brand);\n}\n._zs_gallery_mx-dropdown_index_-oper-wrapper._zs_gallery_mx-dropdown_index_-has-group {\n  padding-left: 12px;\n  padding-right: 12px;\n}\n._zs_gallery_mx-dropdown_index_-dropdown-output ._zs_gallery_mx-dropdown_index_-dropdown-output-link {\n  height: auto;\n}\n._zs_gallery_mx-dropdown_index_-selected-text img {\n  display: none;\n}\n"),a.exports=r.View.extend({tmpl:function(e,t,a,r,i,l,n,o){if(a||(a=e),!i){var s={"&":"amp","<":"lt",">":"gt",'"':"#34","'":"#39","`":"#96"},d=/[&<>"'`]/g,c=function(e){return"&"+s[e]+";"};i=function(e){return""+(null==e?"":e)},r=function(e){return i(e).replace(d,c)}}if(!l){var p={"!":"%21","'":"%27","(":"%28",")":"%29","*":"%2A"},u=function(e){return p[e]},m=/[!')(*]/g;l=function(e){return encodeURIComponent(i(e)).replace(m,u)}}if(!o){var x=/[\\'"]/g;o=function(e){return i(e).replace(x,"\\$&")}}var g,h,f,_="",v=e.viewId,y=e.expand,w=e.selectedText,k=e.placementClass,b=e.over,z=e.menuStyles,$=e.rList,I=e.searchbox,T=e.text,j=e.keyword,A=e.max,E=e.imme,C=e.needAll,q=e.hasGroups,G=e.spm,M=e.allHide,L=e.height,S=e.groups,O=e.errMsg;try{if(_+='<div id="toggle_',f=1,h="=viewId",_+=(g="<%=viewId%>",r(v)+'" class="mx-trigger '),f=1,h="if expand",g="<%if (expand) {%>",y&&(_+=" mx-trigger-open ",f=1,h="/if",g="<%}%>"),_+='"><span mxa="_zs_gallerybk:_" class="mx-trigger-label">',f=2,h="!selectedText",_+=(g="<%!selectedText%>",i(w)+'</span><span mxs="_zs_gallerybk:_" class="mc-iconfont mx-trigger-arrow">&#xe692;</span></div><div mxv id="menu_'),f=5,h="=viewId",_+=(g="<%=viewId%>",r(v)+'" class="mx-output '),f=5,h="=placementClass",_+=(g="<%=placementClass%>",r(k)+" "),f=5,h="if expand",g="<%if (expand) {%>",y&&(_+=" mx-output-open ",f=5,h="/if",g="<%}%>"),_+=" ",f=5,h="if over",g="<%if (over) {%>",b&&(_+=" _zs_gallery_mx-dropdown_index_-dropdown-menu-group ",f=5,h="/if",g="<%}%>"),_+='" ',f=6,h="if menuStyles",g="<%if (menuStyles) {%>",z&&(_+=' style="',f=6,h="=menuStyles",_+=(g="<%=menuStyles%>",r(z)+'" '),f=6,h="/if",g="<%}%>"),_+=">",f=7,h="if rList",g="<%if (rList) {%>",$){if(_+=" ",f=8,h="if searchbox",g="<%if (searchbox) {%>",I&&(_+='<div mxv mxa="_zs_gallerybk:a" class="mx-output-search"><div mxv class="search-box" style="',f=10,h="if over",g="<%if (over) {%>",b?(_+=" width: 200px; ",f=10,h="else",g="<%}        else {%>"):(_+=" width: 100%; ",f=10,h="/if",g="<%}%>"),_+='"><i mxs="_zs_gallerybk:a" class="mc-iconfont search-icon">&#xe651;</i><input class="input search-input" placeholder="',f=13,h="=text.search",_+=(g="<%=text.search%>",r(T.search)+'" mx-keyup="'+t+'@{search}()" mx-paste="'+t+'@{search}()" mx-change="'+t+'@{stop}()" mx-focusin="'+t+'@{stop}()" mx-focusout="'+t+'@{stop}()" value="'),f=19,h="=keyword",_+=(g="<%=keyword%>",r(j)+'"/></div>'),f=21,h="if (max > 0 && over)",g="<%if (max > 0 && over) {%>",A>0&&b&&(_+='<span mxa="_zs_gallerybk:b" class="ml10"><span mxs="_zs_gallerybk:b" class="color-9">已选：</span><span mxa="_zs_gallerybk:c" class="font-tahoma bold">',f=24,h="=imme.length",_+=(g="<%=imme.length%>",r(E.length)+" / "),f=24,h="=max",_+=(g="<%=max%>",r(A)+"</span></span>"),f=26,h="/if",g="<%}%>"),_+="</div>",f=28,h="/if",g="<%}%>"),_+=" ",f=29,h="if !needAll || (max > 0 && !over)",g="<%if (!needAll || (max > 0 && !over)) {%>",(!C||A>0&&!b)&&(_+='<div class="_zs_gallery_mx-dropdown_index_-oper-wrapper ',f=30,h="if hasGroups",g="<%if (hasGroups) {%>",q&&(_+=" _zs_gallery_mx-dropdown_index_-has-group ",f=30,h="/if",g="<%}%>"),_+=' clearfix">',f=31,h="if !needAll",g="<%if (!needAll) {%>",C||(_+='<a class="_zs_gallery_mx-dropdown_index_-oper" href="javascript:;" mx-click="'+t+'@{checkAll}({checked:true})" data-spm-click="',f=32,h="=spm",_+=(g="<%=spm%>",r(G)+'a">'),f=32,h="=text.select",_+=(g="<%=text.select%>",r(T.select)+'</a><a class="_zs_gallery_mx-dropdown_index_-oper" href="javascript:;" mx-click="'+t+'@{checkAll}({checked:false})" data-spm-click="'),f=33,h="=spm",_+=(g="<%=spm%>",r(G)+'ua">'),f=33,h="=text.unselect",_+=(g="<%=text.unselect%>",r(T.unselect)+"</a>"),f=34,h="/if",g="<%}%>"),_+=" ",f=36,h="if (max > 0 && !over)",g="<%if (max > 0 && !over) {%>",A>0&&!b&&(_+="<span ",f=37,h="if !needAll",g="<%if (!needAll) {%>",C||(_+=' class="fr" ',f=37,h="/if",g="<%}%>"),_+='><span mxs="_zs_gallerybk:b" class="color-9">已选：</span><span mxa="_zs_gallerybk:d" class="font-tahoma bold">',f=39,h="=imme.length",_+=(g="<%=imme.length%>",r(E.length)+" / "),f=39,h="=max",_+=(g="<%=max%>",r(A)+"</span></span>"),f=41,h="/if",g="<%}%>"),_+="</div>",f=43,h="/if",g="<%}%>"),_+=" ",f=44,h="if !allHide",g="<%if (!allHide) {%>",M)_+='<div mxa="_zs_gallerybk:h" class="text-center color-9 pt20 pb20">',f=86,h="=text.empty",_+=(g="<%=text.empty%>",r(T.empty)+"</div>"),f=87,h="/if",g="<%}%>";else{_+='<div mxv class="mx-output-list" id="list_',f=45,h="=viewId",_+=(g="<%=viewId%>",r(v)+'" style="max-height:'),f=45,h="=height",_+=(g="<%=height%>",r(L)+'px;">'),f=46,h="each groups as group groupIndex",g="<%for (var groupIndex = 0, $art_cpaixwfl$art_c = groups.length; groupIndex < $art_cpaixwfl$art_c; groupIndex++) {            var group = groups[groupIndex]%>";for(var H=0,P=S.length;H<P;H++){var K=S[H];_+=" ",f=47,h="if (group.text && !group.hide)",g="<%if (group.text && !group.hide) {%>",K.text&&!K.hide&&(_+=" ",f=48,h="if group.all",g="<%if (group.all) {%>",K.all?(_+='<div mxa="_zs_gallerybk:e" class="clearfix"><div title="',f=50,h="=group.text",_+=(g="<%=group.text%>",r(K.text)+'" class="mx-output-item _zs_gallery_mx-dropdown_index_-dropdown-group-item"><label mxa="_zs_gallerybk:f" class="mx-output-link"><span mx-focusout="'+t+'@{stop}()" mx-change="'+t+"@{checkGroup}({groupIndex:'"),f=57,h="=groupIndex",_+=(g="<%=$eq(groupIndex)%>",r(o(H))+'\'})" data-spm-click="'),f=58,h="=spm",_+=(g="<%=spm%>",r(G)+'" mx-view="mx-checkbox/index?disabled='),f=53,h="=((max > 0) && (imme.length >= max))",_+=(g="<%!$eu(((max > 0) && (imme.length >= max)))%>",l(A>0&&E.length>=A)+"&indeterminate="),f=54,h="=(group.type==2)",_+=(g="<%!$eu((group.type == 2))%>",l(2==K.type)+"&checked="),f=55,h="=(group.type==3)",_+=(g="<%!$eu((group.type == 3))%>",l(3==K.type)+'"></span>'),f=58,h="!group.text",_+=(g="<%!group.text%>",i(K.text)+"</label></div></div>"),f=62,h="else",g="<%}                else {%>"):(_+='<div class="mx-output-header" title="',f=63,h="=group.text",_+=(g="<%=group.text%>",r(K.text)+'">'),f=63,h="!group.text",_+=(g="<%!group.text%>",i(K.text)+"</div>"),f=64,h="/if",g="<%}%>"),_+=" ",f=65,h="/if",g="<%}%>"),_+='<div mxv mxa="_zs_gallerybk:g" class="clearfix _zs_gallery_mx-dropdown_index_-dropdown-group-wrapper">',f=67,h="each group.list as item",g="<%for (var $art_isdlpoftqz$art_i = 0, $art_objyqmytdcjk$art_obj = group.list, $art_ckpsffsth$art_c = $art_objyqmytdcjk$art_obj.length; $art_isdlpoftqz$art_i < $art_ckpsffsth$art_c; $art_isdlpoftqz$art_i++) {                var item = $art_objyqmytdcjk$art_obj[$art_isdlpoftqz$art_i]%>";for(var J=0,N=K.list,R=N.length;J<R;J++){var U=N[J];_+=" ",f=68,h="if !item.hide",g="<%if (!item.hide) {%>",U.hide||(_+='<div mxv class="mx-output-item _zs_gallery_mx-dropdown_index_-dropdown-group-item" title="',f=69,h="=item.text",_+=(g="<%=item.text%>",r(U.text)+'"><label mxv for="'),f=70,h="=viewId",_+=(g="<%=viewId%>",r(v)+"_"),f=70,h="=item.value",_+=(g="<%=item.value%>",r(U.value)+'" class="mx-output-link"><input type="checkbox" class="checkbox" '),f=72,h="if !item.checked && (max > 0) && (imme.length >= max)",g="<%if (!item.checked && (max > 0) && (imme.length >= max)) {%>",!U.checked&&A>0&&E.length>=A&&(_+=' disabled="true" ',f=72,h="/if",g="<%}%>"),_+=" ",f=73,h="if item.checked",g="<%if (item.checked) {%>",U.checked&&(_+=' checked="true" ',f=73,h="/if",g="<%}%>"),_+=' id="',f=74,h="=viewId",_+=(g="<%=viewId%>",r(v)+"_"),f=74,h="=item.value",_+=(g="<%=item.value%>",r(U.value)+'" mx-focusout="'+t+'@{stop}()" mx-change="'+t+"@{checkItem}({groupIndex:'"),f=76,h="=groupIndex",_+=(g="<%=$eq(groupIndex)%>",r(o(H))+"',value:'"),f=76,h="=item.value",_+=(g="<%=$eq(item.value)%>",r(o(U.value))+'\'})" data-spm-click="'),f=77,h="=spm",_+=(g="<%=spm%>",r(G)+'"/>'),f=77,h="!item.text",_+=(g="<%!item.text%>",i(U.text)+"</label></div>"),f=80,h="/if",g="<%}%>"),_+=" ",f=81,h="/each",g="<%}%>"}_+="</div>",f=83,h="/each",g="<%}%>"}_+="</div>",f=85,h="else",g="<%}    else {%>"}_+='<div mxa="_zs_gallerybk:i" class="mx-output-footer"><div><a mxa="_zs_gallerybk:j" href="javascript:;" class="btn btn-small btn-brand mr10" mx-click="'+t+'@{submit}({enter:true})">',f=90,h="=text.submit",_+=(g="<%=text.submit%>",r(T.submit)+'</a><a mxa="_zs_gallerybk:k" href="javascript:;" class="btn btn-small" mx-click="'+t+'@{hide}()">'),f=91,h="=text.cancel",_+=(g="<%=text.cancel%>",r(T.cancel)+"</a></div>"),f=93,h="if errMsg",g="<%if (errMsg) {%>",O&&(_+='<div mxa="_zs_gallerybk:l" class="color-red mt10"><i mxs="_zs_gallerybk:c" class="mc-iconfont displacement-2">&#xe6ad;</i>',f=96,h="!errMsg",_+=(g="<%!errMsg%>",i(O)+"</div>"),f=98,h="/if",g="<%}%>"),_+="</div>",f=100,h="/if",g="<%}%>"}_+="</div>"}catch(e){var V="render view error:"+(e.message||e);throw h&&(V+="\r\n\tsrc art:{{"+h+"}}\r\n\tat line:"+f),V+="\r\n\t"+(h?"translate to:":"expr:"),V+=g+"\r\n\tat file:mx-dropdown/multiple.html"}return _},init:function(e){var t=this;l["@{setup}"](),t.on("destroy",function(){l["@{remove}"](t),l["@{teardown}"]()}),t.updater.set({viewId:t.id});var a=i("#"+t.id);t["@{owner.node}"]=a,t["@{ui.disabled}"]=e.disabled+""=="true"||i("#"+t.id)[0].hasAttribute("mx-disabled");var o=e.placement||"bottom";t["@{ui.placement}"]="mx-output-"+o,t["@{trigger.type}"]=e.triggerType||"click";var s=e.emptyText||n.choose,d=e.name||"",c=e.needAll+""=="false",p=e.searchbox+""=="true",u=e.textKey||"text",m=e.valueKey||"value",x=!1,g=[];if(e.list){try{list=JSON.parse(e.list)}catch(t){list=e.list||[]}"object"==typeof list[0]?list=list.map(function(e){return{text:e[u],value:e[m]}}):list=list.map(function(e){return{text:e,value:e}}),g=[{list:list}]}else{var h=t["@{owner.node}"].children();if("true"==i(h[0]).attr("group"))x=!0,h.each(function(e,t){if("true"==(t=i(t)).attr("group"))g.push({all:"true"==t.attr("all"),text:t.text(),value:r.guid(),list:[]});else{var a=g.length;g[a-1].list.push({text:t.text(),value:t.attr("value")})}});else{var f=[];h.each(function(e,t){t=i(t),f.push({text:t.text(),value:t.attr("value")})}),g=[{list:f}]}}var _,v=0,y={};e.selected?i.isArray(e.selected)?(t["@{bak.type}"]="array",_=e.selected.map(function(e){return""+e})):_=(e.selected+"").split(","):_=[],g.forEach(function(e){var t=[];e.list.forEach(function(e){v++,e.checked=_.indexOf(e.value+"")>-1,y[e.value]=e,e.checked&&t.push(e.value)}),e.type=t.length>0?t.length==e.list.length?3:2:1});var w=+e.min||0,k=+e.max||0;k>0&&w>k&&(w=k),t.updater.set({submitChecker:e.submitChecker,hasGroups:x,viewId:t.id,expand:!1,emptyText:s,name:d,needAll:c,searchbox:p,map:y,selected:_,imme:_,min:w,max:k,continuous:e.continuous+""=="true",over:v>20,groups:g,height:e.height||400,spm:t["@{owner.node}"].attr("data-spm-click")||"",placementClass:t["@{ui.placement}"],text:{search:n["dropdown.search"],select:n["select.all"],unselect:n["unselect.all"],submit:n["dialog.submit"],cancel:n["dialog.cancel"],empty:n["empty.text"]}})},render:function(){var e=this,t=e.updater.get("selected");e.updater.digest({selectedText:e["@{getText}"](t)}),e["@{val}"]();var a=e["@{trigger.type}"],r=i("#toggle_"+e.id),l=i("#menu_"+e.id);switch(a){case"click":r.on("click",function(){e.updater.get("expand")?e["@{hide}"]():e["@{ui.disabled}"]||e["@{show}"]()});break;case"hover":r.hover(function(){clearTimeout(e["@{dealy.hide.timer}"]),e["@{show}"]()},function(){e["@{delay.hide}"]()}),l.hover(function(){clearTimeout(e["@{dealy.hide.timer}"])},function(){e["@{delay.hide}"]()})}},"@{inside}":function(e){return r.inside(e,this.id)},"@{delay.hide}":function(){var e=this;clearTimeout(e["@{dealy.hide.timer}"]),e["@{dealy.hide.timer}"]=setTimeout(e.wrapAsync(function(){e["@{hide}"]()}),250)},"@{val}":function(){var e=this.updater.get("selected");"array"==this["@{bak.type}"]?this["@{owner.node}"].val(e):this["@{owner.node}"].val(e.join(","))},"@{hide}":function(){var e=this,t=e.updater.get();if(t.expand){e.updater.digest({expand:!1}),e["@{owner.node}"].trigger("focusout"),l["@{remove}"](e);var a=t.selected,r=t.groups;r.forEach(function(e){var t=[];e.list.forEach(function(e){e.checked=a.indexOf(e.value+"")>-1,e.checked&&t.push(e.value)}),e.type=t.length>0?t.length==e.list.length?3:2:1}),e.updater.digest({groups:r,selected:a,imme:a,selectedText:e["@{getText}"](a)}),e["@{val}"]()}},"@{show}":function(){var e=this,t=e.updater.get();if(!t.expand){var a={expand:!0};t.rList||(a.rList=!0);var r=i("#menu_"+e.id),n=i(window).width(),o=e["@{owner.node}"].offset(),s=r.outerWidth(),d=void 0;o.left+s>n&&(d=Math.min(o.left+s-n,o.left)),d>0&&(a.menuStyles="left:"+(0-d)+"px"),e.updater.digest(a),e["@{owner.node}"].trigger("focusin"),l["@{add}"](e)}},"@{getText}":function(e){var t=this.updater.get(),a=t.emptyText;if(0==e.length)return a;for(var r=t.map,i=[],l=0,o=e;l<o.length;l++){var s=r[o[l]]||{};i.push(s.text)}var d=t.name;return i.length==Object.keys(r).length?d?n["dropdown.all.custom"]+d:n["dropdown.all.default"]:i.join(",")},"@{fn.search}":function(e,t){var a,r=this.updater.get().groups;if(e){a=!0;var i=(e+"").toLocaleLowerCase();r.forEach(function(e){var t=!0;e.list.forEach(function(e){var a=(e.text+"").toLocaleLowerCase();e.hide=a.indexOf(i)<0,t=t&&e.hide}),e.hide=t,a=a&&t})}else a=!1,r.forEach(function(e){e.hide=!1,e.list.forEach(function(e){e.hide=!1})});t({groups:r,allHide:a})},"@{search}<keyup,paste>":function(e){var t=this;clearTimeout(t["@{search.delay.timer}"]);var a=i.trim(e.eventTarget.value);t.updater.set({keyword:a}),t["@{search.delay.timer}"]=setTimeout(t.wrapAsync(function(){a!=t["@{last.value}"]&&t["@{fn.search}"](t["@{last.value}"]=a,function(e){t.updater.digest(e)})}),250)},"@{checkItem}<change>":function(e){e.stopPropagation();var t=e.params.value,a=e.params.groupIndex,r=e.target.checked;this["@{checkGroup}"](a,t,r)},"@{checkAll}<click>":function(e){var t=e.params.checked;this["@{checkGroup}"]("all","all",t)},"@{checkGroup}<change>":function(e){e.stopPropagation();var t=e.params.groupIndex,a=e.target.checked;this["@{checkGroup}"](t,"all",a)},"@{checkGroup}":function(e,t,a){var r=this,i=r.updater.get().groups,l=(i=r.updater.get("groups"),r.updater.get("max")),n=r.updater.get("imme"),o=0;l>0&&(o=l-n.length);var s=[];i.forEach(function(r,i){var n=[];r.list.forEach(function(r){"all"!==e&&e!=i||"all"!=t&&t!=r.value||(a?l>0?o>0&&!r.checked&&(r.checked=!0,o-=1):r.checked=!0:r.checked=!1),r.checked&&n.push(r.value)}),r.type=n.length>0?n.length==r.list.length?3:2:1,s=s.concat(n)}),r.updater.digest({groups:i,imme:s})},"@{stop}<change,focusin,focusout>":function(e){e.stopPropagation()},"@{submit}<click>":function(e){var t=this,a=t.updater.get(),r=a.groups,l=[],n=[],o=0;r.forEach(function(e){e.list.forEach(function(e){if(o+=1,e.checked){l.push(e.value+"");var t=n.length;0==t?n.push(o):n[t-1]+1==o?n[t-1]=o:n.push(o)}})});var s=function(){var e=t.updater.get("min");if(e>0&&l.length<e)t.updater.digest({errMsg:"请至少选择"+e+"个"});else{if(t.updater.get("continuous")&&l.length>0){var r=t.updater.get("name")||"数据";if(n.length>1)return void t.updater.digest({errMsg:"请选择连续的"+r})}t.updater.set({errMsg:"",selected:l}),t["@{hide}"]();var o=a.map,s=l.map(function(e){return o[e].text});t["@{owner.node}"].trigger({type:"change",texts:s,values:l,selected:i("#"+t.id).val()})}};a.submitChecker?a.submitChecker(l).then(function(e){e?t.updater.digest({errMsg:e}):s()}):s()},"@{hide}<click>":function(e){this["@{hide}"]()}})});