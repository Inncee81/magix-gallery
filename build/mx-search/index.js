<<<<<<< HEAD
define("mx-search/index",["magix","$","../mx-util/monitor"],(e,t,a)=>{var r=e("magix"),s=e("$");r.applyStyle("_zs_gallery_mx-search_index_","._zs_gallery_mx-search_index_-search-box-right,\n._zs_gallery_mx-search_index_-search-box-left {\n  position: relative;\n  height: 32px;\n}\n._zs_gallery_mx-search_index_-search-box-right ._zs_gallery_mx-search_index_-search-menu {\n  left: auto;\n  right: 0;\n}\n._zs_gallery_mx-search_index_-search-box-left ._zs_gallery_mx-search_index_-search-menu {\n  left: 0;\n  right: auto;\n}\n");var i=e("../mx-util/monitor");a.exports=r.View.extend({tmpl:function(e,t,a,r,s,i,h,l){if(a||(a=e),!s){var c={"&":"amp","<":"lt",">":"gt",'"':"#34","'":"#39","`":"#96"},n=/[&<>"'`]/g,o=function(e){return"&"+c[e]+";"};s=function(e){return""+(null==e?"":e)},r=function(e){return s(e).replace(n,o)}}if(!i){var u={"!":"%21","'":"%27","(":"%28",")":"%29","*":"%2A"},d=function(e){return u[e]},f=/[!')(*]/g;i=function(e){return encodeURIComponent(s(e)).replace(f,d)}}if(!l){var p=/[\\'"]/g;l=function(e){return s(e).replace(p,"\\$&")}}h||(h=function(e,t,a,r){for(r=e[y];--r;)if(e[a=y+r]===t)return a;return e[a=y+e[y]++]=t,a});var m,x,_,y="",g="",v=e.align,k=e.placeholder,w=e.searchValue,$=e.list,V=e.show,b=e.searchKey;try{g+='<div mxv class="search-box ',_=1,x="if (align=='right')",m="<%if (align == 'right') {%>","right"==v?(g+=" _zs_gallery_mx-search_index_-search-box-right ",_=1,x="else",m="<%}else {%>"):(g+=" _zs_gallery_mx-search_index_-search-box-left ",_=1,x="/if",m="<%}%>"),g+='"><i mxs="_zs_gallerydY:_" class="mc-iconfont search-icon">&#xe651;</i><input class="input search-input" placeholder="',_=3,x="=placeholder",g+=(m="<%=placeholder%>",r(k)+'" autocomplete="off" value="'),_=5,x="=searchValue",g+=(m="<%=searchValue%>",r(w)+'" mx-keyup="'+t+'@{search}()" mx-paste="'+t+'@{search}()" mx-focusin="'+t+'@{search}()" mx-focusout="'+t+'@{stop}()" mx-change="'+t+'@{stop}()"/><div class="mx-output mx-output-bottom '),_=12,x="if ((list.length > 1) && searchValue && show)",m="<%if ((list.length > 1) && searchValue && show) {%>",$.length>1&&w&&V&&(g+=" mx-output-open ",_=12,x="/if",m="<%}%>"),g+=' _zs_gallery_mx-search_index_-search-menu"><ul mxa="_zs_gallerydY:_" class="mx-output-list">',_=14,x="each list as item",m="<%for (var $art_itxeyws$art_i = 0, $art_cfosgrvsuf$art_c = list.length; $art_itxeyws$art_i < $art_cfosgrvsuf$art_c; $art_itxeyws$art_i++) {    var item = list[$art_itxeyws$art_i]%>";for(var z=0,K=$.length;z<K;z++){var C=$[z];g+='<li mxa="_zs_gallerydY:a" class="mx-output-item"><span class="mx-output-link ',_=16,x="if (searchKey == item.value)",m="<%if (searchKey == item.value) {%>",b==C.value&&(g+=" mx-output-link-active ",_=16,x="/if",m="<%}%>"),g+='" mx-click="'+t+"@{select}({item:'",_=17,x="@item",g+=(m="<%@item%>",h(a,C)+"'})\">"),_=18,x="=item.prefix",g+=(m="<%=item.prefix%>",r(C.prefix)+""),_=18,x="=searchValue",g+=(m="<%=searchValue%>",r(w)+""),_=18,x="=item.suffix",g+=(m="<%=item.suffix%>",r(C.suffix)+"</span></li>"),_=21,x="/each",m="<%}%>"}g+="</ul></div></div>"}catch(e){var T="render view error:"+(e.message||e);throw x&&(T+="\r\n\tsrc art:{{"+x+"}}\r\n\tat line:"+_),T+="\r\n\t"+(x?"translate to:":"expr:"),T+=m+"\r\n\tat file:mx-search/index.html"}return g},init:function(e){var t=this;t.updater.snapshot(),t.assign(e),i["@{setup}"](),t.on("destroy",function(){i["@{remove}"](t),i["@{teardown}"](),t["@{search.delay.timer}"]&&clearTimeout(t["@{search.delay.timer}"])})},assign:function(e){var t=this.updater.altered();this["@{search.key}"]=e.searchKey||"",this["@{search.key.bak}"]=this["@{search.key}"],this["@{search.value}"]=e.searchValue||"",this["@{dis.placeholder}"]=e.placeholder||"",this["@{dis.align}"]=e.align||"left";var a=[];if(e.list){var r=e.listText||"text",i=e.listValue||"value";try{a=new Function("return "+e.list)()}catch(t){a=e.list}if(a=a.map(function(e){var t=(e.tmpl||"搜索含有 “${content}” 的"+e[r]).split("${content}");return{prefix:t[0],suffix:t[1],text:e[r],value:e[i]}}),!this["@{dis.placeholder}"]){var h=a.map(function(e){return e.text});this["@{dis.placeholder}"]=s.unique(h).join("/")}}else this["@{dis.placeholder}"]||(this["@{dis.placeholder}"]="搜索");return this["@{data.list}"]=a,this["@{owner.node}"]=s("#"+this.id),this.updater.set({viewId:this.id,list:this["@{data.list}"],searchValue:this["@{search.value}"],searchKey:this["@{search.key}"],placeholder:this["@{dis.placeholder}"],align:this["@{dis.align}"]}),t||(t=this.updater.altered()),!!t&&(this.updater.snapshot(),!0)},render:function(){this.updater.digest()},"@{search}<focusin,keyup,paste>":function(e){e.stopPropagation();var t=this;t["@{search.delay.timer}"]&&clearTimeout(t["@{search.delay.timer}"]);var a=t.updater.get("show"),r=t["@{data.list}"];if(40==e.keyCode||38==e.keyCode){if(a){for(var i=-1,h=t["@{search.key}"],l=0;l<r.length;l++)if(r[l].value==h){i=l;break}40==e.keyCode&&(i+=1)>=r.length&&(i=0),38==e.keyCode&&(i-=1)<0&&(i=r.length-1),t.updater.digest({searchKey:t["@{search.key}"]=r[i].value})}}else 13==e.keyCode?(!t["@{search.key}"]&&r&&r.length>0&&(t["@{search.key}"]=r[0].value),t["@{search.key.bak}"]=t["@{search.key}"],t["@{search.value}"]=s.trim(e.eventTarget.value),t["@{hide}"](),t["@{fire}"]()):t["@{search.delay.timer}"]=setTimeout(t.wrapAsync(function(){t["@{search.value}"]=s.trim(e.eventTarget.value),t["@{show}"]()}),250)},"@{hide}":function(){this["@{search.key}"]!=this["@{search.key.bak}"]&&(this["@{search.key}"]=this["@{search.key.bak}"]),this.updater.digest({searchKey:this["@{search.key}"],searchValue:this["@{search.value}"],show:!1}),i["@{remove}"](this)},"@{show}":function(){this.updater.digest({searchKey:this["@{search.key}"],searchValue:this["@{search.value}"],show:!0}),i["@{add}"](this)},"@{inside}":function(e){return r.inside(e,this.id)},"@{stop}<change,focusout>":function(e){e.stopPropagation()},"@{select}<click>":function(e){e.stopPropagation();var t=e.params.item;this.updater.digest({searchKey:this["@{search.key}"]=this["@{search.key.bak}"]=t.value,show:!1}),this["@{fire}"]()},"@{fire}":function(){var e=this["@{search.value}"];this["@{owner.node}"].trigger({type:"change",searchKey:this["@{search.key}"],searchValue:e,selected:e}),this["@{owner.node}"].trigger({type:"search",searchKey:this["@{search.key}"],searchValue:e})}})});
=======
define("mx-search/index",["magix","$","../mx-util/monitor"],(e,t,a)=>{var r=e("magix"),i=e("$");r.applyStyle("_zs_gallery_mx-search_index_","._zs_gallery_mx-search_index_-search-box-right,\n._zs_gallery_mx-search_index_-search-box-left {\n  position: relative;\n  height: 32px;\n}\n._zs_gallery_mx-search_index_-search-box-right ._zs_gallery_mx-search_index_-search-menu {\n  left: auto;\n  right: 0;\n}\n._zs_gallery_mx-search_index_-search-box-left ._zs_gallery_mx-search_index_-search-menu {\n  left: 0;\n  right: auto;\n}\n");var s=e("../mx-util/monitor");a.exports=r.View.extend({tmpl:function(e,t,a,r,i,s,h,l){if(a||(a=e),!i){var c={"&":"amp","<":"lt",">":"gt",'"':"#34","'":"#39","`":"#96"},n=/[&<>"'`]/g,u=function(e){return"&"+c[e]+";"};i=function(e){return""+(null==e?"":e)},r=function(e){return i(e).replace(n,u)}}if(!s){var o={"!":"%21","'":"%27","(":"%28",")":"%29","*":"%2A"},d=function(e){return o[e]},p=/[!')(*]/g;s=function(e){return encodeURIComponent(i(e)).replace(p,d)}}if(!l){var m=/[\\'"]/g;l=function(e){return i(e).replace(m,"\\$&")}}h||(h=function(e,t,a,r){for(r=e[y];--r;)if(e[a=y+r]===t)return a;return e[a=y+e[y]++]=t,a});var f,_,x,y="",g="",v=e.align,k=e.placeholder,w=e.searchValue,$=e.list,V=e.show,b=e.searchKey;try{g+='<div mxv class="search-box ',x=1,_="if (align=='right')",f="<%if (align == 'right') {%>","right"==v?(g+=" _zs_gallery_mx-search_index_-search-box-right ",x=1,_="else",f="<%}else {%>"):(g+=" _zs_gallery_mx-search_index_-search-box-left ",x=1,_="/if",f="<%}%>"),g+='"><i mxs="_zs_gallerydY:_" class="mc-iconfont search-icon">&#xe651;</i><input class="input search-input" placeholder="',x=3,_="=placeholder",g+=(f="<%=placeholder%>",r(k)+'" autocomplete="off" value="'),x=5,_="=searchValue",g+=(f="<%=searchValue%>",r(w)+'" mx-keyup="'+t+'@{search}()" mx-paste="'+t+'@{search}()" mx-focusin="'+t+'@{search}()" mx-focusout="'+t+'@{stop}()" mx-change="'+t+'@{stop}()"/><div class="mx-output mx-output-bottom '),x=12,_="if ((list.length > 1) && searchValue && show)",f="<%if ((list.length > 1) && searchValue && show) {%>",$.length>1&&w&&V&&(g+=" mx-output-open ",x=12,_="/if",f="<%}%>"),g+=' _zs_gallery_mx-search_index_-search-menu"><ul mxa="_zs_gallerydY:_" class="mx-output-list">',x=14,_="each list as item",f="<%for (var $art_ilykidiw$art_i = 0, $art_csaucrqu$art_c = list.length; $art_ilykidiw$art_i < $art_csaucrqu$art_c; $art_ilykidiw$art_i++) {    var item = list[$art_ilykidiw$art_i]%>";for(var z=0,K=$.length;z<K;z++){var C=$[z];g+='<li mxa="_zs_gallerydY:a" class="mx-output-item"><span class="mx-output-link ',x=16,_="if (searchKey == item.value)",f="<%if (searchKey == item.value) {%>",b==C.value&&(g+=" mx-output-link-active ",x=16,_="/if",f="<%}%>"),g+='" mx-click="'+t+"@{select}({item:'",x=17,_="@item",g+=(f="<%@item%>",h(a,C)+"'})\">"),x=18,_="=item.prefix",g+=(f="<%=item.prefix%>",r(C.prefix)+""),x=18,_="=searchValue",g+=(f="<%=searchValue%>",r(w)+""),x=18,_="=item.suffix",g+=(f="<%=item.suffix%>",r(C.suffix)+"</span></li>"),x=21,_="/each",f="<%}%>"}g+="</ul></div></div>"}catch(e){var T="render view error:"+(e.message||e);throw _&&(T+="\r\n\tsrc art:{{"+_+"}}\r\n\tat line:"+x),T+="\r\n\t"+(_?"translate to:":"expr:"),T+=f+"\r\n\tat file:mx-search/index.html"}return g},init:function(e){var t=this;t.updater.snapshot(),t.assign(e),s["@{setup}"](),t.on("destroy",function(){s["@{remove}"](t),s["@{teardown}"](),t["@{search.delay.timer}"]&&clearTimeout(t["@{search.delay.timer}"])})},assign:function(e){var t=this.updater.altered();this["@{search.key}"]=e.searchKey||"",this["@{search.key.bak}"]=this["@{search.key}"],this["@{search.value}"]=e.searchValue||"",this["@{dis.placeholder}"]=e.placeholder||"",this["@{dis.align}"]=e.align||"left";var a=[];if(e.list){var r=e.listText||"text",s=e.listValue||"value";try{a=new Function("return "+e.list)()}catch(t){a=e.list}if(a=a.map(function(e){var t=(e.tmpl||"搜索含有 “${content}” 的"+e[r]).split("${content}");return{prefix:t[0],suffix:t[1],text:e[r],value:e[s]}}),!this["@{dis.placeholder}"]){var h=a.map(function(e){return e.text});this["@{dis.placeholder}"]=i.unique(h).join("/")}}else this["@{dis.placeholder}"]||(this["@{dis.placeholder}"]="搜索");return this["@{data.list}"]=a,this["@{owner.node}"]=i("#"+this.id),this.updater.set({viewId:this.id,list:this["@{data.list}"],searchValue:this["@{search.value}"],searchKey:this["@{search.key}"],placeholder:this["@{dis.placeholder}"],align:this["@{dis.align}"]}),t||(t=this.updater.altered()),!!t&&(this.updater.snapshot(),!0)},render:function(){this.updater.digest()},"@{search}<focusin,keyup,paste>":function(e){e.stopPropagation();var t=this;t["@{search.delay.timer}"]&&clearTimeout(t["@{search.delay.timer}"]);var a=t.updater.get("show"),r=t["@{data.list}"];if(40==e.keyCode||38==e.keyCode){if(a){for(var s=-1,h=t["@{search.key}"],l=0;l<r.length;l++)if(r[l].value==h){s=l;break}40==e.keyCode&&(s+=1)>=r.length&&(s=0),38==e.keyCode&&(s-=1)<0&&(s=r.length-1),t.updater.digest({searchKey:t["@{search.key}"]=r[s].value})}}else 13==e.keyCode?(!t["@{search.key}"]&&r&&r.length>0&&(t["@{search.key}"]=r[0].value),t["@{search.key.bak}"]=t["@{search.key}"],t["@{search.value}"]=i.trim(e.eventTarget.value),t["@{hide}"](),t["@{fire}"]()):t["@{search.delay.timer}"]=setTimeout(t.wrapAsync(function(){t["@{search.value}"]=i.trim(e.eventTarget.value),t["@{show}"]()}),250)},"@{hide}":function(){this["@{search.key}"]!=this["@{search.key.bak}"]&&(this["@{search.key}"]=this["@{search.key.bak}"]),this.updater.digest({searchKey:this["@{search.key}"],searchValue:this["@{search.value}"],show:!1}),s["@{remove}"](this)},"@{show}":function(){this.updater.digest({searchKey:this["@{search.key}"],searchValue:this["@{search.value}"],show:!0}),s["@{add}"](this)},"@{inside}":function(e){return r.inside(e,this.id)},"@{stop}<change,focusout>":function(e){e.stopPropagation()},"@{select}<click>":function(e){e.stopPropagation();var t=e.params.item;this.updater.digest({searchKey:this["@{search.key}"]=this["@{search.key.bak}"]=t.value,show:!1}),this["@{fire}"]()},"@{fire}":function(){var e=this["@{search.value}"];this["@{owner.node}"].trigger({type:"change",searchKey:this["@{search.key}"],searchValue:e,selected:e}),this["@{owner.node}"].trigger({type:"search",searchKey:this["@{search.key}"],searchValue:e})}})});
>>>>>>> f4da9c6137ebb53744d694c722dda9b9dcb28ad8
