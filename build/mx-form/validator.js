define("mx-form/validator",["$","magix","mx-form/rule","./util"],(e,r,t)=>{var o=e("$"),n=e("magix"),a=e("mx-form/rule"),i=e("./util");n.applyStyle("_zs_gallery_mx-form_index_","html ._zs_gallery_mx-form_index_-error,\nhtml ._zs_gallery_mx-form_index_-error:hover,\nhtml ._zs_gallery_mx-form_index_-error:focus {\n  border-color: var(--color-red);\n}\n._zs_gallery_mx-form_index_-error-msg {\n  display: none;\n  position: absolute;\n  white-space: nowrap;\n  word-wrap: normal;\n  pointer-events: none;\n  color: var(--color-red);\n  font-size: var(--font-size);\n  line-height: 18px;\n}\n._zs_gallery_mx-form_index_-warn,\n._zs_gallery_mx-form_index_-warn:hover,\n._zs_gallery_mx-form_index_-warn:focus {\n  border-color: var(--color-warn);\n}\n._zs_gallery_mx-form_index_-warn-msg {\n  display: none;\n  position: absolute;\n  white-space: nowrap;\n  word-wrap: normal;\n  pointer-events: none;\n  color: var(--color-warn);\n  font-size: var(--font-size);\n}\n");var l=function(e,r,t){var o,i,l,s=!0;for(var m in r)if(n.has(r,m)){if(a[m]){var f=a[m](t,i=r[m]);s=f.valid,l=f.tip}else s=!0,l="过滤掉不在校验规则内的";if(!s){o=m;break}}return{type:e,placement:r.placement,valid:s,action:o,rule:i,val:t,tip:l}},s=function(e){var r=o('[mxe="'+e+'"]');r.removeClass("_zs_gallery_mx-form_index_-warn _zs_gallery_mx-form_index_-error"),r.each(function(e,r){var t=(r=o(r)).attr("id")+"_msg";o("#"+t).hide()})},m=function(e,r,t){var a=o('[mxe="'+r+'"]');if(a.length){switch(e){case"warn":a.addClass("_zs_gallery_mx-form_index_-warn").removeClass("_zs_gallery_mx-form_index_-error");break;case"error":a.addClass("_zs_gallery_mx-form_index_-error").removeClass("_zs_gallery_mx-form_index_-warn")}return"checkbox"!=a.prop("type")&&"radio"!=a.prop("type")||(a=o(a[0])),a.each(function(r,a){var i=(a=o(a)).parent(),l=a.attr("id");l||(l=n.guid(),a.attr("id",l));var s=l+"_msg",m=o("#"+s);m.length||("static"==i.css("position")&&i.css({position:"relative"}),a.after('<div id="'+s+'"/>'),m=o("#"+s));switch(e){case"warn":m[0].className="_zs_gallery_mx-form_index_-warn-msg";break;case"error":m[0].className="_zs_gallery_mx-form_index_-error-msg"}m.html(t.tip).show();var f=t.placement||"bottom",d=a.outerWidth(),_=a.outerHeight(),c=a.offset(),p=i.offset(),h="32px";if(window.getComputedStyle){var v=getComputedStyle(document.documentElement);h=document.body.style.getPropertyValue("--input-height").trim()||v.getPropertyValue("--input-height").trim()}switch(f){case"right":m.css({lineHeight:h,top:c.top-p.top,left:c.left-p.left+d+10});break;case"bottom":m.css({lineHeight:"18px",top:c.top-p.top+_,left:c.left-p.left+10})}}),!0}};t.exports={isValid:function(e,r){e=n.mix({element:null,scrollIntoView:!0,checkSubs:!0},e||{});var t,a=this,i=!0,l=a.owner.children(),s=!1;if(r||(r=[],s=!0),e.checkSubs)for(var m=0;m<l.length;m++){!1===n.Vframe.get(l[m]).invoke("isValid",[r])&&(i=!1)}e.element?(t="string"!=typeof e.element||/^#/.test(e.element)||/^\./.test(e.element)?o(e.element):o("#"+e.element)).attr("mxe")||(t=t.find('[mxe^="'+a.id+'"]')):t=o("#"+a.id+' [mxe^="'+a.id+'"]');var f=[];t.each(function(e,r){a["@{check}"](o(r)),f.push(o(r).attr("mxe"))});var d=a.updater.$form;if(d)for(var _=0;_<f.length;_++){var c=f[_];if(d[c]&&"error"==d[c].type){r.push(c),i=!1;break}}if(s&&e.scrollIntoView){for(var p=1e20,h=void 0,v=r.length,x=void 0,g=void 0;v--;)(x=o('[mxe="'+r[v]+'"]')).length&&(g=x.offset()).top<p&&(h=x[0],p=g.top);h&&(h.scrollIntoViewIfNeeded?h.scrollIntoViewIfNeeded():h.scrollIntoView&&h.scrollIntoView())}return i},"$[mxc]<keyup,change,focusout>":function(e){var r=o(e.eventTarget),t=r.attr("mxe");t&&t.startsWith(this.id)&&this["@{check}"](r)},"@{check}":function(e){for(var r=this.updater,t=r.$form||(r.$form={}),a=e.attr("mxc"),f=!0,d=0,_=r.parse(a);d<_.length;d++){for(var c=_[d],p=c.f||{},h=c.p.split("."),v=h.pop(),x=void 0,g=r.get();g&&h.length;)g=g[h.shift()];if("checkbox"==e.prop("type")){var u=g[v],w=e.prop("checked");if(!0===u||!1===u)x=w;else if(x=e.val(),o.isArray(u)){var y=e.prop("name");if(y)u=[],i.addCheckbox(y,u,p);else{var z=i.indexOf(u,x);w?-1===z&&u.push(x):z>-1&&u.splice(z,1)}x=u}else o.isPlainObject(u)?(w?u[x]=x:delete u[x],x=u):x=w?x:""}else if("radio"==e.prop("type")){var b=e.prop("name");x=o("input[name="+b+"]:checked").val()}else x=e.val();if(f){var k=l("error",p,x),V=e.attr("mxe");if(k.valid){if(delete t[V],s(V),n.has(p,"warn")){var $=l("warn",p.warn,x);$.valid?(delete t[V],s(V)):(t[V]=$,m("warn",V,$))}}else t[V]=k,f=!1,m("error",V,k)}}},clearValid:function(){var e=this.updater.$form;if(e)for(var r in e)s(r);this.updater.$form={}},"$doc<htmlchanged>":function(e){var r=this.updater.$form;if(e.vId==this.id&&r)for(var t in r){var o=r[t];m(o.type,t,o)||delete r[t]}}}});