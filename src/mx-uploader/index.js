define("mx-uploader/index",["magix","$","../mx-runner/index"],(e,t,n)=>{var i=e("magix"),r=e("$"),a=e("../mx-runner/index");i.applyStyle("_R","._fP{position:relative;overflow:hidden}._fQ{left:0;top:0;bottom:0;right:0;width:100%;height:100%;opacity:0;cursor:pointer;font-size:100px;filter:alpha(opacity=0)}._fR,._fQ{position:absolute}._fR{left:-999999px}");var o=i.Base.extend({destroy:function(){this.__dK=1}}),p=o.extend({__gI:function(e,t,n,o){var p=e.form,s=this,d=i.guid("up");if(!p){r("body").append('<div id="'+d+'_temp" class="_fR"><form target="'+d+'"></form></div>');(p=r("#"+d+"_temp").find("form")).append(e),p=p[0]}var f=0,l=2e3;if(e.files){l=0;for(var c=0;c<e.files.length;c++)l+=e.files[c].size;(l/=1e3)<2e3&&(l=2e3)}var _=1e3/l,u=function(){s.__dK?a.__ak(u):f<1&&(o(f),f+=_+20*Math.random()*_)};a.__ai(100,u),r('<iframe name="'+d+'" id="'+d+'" style="display:none;"></iframe>').insertAfter(p).on("load",function(e){if(a.__ak(u),!s.__dK){o(1);var t=e.target,i=r(t.contentWindow.document.body);i.find("script").remove();var p=r.trim(i.text());r(t).remove(),r("#"+d+"_temp").remove();try{n(null,new Function("return "+p)())}catch(e){n(e)}}}).on("error",function(e){a.__ak(u),s.__dK||(r("#"+d+"_temp").remove(),n(e))}),p.target=d,p.action=t.get("action"),p.method="POST",p.enctype="multipart/form-data",p.submit()}}),s=o.extend({__gI:function(e,t,n,i){for(var r=new FormData,a=this,o=e.files,p=0;p<o.length;p++)r.append(t.get("name"),o[p]);var s=new XMLHttpRequest;s.open("post",t.get("action"),!0),s.onload=function(){if(!a.__dK)try{n(null,new Function("return "+s.responseText)())}catch(e){n(e)}},s.onerror=function(e){a.__dK||(e.message="network error",n(e))},s.upload.onprogress=function(e){a.__dK||(e.lengthComputable?i(e.loaded/e.total):i(0))},s.send(r)}});n.exports=i.View.extend({init:function(e){this.updater.set({name:e.name||"file",action:e.action||"",multiple:e.multiple,accept:e.accept});var t;t=window.FormData?s:p,this.capture("__gJ",new t)},render:function(){var e="file_"+this.id,t=r("#"+e);t.length&&t.remove();var n=this.updater.get();r("#"+this.id).append('<input id="'+e+'" type="file" class="_fQ" mx-change='+this.id+'__gK()" name="'+n.name+'" />').addClass("_fP"),t=r("#"+e),n.multiple&&t.attr("multiple","multiple"),n.accept&&t.prop("accept",n.accept)},"__gK<change>":function(e){var t=r("#"+this.id),n=e.eventTarget.files,i=r.Event("start",{files:n});if(t.trigger(i),i.isDefaultPrevented())this.render();else{this.capture("__gJ").__gI(e.target,this.updater,function(e,i){e?t.trigger({type:"error",error:e}):t.trigger({type:"success",files:n,response:i})},function(e){t.trigger({type:"progress",percent:e})}),this.render()}}})});