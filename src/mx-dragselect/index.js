define("mx-dragselect/index",["magix","../mx-dragdrop/index","../mx-runner/index","$"],(_,e,t)=>{var a=_("magix"),i=_("../mx-dragdrop/index"),n=_("../mx-runner/index"),h=_("$");a.applyStyle("_m","._cd{left:-1000px;top:0;background:#5665eb;position:absolute;opacity:.3;border:1px solid #4d4fa8}");var d=a.guid("area_"),r=h(window),o=h(document),g={__aP:function(){var _=h("#"+d);_.length||(_=h('<div id="'+d+'" class="_cd" />').appendTo("body"))},__aQ:function(_,e,t,a){h("#"+d).css({left:_,top:e,width:t,height:a})},__aG:function(){h("#"+d).css({left:-1e5})}},c=function(_,e){var t=_.width/2,a=_.height/2,i=e.width/2,n=e.height/2,h={x:_.x+t,y:_.y+a},d={x:e.x+i,y:e.y+n};return Math.abs(d.x-h.x)<=t+i&&Math.abs(d.y-h.y)<=a+n};t.exports=a.View.extend({init:function(_){var e=this,t=h("#"+e.id);t.on("mousedown",function(_){_.preventDefault(),e.__aR(_)}),t.on("click",function(_){if(!e.__aS){var a=e.__aT(_.target);a&&t.trigger({type:"change",action:"add",mode:"click",node:a})}delete e.__aS}),e.on("destroy",function(){t.off("mousedown click")}),e.__aU=_.selector,e.__h=t},__aT:function(_){for(var e=this,t=null,a=e.__h[0];a!=_;){if(_.parentNode==a){t=_;break}_=_.parentNode}return t&&e.__aU&&(h.find.matchesSelector(t,e.__aU)||(t=null)),t},__aV:function(){for(var _=[],e=0,t=0,a=this.__aU?this.__h.find(this.__aU):this.__h.children();t<a.length;t++){var i=a[t],n=h(i),d=n.offset();_.push({id:e++,c:i,x:d.left,y:d.top,width:n.width(),height:n.height()})}return _},__b_:function(_){var e=this,t={x:_.pageX,y:_.pageY},a=e.__aW;t.x<a.x?t.x=a.x:t.x>a.x+a.width&&(t.x=a.x+a.width),t.y<a.y?t.y=a.y:t.y>a.y+a.height&&(t.y=a.y+a.height);var i=e.__aX,n=Math.min(t.x,i.x),h=Math.min(t.y,i.y),d=Math.abs(t.x-i.x),r=Math.abs(t.y-i.y);g.__aQ(n,h,d,r);for(var o=e.__aY,f={x:n,y:h,width:d,height:r},s=e.__aZ,x=0,l=o;x<l.length;x++){var b=l[x];c(f,b)?1!==s[b.id]&&(s[b.id]=1,e.__h.trigger({type:"change",action:"add",mode:"drag",node:b.c})):1===s[b.id]&&(delete s[b.id],e.__h.trigger({type:"change",action:"remove",mode:"drag",node:b.c}))}},__aR:function(_){if(1===_.which){var e=this;e.__aX={x:_.pageX,y:_.pageY};var t=e.__h,a=t.offset();e.__aW={x:a.left,y:a.top,width:t.width(),height:t.height()},e.__aZ={},g.__aP(),t.trigger("dragbegin"),i.begin(_.target,function(_){e.__ba(_)},function(_){e.__bb(_)})}},__ba:function(_){var e=this;if(!e.__aS){var t=e.__aX;(Math.abs(_.pageX-t.x)>5||Math.abs(_.pageY-t.y)>5)&&(e.__aS=!0)}e.__aS&&(e.__aY||(e.__aY=e.__aV()),e.__bc=_,e.__bd(),e.__b_(_))},__bb:function(){var _=this;_.__be(),g.__aG(),delete _.__bc,delete _.__aX,delete _.__aW,delete _.__aY,delete _.__aZ,_.__h.trigger("dragfinish")},__bd:function(){var _=this;_.__bf||(_.__bf=function(){var e=0,t=0,a=_.__bc,i=r.scrollTop(),n=r.height(),h=o.height(),d=o.width(),g=r.width(),c=r.scrollLeft();a.pageX-c<20&&c>0?e=-Math.min(7,c):c+g-a.pageX<20&&c+g<d&&(e=Math.min(7,d-g-c)),a.pageY-i<20&&i>0?t=-Math.min(7,i):i+n-a.pageY<20&&i+n<h&&(t=Math.min(7,h-n-i)),(e||t)&&(a.pageX+=e,a.pageY+=t,_.__b_(a),window.scrollBy(e,t))},n.__bg(30,_.__bf))},__be:function(){var _=this;_.__bf&&(n.__bh(_.__bf),delete _.__bf)}})});