define("mx-menu/index",["magix","$","../mx-monitor/index"],(e,t,_)=>{var i=e("magix"),d=e("$"),s=e("../mx-monitor/index"),r=i.Vframe;i.applyStyle("_A","._dZ{transition:margin-left .25s}._e_{background-color:#fff;border:1px solid #e6e6e6;border-radius:4px;cursor:default;padding:4px 0}._ea{height:29px;line-height:29px;cursor:default;border-radius:4px;padding:0 12px;margin:0 4px}._eb{color:#fff;background-color:#f96447}._ec{margin-left:10px}._ed{margin-left:-10px}._ee{font-size:12px;-webkit-transform:scaleX(-1);transform:scaleX(-1);top:25%;color:#e6e6e6}");var n=null,o={left:"_ed",right:"_ec"};_.exports=i.View.extend({tmpl:function(e){var t="",_={"&":"amp","<":"lt",">":"gt",'"':"#34","'":"#39","`":"#96"},i=/[&<>"'`]/g,d=function(e){return null==e?"":""+e},s=function(e){return"&"+_[e]+";"},r=function(e){return d(e).replace(i,s)},n=/[\\'"]/g,o=function(e){return d(e).replace(n,"\\$&")};t+='<div style="width:'+r(e.width)+"px;",(e.isChild||e.contextMenu)&&(t+="position:absolute;left:-10000px;top:-10000px"),t+='" mx-mouseover="__dJ();" class="_dZ" mx-contextmenu="__G()"><ul class="_e_ _aj">';for(var a,h=0;h<e.list.length;h++)t+='<li class="_al _ea" mx-mouseover="__dI({id:\''+r(o((a=e.list[h])[e.valueKey]))+"'})\" mx-mouseout=\"__dI({id:'"+r(o(a[e.valueKey]))+"'});\n            \" ",a.children||(t+=" mx-click=\"__cw({id:'"+r(o(a[e.valueKey]))+"'})\" "),t+=' title="'+r(a[e.textKey])+'" id="'+r(e.viewId)+"_"+r(a[e.valueKey])+'">'+r(a[e.textKey])+" ",a.children&&(t+='<span class="_ab __ _ee">&#xe61e;</span>'),t+="</li>";return t+="</ul></div>"},init:function(e){var t=this;t.assign(e),t.__dr=e.__dr,t.__ds=e.__ds,t.__dt=e.picked,t.__du?t.on("destroy",function(){d("#"+t.id).remove()}):(s.__f(),t.on("destroy",function(){s.__i(t),s.__j(),t.__dr&&d("#"+t.id).remove()}))},assign:function(e){var t=e.width||340,_=e.valueKey||"id",d=e.parentKey||"pId",s=e.textKey||"text",r=e.__du;if(r)this.__cy=e.__cy,this.__cj=e.list;else{var n=function(e,t,_){for(var d={},s={},r=[],n=0,o=e.length;n<o;n++){var a=i.mix({},e[n]);d[a[t]]=a,s[a[t]]&&(a.children=s[a[t]]),i.has(a,_)&&""!==a[_]?d[a[_]]?(d[a[_]].children||(d[a[_]].children=[])).push(a):s[a[_]]?s[a[_]].push(a):s[a[_]]=[a]:r.push(a)}return{list:r,map:d}}(e.list,_,d);this.__cy=n.map,this.__cj=n.list}return this.__du=r,this.__dv=t,this.__dw=_,this.__dx=d,this.__dy=s,this.__dz=e.pId,this.__dA=e.__dA,!0},render:function(){this.updater.digest({viewId:this.id,contextMenu:this.__dr,isChild:this.__du,list:this.__cj,width:this.__dv,valueKey:this.__dw,textKey:this.__dy}),this.__dr&&this.__h(this.__ds)},__l:function(e){var t=i.inside(e,this.id);if(!t)for(var _=0,d=this.owner.children();_<d.length;_++){var s=d[_],n=r.get(s);if(n&&(t=n.invoke("__l",[e])))break}return t},__h:function(e,t){if(!this.__m){this.__m=1;var _=d("#"+this.id+" div"),i=d(document),r=-1,a=-1,h="right",u=_.outerWidth(),l=_.outerHeight(),c=0,f=0;if(t){var v=t.offset();c=t.outerWidth(),f=t.outerHeight(),r=v.left+c,a=v.top}else r=e.pageX,a=e.pageY;r+u>i.width()&&(h="left",(r=r-u-c)<0&&(r=0)),a+l>i.height()&&(a-=l,(a+=f)<0&&(a=0)),t&&("right"==h?r-=10:r+=10);var m=this.__dA||this;n!=m&&(n=m),this.__du?_.css({left:r,top:a}).addClass(o[h]):_.css({left:r,top:a}),m.__dB||(m.__dB=1,s.__n(m))}},__b:function(){for(var e=this.owner.children(),t=e.length-1;t>=0;t--){var _=r.get(e[t]);_&&_.invoke("__b")}if(this.__m){this.__m=!1;var i=d("#"+this.id+" div");this.__du?(i.removeClass(o.left).removeClass(o.right),i.css({left:-1e5}),this.__du.removeClass("_eb")):(this.__dr&&i.css({left:-1e4}),delete this.__dB,s.__i(this))}},__dD:function(e){clearTimeout(this["__dC"+e])},__dF:function(e,t,_){var i=this;i["__dE"+t]=setTimeout(i.wrapAsync(function(){var s=i.id+"_menu_"+t,n=r.get(s);n||(d("body").append('<div id="'+s+'" />'),n=i.owner.mountVframe(s,"mx-menu/index",{__du:d("#"+i.id+"_"+t),width:i.__dv,valueKey:i.__dw,textKey:i.__dy,parentKey:i.__dx,list:_,pId:t,__dA:i.__dA||i,__cy:i.__cy})),n.invoke("__h",[null,e],!0)}),250)},__dG:function(e){var t=this.id+"_menu_"+e,_=r.get(t);_&&(this["__dC"+e]=setTimeout(this.wrapAsync(function(){_.invoke("__b")}),50))},"__dI<mouseover,mouseout>":function(e){if(!i.inside(e.relatedTarget,e.eventTarget)){var t=d(e.eventTarget);t["mouseout"==e.type?"removeClass":"addClass"]("_eb");var _=e.params.id;if(this.__dG(this.__dH),"mouseover"==e.type){var s=this.__cy[_].children;s&&(this.__dD(_),this.__dF(t,_,s),this.__dH=_)}else clearTimeout(this["__dE"+_])}},"__dJ<mouseover>":function(e){!i.inside(e.relatedTarget,e.eventTarget)&&(this.__du||n==this||n&&n.__b(),this.__du&&(d(this.__du).addClass("_eb"),this.owner.parent().invoke("__dD",[this.__dz])))},"__cw<click>":function(e){var t=this.__dA||this,_=d("#"+t.id),i={type:"pick",item:this.__cy[e.params.id]};_.trigger(i),t.__b();var s=this.__dt;s&&s(i.item)},"__G<contextmenu>":function(e){e.preventDefault()}},{show:function(e,t,_){var s=t.eventTarget;s.id||(s.id=i.guid());var r="ctx_"+s.id,n=i.Vframe.get(r);n?n.invoke("__h",[t]):(d("body").append('<div id="'+r+'" />'),_=_||{},i.mix(_,{__dr:1,__ds:t}),n=e.owner.mountVframe(r,"mx-menu/index",_))}})});