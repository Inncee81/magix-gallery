define("mx-menu/index",["magix","$","../mx-monitor/index"],(t,e,i)=>{var _=t("magix"),s=t("$"),d=t("../mx-monitor/index"),n=_.Vframe;_.applyStyle("_z","._dQ{-webkit-transition:margin-left .25s;transition:margin-left .25s}._dR{background-color:#fff;border:1px solid #e6e6e6;border-radius:4px;cursor:default;padding:4px 0}._dS{height:29px;line-height:29px;cursor:default;border-radius:4px;padding:0 12px;margin:0 4px}._dT{color:#fff;background-color:#f96447}._dU{margin-left:10px}._dV{margin-left:-10px}._dW{font-size:12px;-webkit-transform:scaleX(-1);transform:scaleX(-1);top:25%;color:#e6e6e6}");var a=null,r={left:"_dV",right:"_dU"};i.exports=_.View.extend({tmpl:{html:'<div mx-guid="g0" style="width:<%=$$.width%>px;<%if($$.isChild||$$.contextMenu){%>position:absolute;left:-10000px;top:-10000px<%}%>" mx-mouseover="__dl();" class="_dQ" mx-contextmenu="__D()"><ul mx-guid="g1" class="_dR _aj">2</ul></div>',subs:[{keys:["width","isChild","contextMenu"],path:'div[mx-guid="g0"]',attr:'style="width:<%=$$.width%>px;<%if($$.isChild||$$.contextMenu){%>position:absolute;left:-10000px;top:-10000px<%}%>"',attrs:[{n:"style"}]},{keys:["list","valueKey","textKey","viewId"],path:'ul[mx-guid="g1"]',tmpl:'<%for(var _=0,a;_<$$.list.length;_++){a=$$.list[_]%><li class="_al _dS" mx-mouseover="__dk({id:\'<%=$eq(a[$$.valueKey])%>\'})" mx-mouseout="__dk({id:\'<%=$eq(a[$$.valueKey])%>\'});\n            " <%if(!a.children){%> mx-click="__bX({id:\'<%=$eq(a[$$.valueKey])%>\'})" <%}%> title="<%=a[$$.textKey]%>" id="<%=$$.viewId%>_<%=a[$$.valueKey]%>"><%=a[$$.textKey]%> <%if(a.children){%><span class="_ab __ _dW">&#xe61e;</span><%}%></li><%}%>',s:"2"}]},init:function(t){var e=this;e.assign(t),e.__cU=t.__cU,e.__cV=t.__cV,e.__cW=t.picked,e.__cX?e.on("destroy",function(){s("#"+e.id).remove()}):(d.__d(),e.on("destroy",function(){d.__f(e),d.__g(),e.__cU&&s("#"+e.id).remove()}))},assign:function(t){var e=t.width||340,i=t.valueKey||"id",s=t.parentKey||"pId",d=t.textKey||"text",n=t.__cX;if(n)this.__c_=t.__c_,this.__bL=t.list;else{var a=function(t,e,i){for(var s={},d={},n=[],a=0,r=t.length;a<r;a++){var o=_.mix({},t[a]);s[o[e]]=o,d[o[e]]&&(o.children=d[o[e]]),_.has(o,i)&&""!==o[i]?s[o[i]]?(s[o[i]].children||(s[o[i]].children=[])).push(o):d[o[i]]?d[o[i]].push(o):d[o[i]]=[o]:n.push(o)}return{list:n,map:s}}(t.list,i,s);this.__c_=a.map,this.__bL=a.list}return this.__cX=n,this.__cY=e,this.__cZ=i,this.__d_=s,this.__da=d,this.__db=t.pId,this.__dc=t.__dc,!0},render:function(){this.updater.digest({viewId:this.id,contextMenu:this.__cU,isChild:this.__cX,list:this.__bL,width:this.__cY,valueKey:this.__cZ,textKey:this.__da}),this.__cU&&this.__e(this.__cV)},__i:function(t){var e=_.inside(t,this.id);if(!e)for(var i=0,s=this.owner.children();i<s.length;i++){var d=s[i],a=n.get(d);if(a&&(e=a.invoke("__i",[t])))break}return e},__e:function(t,e){if(!this.__j){this.__j=1;var i=s("#"+this.id+" div"),_=s(document),n=-1,o=-1,h="right",c=i.outerWidth(),l=i.outerHeight(),u=0,f=0;if(e){var m=e.offset();u=e.outerWidth(),f=e.outerHeight(),n=m.left+u,o=m.top}else n=t.pageX,o=t.pageY;n+c>_.width()&&(h="left",(n=n-c-u)<0&&(n=0)),o+l>_.height()&&(o-=l,(o+=f)<0&&(o=0)),e&&("right"==h?n-=10:n+=10);var v=this.__dc||this;a!=v&&(a=v),this.__cX?i.css({left:n,top:o}).addClass(r[h]):i.css({left:n,top:o}),v.__dd||(v.__dd=1,d.__k(v))}},__a:function(){for(var t=this.owner.children(),e=t.length-1;e>=0;e--){var i=n.get(t[e]);i&&i.invoke("__a")}if(this.__j){this.__j=!1;var _=s("#"+this.id+" div");this.__cX?(_.removeClass(r.left).removeClass(r.right),_.css({left:-1e5}),this.__cX.removeClass("_dT")):(this.__cU&&_.css({left:-1e4}),delete this.__dd,d.__f(this))}},__df:function(t){clearTimeout(this["__de"+t])},__dh:function(t,e,i){var _=this;_["__dg"+e]=setTimeout(_.wrapAsync(function(){var d=_.id+"_menu_"+e,a=n.get(d);a||(s("body").append('<div id="'+d+'" />'),a=_.owner.mountVframe(d,"mx-menu/index",{__cX:s("#"+_.id+"_"+e),width:_.__cY,valueKey:_.__cZ,textKey:_.__da,parentKey:_.__d_,list:i,pId:e,__dc:_.__dc||_,__c_:_.__c_})),a.invoke("__e",[null,t],!0)}),250)},__di:function(t){var e=this.id+"_menu_"+t,i=n.get(e);i&&(this["__de"+t]=setTimeout(this.wrapAsync(function(){i.invoke("__a")}),50))},"__dk<mouseover,mouseout>":function(t){if(!_.inside(t.relatedTarget,t.eventTarget)){var e=s(t.eventTarget);e["mouseout"==t.type?"removeClass":"addClass"]("_dT");var i=t.params.id;if(this.__di(this.__dj),"mouseover"==t.type){var d=this.__c_[i].children;d&&(this.__df(i),this.__dh(e,i,d),this.__dj=i)}else clearTimeout(this["__dg"+i])}},"__dl<mouseover>":function(t){!_.inside(t.relatedTarget,t.eventTarget)&&(this.__cX||a==this||a&&a.__a(),this.__cX&&(s(this.__cX).addClass("_dT"),this.owner.parent().invoke("__df",[this.__db])))},"__bX<click>":function(t){var e=this.__dc||this,i=s("#"+e.id),_={type:"pick",item:this.__c_[t.params.id]};i.trigger(_),e.__a();var d=this.__cW;d&&d(_.item)},"__D<contextmenu>":function(t){t.preventDefault()}},{show:function(t,e,i){var d=e.eventTarget;d.id||(d.id=_.guid());var n="ctx_"+d.id,a=_.Vframe.get(n);a?a.invoke("__e",[e]):(s("body").append('<div id="'+n+'" />'),i=i||{},_.mix(i,{__cU:1,__cV:e}),a=t.owner.mountVframe(n,"mx-menu/index",i))}})});