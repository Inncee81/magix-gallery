define("mx-menu/index",["magix","$","../mx-monitor/index"],(e,t,_)=>{var i=e("magix"),s=e("$"),d=e("../mx-monitor/index"),n=i.Vframe;i.applyStyle("_B","._ee{-webkit-transition:margin-left .25s;transition:margin-left .25s}._ef{background-color:#fff;border:1px solid #e6e6e6;border-radius:4px;cursor:default;padding:4px 0}._eg{height:29px;line-height:29px;cursor:default;border-radius:4px;padding:0 12px;margin:0 4px}._eh{color:#fff;background-color:#f96447}._ei{margin-left:10px}._ej{margin-left:-10px}._ek{font-size:12px;-webkit-transform:scaleX(-1);transform:scaleX(-1);top:25%;color:#e6e6e6}");var r=null,a={left:"_ej",right:"_ei"};_.exports=i.View.extend({tmpl:{html:'<div style="width:<%=$$.width%>px;<%if($$.isChild||$$.contextMenu){%>position:absolute;left:-10000px;top:-10000px<%}%>" mx-mouseover="__dH();" class="_ee" mx-contextmenu="__E()"><ul class="_ef _aj"><%for(var _=0,a;_<$$.list.length;_++){a=$$.list[_]%><li class="_al _eg" mx-mouseover="__dG({id:\'<%=$eq(a[$$.valueKey])%>\'})" mx-mouseout="__dG({id:\'<%=$eq(a[$$.valueKey])%>\'});\n            " <%if(!a.children){%> mx-click="__cu({id:\'<%=$eq(a[$$.valueKey])%>\'})" <%}%> title="<%=a[$$.textKey]%>" id="<%=$$.viewId%>_<%=a[$$.valueKey]%>"><%=a[$$.textKey]%> <%if(a.children){%><span class="_ab __ _ek">&#xe61e;</span><%}%></li><%}%></ul></div>'},init:function(e){var t=this;t.assign(e),t.__dp=e.__dp,t.__dq=e.__dq,t.__dr=e.picked,t.__ds?t.on("destroy",function(){s("#"+t.id).remove()}):(d.__d(),t.on("destroy",function(){d.__g(t),d.__h(),t.__dp&&s("#"+t.id).remove()}))},assign:function(e){var t=e.width||340,_=e.valueKey||"id",s=e.parentKey||"pId",d=e.textKey||"text",n=e.__ds;if(n)this.__cw=e.__cw,this.__ch=e.list;else{var r=function(e,t,_){for(var s={},d={},n=[],r=0,a=e.length;r<a;r++){var o=i.mix({},e[r]);s[o[t]]=o,d[o[t]]&&(o.children=d[o[t]]),i.has(o,_)&&""!==o[_]?s[o[_]]?(s[o[_]].children||(s[o[_]].children=[])).push(o):d[o[_]]?d[o[_]].push(o):d[o[_]]=[o]:n.push(o)}return{list:n,map:s}}(e.list,_,s);this.__cw=r.map,this.__ch=r.list}return this.__ds=n,this.__dt=t,this.__du=_,this.__dv=s,this.__dw=d,this.__dx=e.pId,this.__dy=e.__dy,!0},render:function(){this.updater.digest({viewId:this.id,contextMenu:this.__dp,isChild:this.__ds,list:this.__ch,width:this.__dt,valueKey:this.__du,textKey:this.__dw}),this.__dp&&this.__f(this.__dq)},__j:function(e){var t=i.inside(e,this.id);if(!t)for(var _=0,s=this.owner.children();_<s.length;_++){var d=s[_],r=n.get(d);if(r&&(t=r.invoke("__j",[e])))break}return t},__f:function(e,t){if(!this.__k){this.__k=1;var _=s("#"+this.id+" div"),i=s(document),n=-1,o=-1,h="right",l=_.outerWidth(),u=_.outerHeight(),c=0,f=0;if(t){var v=t.offset();c=t.outerWidth(),f=t.outerHeight(),n=v.left+c,o=v.top}else n=e.pageX,o=e.pageY;n+l>i.width()&&(h="left",(n=n-l-c)<0&&(n=0)),o+u>i.height()&&(o-=u,(o+=f)<0&&(o=0)),t&&("right"==h?n-=10:n+=10);var m=this.__dy||this;r!=m&&(r=m),this.__ds?_.css({left:n,top:o}).addClass(a[h]):_.css({left:n,top:o}),m.__dz||(m.__dz=1,d.__l(m))}},__a:function(){for(var e=this.owner.children(),t=e.length-1;t>=0;t--){var _=n.get(e[t]);_&&_.invoke("__a")}if(this.__k){this.__k=!1;var i=s("#"+this.id+" div");this.__ds?(i.removeClass(a.left).removeClass(a.right),i.css({left:-1e5}),this.__ds.removeClass("_eh")):(this.__dp&&i.css({left:-1e4}),delete this.__dz,d.__g(this))}},__dB:function(e){clearTimeout(this["__dA"+e])},__dD:function(e,t,_){var i=this;i["__dC"+t]=setTimeout(i.wrapAsync(function(){var d=i.id+"_menu_"+t,r=n.get(d);r||(s("body").append('<div id="'+d+'" />'),r=i.owner.mountVframe(d,"mx-menu/index",{__ds:s("#"+i.id+"_"+t),width:i.__dt,valueKey:i.__du,textKey:i.__dw,parentKey:i.__dv,list:_,pId:t,__dy:i.__dy||i,__cw:i.__cw})),r.invoke("__f",[null,e],!0)}),250)},__dE:function(e){var t=this.id+"_menu_"+e,_=n.get(t);_&&(this["__dA"+e]=setTimeout(this.wrapAsync(function(){_.invoke("__a")}),50))},"__dG<mouseover,mouseout>":function(e){if(!i.inside(e.relatedTarget,e.eventTarget)){var t=s(e.eventTarget);t["mouseout"==e.type?"removeClass":"addClass"]("_eh");var _=e.params.id;if(this.__dE(this.__dF),"mouseover"==e.type){var d=this.__cw[_].children;d&&(this.__dB(_),this.__dD(t,_,d),this.__dF=_)}else clearTimeout(this["__dC"+_])}},"__dH<mouseover>":function(e){!i.inside(e.relatedTarget,e.eventTarget)&&(this.__ds||r==this||r&&r.__a(),this.__ds&&(s(this.__ds).addClass("_eh"),this.owner.parent().invoke("__dB",[this.__dx])))},"__cu<click>":function(e){var t=this.__dy||this,_=s("#"+t.id),i={type:"pick",item:this.__cw[e.params.id]};_.trigger(i),t.__a();var d=this.__dr;d&&d(i.item)},"__E<contextmenu>":function(e){e.preventDefault()}},{show:function(e,t,_){var d=t.eventTarget;d.id||(d.id=i.guid());var n="ctx_"+d.id,r=i.Vframe.get(n);r?r.invoke("__f",[t]):(s("body").append('<div id="'+n+'" />'),_=_||{},i.mix(_,{__dp:1,__dq:t}),r=e.owner.mountVframe(n,"mx-menu/index",_))}})});