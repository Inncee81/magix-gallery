define("mx-menu/index",["magix","$","../mx-monitor/index"],(e,t,i)=>{var _=e("magix"),d=e("$"),s=e("../mx-monitor/index"),n=_.Vframe;_.applyStyle("_A","._dZ{-webkit-transition:margin-left .25s;transition:margin-left .25s}._e_{background-color:#fff;border:1px solid #e6e6e6;border-radius:4px;cursor:default;padding:4px 0}._ea{height:29px;line-height:29px;cursor:default;border-radius:4px;padding:0 12px;margin:0 4px}._eb{color:#fff;background-color:#f96447}._ec{margin-left:10px}._ed{margin-left:-10px}._ee{font-size:12px;-webkit-transform:scaleX(-1);transform:scaleX(-1);top:25%;color:#e6e6e6}");var r=null,a={left:"_ed",right:"_ec"};i.exports=_.View.extend({tmpl:function(e,t){var i="",_={"&":"amp","<":"lt",">":"gt",'"':"#34","'":"#39","`":"#96"},d=/[&<>"'`]/g,s=function(e){return null==e?"":""+e},n=function(e){return"&"+_[e]+";"},r=function(e){return s(e).replace(d,n)},a=/[\\'"]/g,o=function(e){return s(e).replace(a,"\\$&")};i+='<div style="width:'+r(t.width)+"px;",(t.isChild||t.contextMenu)&&(i+="position:absolute;left:-10000px;top:-10000px"),i+='" mx-mouseover="__dI();" class="_dZ" mx-contextmenu="__F()"><ul class="_e_ _aj">';for(var h,l=0;l<t.list.length;l++)i+='<li class="_al _ea" mx-mouseover="__dH({id:\''+r(o((h=t.list[l])[t.valueKey]))+"'})\" mx-mouseout=\"__dH({id:'"+r(o(h[t.valueKey]))+"'});\n            \" ",h.children||(i+=" mx-click=\"__cv({id:'"+r(o(h[t.valueKey]))+"'})\" "),i+=' title="'+r(h[t.textKey])+'" id="'+r(t.viewId)+"_"+r(h[t.valueKey])+'">'+r(h[t.textKey])+" ",h.children&&(i+='<span class="_ab __ _ee">&#xe61e;</span>'),i+="</li>";return i+="</ul></div>"},init:function(e){var t=this;t.assign(e),t.__dq=e.__dq,t.__dr=e.__dr,t.__ds=e.picked,t.__dt?t.on("destroy",function(){d("#"+t.id).remove()}):(s.__e(),t.on("destroy",function(){s.__h(t),s.__i(),t.__dq&&d("#"+t.id).remove()}))},assign:function(e){var t=e.width||340,i=e.valueKey||"id",d=e.parentKey||"pId",s=e.textKey||"text",n=e.__dt;if(n)this.__cx=e.__cx,this.__ci=e.list;else{var r=function(e,t,i){for(var d={},s={},n=[],r=0,a=e.length;r<a;r++){var o=_.mix({},e[r]);d[o[t]]=o,s[o[t]]&&(o.children=s[o[t]]),_.has(o,i)&&""!==o[i]?d[o[i]]?(d[o[i]].children||(d[o[i]].children=[])).push(o):s[o[i]]?s[o[i]].push(o):s[o[i]]=[o]:n.push(o)}return{list:n,map:d}}(e.list,i,d);this.__cx=r.map,this.__ci=r.list}return this.__dt=n,this.__du=t,this.__dv=i,this.__dw=d,this.__dx=s,this.__dy=e.pId,this.__dz=e.__dz,!0},render:function(){this.updater.digest({viewId:this.id,contextMenu:this.__dq,isChild:this.__dt,list:this.__ci,width:this.__du,valueKey:this.__dv,textKey:this.__dx}),this.__dq&&this.__g(this.__dr)},__k:function(e){var t=_.inside(e,this.id);if(!t)for(var i=0,d=this.owner.children();i<d.length;i++){var s=d[i],r=n.get(s);if(r&&(t=r.invoke("__k",[e])))break}return t},__g:function(e,t){if(!this.__l){this.__l=1;var i=d("#"+this.id+" div"),_=d(document),n=-1,o=-1,h="right",l=i.outerWidth(),u=i.outerHeight(),c=0,v=0;if(t){var f=t.offset();c=t.outerWidth(),v=t.outerHeight(),n=f.left+c,o=f.top}else n=e.pageX,o=e.pageY;n+l>_.width()&&(h="left",(n=n-l-c)<0&&(n=0)),o+u>_.height()&&(o-=u,(o+=v)<0&&(o=0)),t&&("right"==h?n-=10:n+=10);var m=this.__dz||this;r!=m&&(r=m),this.__dt?i.css({left:n,top:o}).addClass(a[h]):i.css({left:n,top:o}),m.__dA||(m.__dA=1,s.__m(m))}},__a:function(){for(var e=this.owner.children(),t=e.length-1;t>=0;t--){var i=n.get(e[t]);i&&i.invoke("__a")}if(this.__l){this.__l=!1;var _=d("#"+this.id+" div");this.__dt?(_.removeClass(a.left).removeClass(a.right),_.css({left:-1e5}),this.__dt.removeClass("_eb")):(this.__dq&&_.css({left:-1e4}),delete this.__dA,s.__h(this))}},__dC:function(e){clearTimeout(this["__dB"+e])},__dE:function(e,t,i){var _=this;_["__dD"+t]=setTimeout(_.wrapAsync(function(){var s=_.id+"_menu_"+t,r=n.get(s);r||(d("body").append('<div id="'+s+'" />'),r=_.owner.mountVframe(s,"mx-menu/index",{__dt:d("#"+_.id+"_"+t),width:_.__du,valueKey:_.__dv,textKey:_.__dx,parentKey:_.__dw,list:i,pId:t,__dz:_.__dz||_,__cx:_.__cx})),r.invoke("__g",[null,e],!0)}),250)},__dF:function(e){var t=this.id+"_menu_"+e,i=n.get(t);i&&(this["__dB"+e]=setTimeout(this.wrapAsync(function(){i.invoke("__a")}),50))},"__dH<mouseover,mouseout>":function(e){if(!_.inside(e.relatedTarget,e.eventTarget)){var t=d(e.eventTarget);t["mouseout"==e.type?"removeClass":"addClass"]("_eb");var i=e.params.id;if(this.__dF(this.__dG),"mouseover"==e.type){var s=this.__cx[i].children;s&&(this.__dC(i),this.__dE(t,i,s),this.__dG=i)}else clearTimeout(this["__dD"+i])}},"__dI<mouseover>":function(e){!_.inside(e.relatedTarget,e.eventTarget)&&(this.__dt||r==this||r&&r.__a(),this.__dt&&(d(this.__dt).addClass("_eb"),this.owner.parent().invoke("__dC",[this.__dy])))},"__cv<click>":function(e){var t=this.__dz||this,i=d("#"+t.id),_={type:"pick",item:this.__cx[e.params.id]};i.trigger(_),t.__a();var s=this.__ds;s&&s(_.item)},"__F<contextmenu>":function(e){e.preventDefault()}},{show:function(e,t,i){var s=t.eventTarget;s.id||(s.id=_.guid());var n="ctx_"+s.id,r=_.Vframe.get(n);r?r.invoke("__g",[t]):(d("body").append('<div id="'+n+'" />'),i=i||{},_.mix(i,{__dq:1,__dr:t}),r=e.owner.mountVframe(n,"mx-menu/index",i))}})});