define("mx-dropdown/multiple",["magix","$","../mx-monitor/index"],(e,t,i)=>{var _=e("magix"),s=e("$"),a=e("../mx-monitor/index");_.applyStyle("_p",'._cz{outline:0;position:relative;width:340px;background-color:#fff;border:1px solid #e6e6e6;border-radius:4px;display:inline-block;vertical-align:middle;height:32px}._cz:hover{border-color:#ccc}._cA{color:#333;position:relative;width:100%;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;padding:0 30px 0 12px;border-radius:3px}._cB{cursor:not-allowed;background-color:#fbfbfb}._cB:hover{border-color:#e6e6e6}._cB ._cA{cursor:not-allowed}._cC{position:absolute;right:0;top:2px;font-size:28px;color:#ccc;-webkit-transition:top .3s,-webkit-transform .3s;transition:top .3s,-webkit-transform .3s;transition:transform .3s,top .3s;transition:transform .3s,top .3s,-webkit-transform .3s}._cD ._cC{-webkit-transform:rotate(180deg);transform:rotate(180deg);top:0}._cz[tabindex="0"]:focus,._cD,._cD:hover{border-color:#f96447}._cE{height:30px;line-height:30px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}._cF{color:#999}._cG{position:absolute;top:100%;left:-1px;width:350px;margin-top:5px;border-radius:4px;z-index:300;border:1px solid #e6e6e6;background-color:#fff;display:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}._cD ._cG{display:block}._cH{overflow:auto;max-height:192px;padding:4px 0}._cI{display:block;width:100%;padding:9px 9px 4px}._cJ{padding:0;width:100%}._cK{color:#ccc;position:absolute;left:15px;top:18px}._cL{padding-left:28px;width:100%;height:28px;line-height:28px}._cM{padding:5px;color:#999;display:block;cursor:default}._cN{padding:3px 4px}._cO{cursor:pointer;color:#666;display:block;width:100%;padding:0 6px;height:26px;line-height:26px;border-radius:4px}._cP{width:32%;float:left;margin-left:2px;margin-bottom:2px}._cQ{cursor:pointer;color:#666;display:block;padding:0 12px;height:29px;line-height:29px;border-radius:4px}._cO:hover,._cQ:hover{color:#333;background-color:#f0f0f0}._cR,._cR:active,._cR:focus,._cR:hover{color:#fff;background-color:#f96447}._cS{border-top:1px solid #e6e6e6;margin:0 10px;padding:10px 0}._cT{border-left:1px solid #e6e6e6}');var c=function(e,t,i,s,a){if(!e[t]||_.has(i,s)){var c=i[s]||"";a||(c+=""),e[t]=c}return e[t]};i.exports=_.View.extend({tmpl:{html:'<div mx-guid="g0" class="_cA" mx-click="__ax()" title="<%=$$.selectedText%>"><span mx-guid="g1" class="_cE<%if($$.phLabel){%> _cF<%}%>">2</span><span class="__ _cC">&#xe692;</span></div><div mx-guid="g2" class="_cG">3</div>',subs:[{keys:["selectedText"],path:'div[mx-guid="g0"]',attr:'title="<%=$$.selectedText%>"',attrs:[{n:"title",p:1}]},{keys:["phLabel","selectedText"],path:'span[mx-guid="g1"]',tmpl:"<%=$$.selectedText%>",s:"2",attr:'class="_cE<%if($$.phLabel){%> _cF<%}%>"',attrs:[{n:"class",p:1,f:"className"}],mask:"21"},{keys:["rList","searchbox"],path:'div[mx-guid="g2"]',tmpl:'<%if($$.rList){if($$.searchbox){%><div class="_cI"><label class="_cJ"><span class="__ _cK">&#xe608;</span><input mx-keyup="__bW()" mx-paste="__bW()" mx-change="__bY()" mx-focusin="__bY()" mx-focusout="__bY()" placeholder="搜索关键词" class="_ap _cL"></label></div><%}%><ul mx-guid="g3" class="_cH" id="list_<%=$$.viewId%>">4</ul><div class="_cS _ai"><div class="_aa"><button type="button" class="_an _ao" mx-click="__b({enter:true})">确定</button><button type="button" class="_an _s" mx-click="__b()">取消</button></div><div class="_aa _t _cT _R"><button type="button" class="_an" mx-click="__ce()">全选/不选</button><button type="button" class="_an _s" mx-click="__cf()">反选</button></div></div><%}%>',s:"3"},{keys:["selected","list","textKey","valueKey","emptyText"],path:'ul[mx-guid="g3"]',pKeys:["rList","searchbox"],tmpl:'<%var _=$$.selected.split(\',\'),a=void 0,b=void 0;for(var c=0;c<$$.list.length;c++){var d=$$.list[c];if(d&&d.group){%><li class="_cM _al" title="<%=d[$$.textKey]%>"><%=d[$$.textKey]%></li><%}else{if($$.textKey&&$$.valueKey){a=d[$$.textKey];b=d[$$.valueKey];}else{a=d;b=d;}if($$.emptyText===b&&c===0){b=\'\';d=\'\';}var e=$$.inArray(b+\'\',_)>-1;if(b===\'\'){%><li title="<%=a%>" class="_cN"><span class="_cO _al <%if(e){%> _cR<%}%>" mx-click="__bX({item:\'<%@d%>\'})"><%=a%></span></li><%}else{%><li class="_cN _ai"><ul><%for(;c<$$.list.length;c++){d=$$.list[c];if(d&&d.group){c--;break;}if($$.textKey&&$$.valueKey){a=d[$$.textKey];b=d[$$.valueKey];}else{a=d;b=d;}var f=$$.inArray(b+\'\',_)>-1%><li class="_cP"><span class="_cQ _al<%if(f){%> _cR<%}%>" mx-click="__bX({item:\'<%@d%>\'})"><%=a%></span></li><%}%></ul></li><%}}}%>',s:"4"}]},init:function(e){var t=this;a.__d();var i=s("#"+t.id);t.__h=i,i.addClass("_cz"),i.on("keydown",function(e){13==e.keyCode&&t["__ax<click>"]()}),t.on("destroy",function(){i.off("keydown"),a.__f(t),a.__g()}),t.updater.set({viewId:t.id,inArray:s.inArray}),t.assign(e)},assign:function(e){var t=this;c(t,"__bL",e,"list",1);var i=c(t,"__aB",e,"selected"),a=c(t,"__bM",e,"textKey"),r=c(t,"__bN",e,"valueKey"),o=c(t,"__bO",e,"emptyText");if(t.__bP=e.searchbox+""=="true",t.__bZ=e.disabled+""=="true",!t.__bL){var l,n=[];t.__h.children().each(function(e,t){t=s(t),l="true"==t.attr("group"),n.push({group:l,text:t.text(),value:l?_.guid():t.attr("value")})}),a=t.__bM="text",r=t.__bN="value",t.__bL=n}var d=t.__bL,p=_.toMap(d,r);if(o)if(a&&r){if(!p[""]){var u={};u[a]=o,u[r]="",d.unshift(u),p[""]=u}}else p[o]||(d.unshift(o),p[""]=o);return t.__aB=i,t.__c_=p,t.updater.set({list:d}),!0},__i:function(e){return _.inside(e,this.id)},render:function(){var e=this;e.__h[e.__bZ?"addClass":"removeClass"]("_cB").prop("tabindex",e.__bQ?-1:0),e.__ca(e.__aB)},__b:function(e){var t=this;if(t.__h.hasClass("_cD")){var i=t.updater.get();if(_.has(t,"__cb")){var s=e&&i.selected!==t.__cb;e?t.__ca(i.selected):t.__ca(t.__cb),s&&t.__h.val(i.selected).trigger({type:"change",keys:{text:i.textKey,value:i.valueKey},values:(i.selected+"").split(",")}),delete t.__cb}t.__h.removeClass("_cD").trigger("focusout"),a.__f(t)}},__e:function(){var e=this;if(!e.__h.hasClass("_cD")){e.updater.get("rList")||e.updater.digest({rList:!0}),e.__h.addClass("_cD").trigger("focusin");var t=s("#list_"+e.id),i=t.find("._cR").position();if(i){var _=t.height(),c=t.prop("scrollTop");if(i.top<0||i.top>_){var r=i.top-_+c+_/2;t.prop("scrollTop",r)}}a.__k(e)}},__cc:function(e,t){for(var i=this.__c_,_=[],s=0,a=e;s<a.length;s++){var c=a[s],r=i[c]||{};t?_.push(r[t]):_.push(c||r)}return _},__ca:function(e){var t=this;e=e||"",e+="";var i=t.__bM||"",_=t.__bN||"",s=e.split(","),a="",c=t.__bL;s.length?a=t.__cc(s,i):(e=c[0],a=c[0],i&&_&&(a=(e=e[_])[i])),t.updater.digest({textKey:i,valueKey:_,emptyText:t.__bO,searchbox:t.__bP,phLabel:""===e,selected:t.__aB=e,selectedText:a}),t.__h.val(e)},__bU:function(e,t){var i=this;clearTimeout(i.__bT);var _=i.__bL,s=[],a=0,c=_.length,r=i.__bM,o=i.__bN;if(e){var l=function(){if(a<c){for(var n=Math.min(a+400,c),d=a,p=void 0,u=void 0,b=void 0;d<n;d++)u=p=_[d],b=p,r&&o&&(u=p[r],b=p[o]),((u+"").indexOf(e)>=0||(b+"").indexOf(e)>=0)&&s.push(p);a=n,i.__bT=setTimeout(i.wrapAsync(l),20)}else t(s)};l()}else t(_)},"__ax<click>":function(){var e=this,t=e.__h;t.hasClass("_cD")?e.__b():t.hasClass("_cB")||e.__e()},"__bW<keyup,paste>":function(e){var t=this;clearTimeout(t.__bV);var i=s.trim(e.eventTarget.value);t.__bV=setTimeout(t.wrapAsync(function(){i!=t.__cd&&t.__bU(t.__cd=i,function(e){t.updater.digest({list:e})})}),300)},"__bX<click>":function(e){var t=this,i=e.params.item,a=t.updater,c=a.get();_.has(t,"__cb")||(t.__cb=c.selected);var r=t.__bN,o=t.__bM,l=i;o&&r&&(i[o],l=i[r]);var n=[""];l&&(n=c.selected.split(","));var d=s.inArray("",n);d>-1&&n.splice(d,1),-1==(d=s.inArray(l+"",n))?n.push(l):n.splice(d,1),n.length||c.emptyText&&(n=[""]),l=n.join(","),a.digest({selected:t.__aB=l})},"__bY<change,focusin,focusout>":function(e){e.stopPropagation()},"__b<click>":function(e){this.__b(e.params.enter)},"__ce<click>":function(){var e=this,t=e.__aB,i=e.__bL,s=e.__bN,a=e.updater;if(_.has(e,"__cb")||(e.__cb=t),t)t="";else{t="";for(var c=e.__bO?1:0,r=void 0;c<i.length;c++)r=i[c],s?r.group||(t+=r[s]+","):t+=r+",";t=t.slice(0,-1)}a.digest({selected:e.__aB=t})},"__cf<click>":function(){var e=this,t=e.__aB,i=e.__bL,a=e.__bN,c=e.updater;_.has(e,"__cb")||(e.__cb=t);var r=t.split(",");t="";for(var o=e.__bO?1:0,l=void 0;o<i.length;o++)l=i[o],a?l.group||-1!=s.inArray(l[a]+"",r)||(t+=l[a]+","):-1==s.inArray(l+"",r)&&(t+=l+",");t=t.slice(0,-1),c.digest({selected:e.__aB=t})}})});