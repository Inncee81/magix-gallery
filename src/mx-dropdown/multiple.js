define("mx-dropdown/multiple",["magix","$","../mx-monitor/index"],(t,e,i)=>{var s=t("magix"),_=t("$"),c=t("../mx-monitor/index");s.applyStyle("_q",'._cI{outline:0;position:relative;width:340px;background-color:#fff;border:1px solid #e6e6e6;border-radius:4px;display:inline-block;vertical-align:middle;height:32px}._cI:hover{border-color:#ccc}._cJ{color:#333;position:relative;width:100%;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;padding:0 30px 0 12px;border-radius:3px}._cK{cursor:not-allowed;background-color:#fbfbfb}._cK:hover{border-color:#e6e6e6}._cK ._cJ{cursor:not-allowed}._cL{position:absolute;right:0;top:2px;font-size:28px;color:#ccc;-webkit-transition:top .3s,-webkit-transform .3s;transition:top .3s,-webkit-transform .3s;transition:transform .3s,top .3s;transition:transform .3s,top .3s,-webkit-transform .3s}._cM ._cL{-webkit-transform:rotate(180deg);transform:rotate(180deg);top:0}._cI[tabindex="0"]:focus,._cM,._cM:hover{border-color:#f96447}._cN{height:30px;line-height:30px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}._cO{color:#999}._cP{position:absolute;top:100%;left:-1px;width:350px;margin-top:5px;border-radius:4px;z-index:300;border:1px solid #e6e6e6;background-color:#fff;display:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}._cM ._cP{display:block}._cQ{overflow:auto;max-height:192px;padding:4px 0}._cR{display:block;width:100%;padding:9px 9px 4px}._cS{padding:0;width:100%}._cT{color:#ccc;position:absolute;left:15px;top:18px}._cU{padding-left:28px;width:100%;height:28px;line-height:28px}._cV{padding:5px;color:#999;display:block;cursor:default}._cW{padding:3px 4px}._cX{cursor:pointer;color:#666;display:block;width:100%;padding:0 6px;height:26px;line-height:26px;border-radius:4px}._cY{width:32%;float:left;margin-left:2px;margin-bottom:2px}._cZ{cursor:pointer;color:#666;display:block;padding:0 12px;height:29px;line-height:29px;border-radius:4px}._cX:hover,._cZ:hover{color:#333;background-color:#f0f0f0}._d_,._d_:active,._d_:focus,._d_:hover{color:#fff;background-color:#f96447}._da{border-top:1px solid #e6e6e6;margin:0 10px;padding:10px 0}._db{border-left:1px solid #e6e6e6}'),i.exports=s.View.extend({tmpl:function(t,e){var i="",s={"&":"amp","<":"lt",">":"gt",'"':"#34","'":"#39","`":"#96"},_=/[&<>"'`]/g,c=function(t){return null==t?"":""+t},a=function(t){return"&"+s[t]+";"},r=function(t){return c(t).replace(_,a)},o=function(i,s,_){for(_=e[t];--_;)if(e[s=t+_]===i)return s;return e[s=t+e[t]++]=i,s};if(i+='<div class="_cJ" mx-click="__aX()" title="'+r(e.selectedText)+'"><span class="_cN',e.phLabel&&(i+=" _cO"),i+='">'+r(e.selectedText)+'</span><span class="__ _cL">&#xe692;</span></div><div class="_cP">',e.rList){e.searchbox&&(i+='<div class="_cR"><label class="_cS"><span class="__ _cT">&#xe608;</span><input mx-keyup="__cu()" mx-paste="__cu()" mx-change="__at()" mx-focusin="__at()" mx-focusout="__at()" placeholder="搜索关键词" class="_ap _cU" value="'+r(e.keyword)+'"></label></div>'),i+='<ul class="_cQ" id="list_'+r(e.viewId)+'">';for(var l=e.selected.split(","),n=void 0,d=void 0,p=0;p<e.list.length;p++){var h=e.list[p];if(h&&h.group)i+='<li class="_cV _al" title="'+r(h[e.textKey])+'">'+r(h[e.textKey])+"</li>";else{e.textKey&&e.valueKey?(n=h[e.textKey],d=h[e.valueKey]):(n=h,d=h),e.emptyText===d&&0===p&&(d="",h="");var u=e.inArray(d+"",l)>-1;if(""===d)i+='<li title="'+r(n)+'" class="_cW"><span class="_cX _al ',u&&(i+=" _d_"),i+='" mx-click="__cv({item:\'',i+=o(h),i+="'})\">"+r(n)+"</span></li>";else{for(i+='<li class="_cW _ai"><ul>';p<e.list.length;p++){if((h=e.list[p])&&h.group){p--;break}e.textKey&&e.valueKey?(n=h[e.textKey],d=h[e.valueKey]):(n=h,d=h);i+='<li class="_cY"><span class="_cZ _al',e.inArray(d+"",l)>-1&&(i+=" _d_"),i+='" mx-click="__cv({item:\'',i+=o(h),i+="'})\">"+r(n)+"</span></li>"}i+="</ul></li>"}}}i+='</ul><div class="_da _ai"><div class="_aa"><button type="button" class="_an _ao" mx-click="__a({enter:true})">确定</button><button type="button" class="_an _s" mx-click="__a()">取消</button></div><div class="_aa _t _db _R"><button type="button" class="_an" mx-click="__cC()">全选/不选</button><button type="button" class="_an _s" mx-click="__cD()">反选</button></div></div>'}return i+="</div>"},init:function(t){var e=this;c.__e();var i=_("#"+e.id);e.__j=i,i.addClass("_cI"),i.on("keydown",function(t){13==t.keyCode&&e["__aX<click>"]()}),e.on("destroy",function(){i.off("keydown"),c.__h(e),c.__i()}),e.updater.set({viewId:e.id,inArray:_.inArray}),e.__ch=!t.list,e.assign(t,{node:i})},assign:function(t,e){var i=e.node,c=e.inner;this.__ci=t.list;var a=this.__ba=t.selected,r=this.__cj=t.textKey||"",o=this.__ck=t.valueKey||"",l=this.__cl=t.emptyText||"";if(this.__cm=t.searchbox+""=="true",this.__cw=t.disabled+""=="true",this.__ch){var n,d=[];(i=c?_(c):_(i).children()).each(function(t,e){e=_(e),n="true"==e.attr("group"),d.push({group:n,text:e.text(),value:n?s.guid():e.attr("value")})}),r=this.__cj="text",o=this.__ck="value",this.__ci=d}var p=this.__ci,h=s.toMap(p,o);if(l)if(r&&o){if(!h[""]){var u={};u[r]=l,u[o]="",p.unshift(u),h[""]=u}}else h[l]||(p.unshift(l),h[""]=l);return this.__ba=a,this.__cx=h,this.updater.set({list:p}),!0},__k:function(t){return s.inside(t,this.id)},render:function(){this.__j[this.__cw?"addClass":"removeClass"]("_cK").prop("tabindex",this.__cn?-1:0),this.__cy(this.__ba)},__a:function(t){if(this.__j.hasClass("_cM")){var e=this.updater.get();if(this.__j.removeClass("_cM").trigger("focusout"),c.__h(this),s.has(this,"__cz")){var i=t&&e.selected!==this.__cz;t?this.__cy(e.selected):this.__cy(this.__cz),delete this.__cz,i&&this.__j.val(e.selected).trigger({type:"change",keys:{text:e.textKey,value:e.valueKey},values:(e.selected+"").split(",")})}}},__g:function(){if(!this.__j.hasClass("_cM")){this.updater.get("rList")||this.updater.digest({rList:!0}),this.__j.addClass("_cM").trigger("focusin");var t=_("#list_"+this.id),e=t.find("._d_").position();if(e){var i=t.height(),s=t.prop("scrollTop");if(e.top<0||e.top>i){var a=e.top-i+s+i/2;t.prop("scrollTop",a)}}c.__m(this)}},__cA:function(t,e){for(var i=this.__cx,s=[],_=0,c=t;_<c.length;_++){var a=c[_],r=i[a]||{};e?s.push(r[e]):s.push(a||r)}return s},__cy:function(t){t=t||"",t+="";var e=this.__cj||"",i=this.__ck||"",s=t.split(","),_="",c=this.__ci;s.length?_=this.__cA(s,e):(t=c[0],_=c[0],e&&i&&(_=(t=t[i])[e])),this.updater.digest({textKey:e,valueKey:i,emptyText:this.__cl,searchbox:this.__cm,phLabel:""===t,selected:this.__ba=t,selectedText:_}),this.__j.val(t)},__cr:function(t,e){var i=this;clearTimeout(i.__cq);var s=i.__ci,_=[],c=0,a=s.length,r=i.__cj,o=i.__ck;if(t){var l=function(){if(c<a){for(var n=Math.min(c+400,a),d=c,p=void 0,h=void 0,u=void 0;d<n;d++)h=p=s[d],u=p,r&&o&&(h=p[r],u=p[o]),((h+"").indexOf(t)>=0||(u+"").indexOf(t)>=0)&&_.push(p);c=n,i.__cq=setTimeout(i.wrapAsync(l),20)}else e(_)};l()}else e(s)},"__aX<click>":function(){var t=this.__j;t.hasClass("_cM")?this.__a():t.hasClass("_cK")||this.__g()},"__cu<keyup,paste>":function(t){var e=this;clearTimeout(e.__cs);var i=_.trim(t.eventTarget.value);e.updater.set({keyword:i}),e.__cs=setTimeout(e.wrapAsync(function(){i!=e.__cB&&e.__cr(e.__cB=i,function(t){e.updater.digest({list:t})})}),300)},"__cv<click>":function(t){var e=t.params.item,i=this.updater,c=i.get();s.has(this,"__cz")||(this.__cz=c.selected);var a=this.__ck,r=this.__cj,o=e;r&&a&&(e[r],o=e[a]);var l=[""];o&&(l=c.selected.split(","));var n=_.inArray("",l);n>-1&&l.splice(n,1),-1==(n=_.inArray(o+"",l))?l.push(o):l.splice(n,1),l.length||c.emptyText&&(l=[""]),o=l.join(","),i.digest({selected:this.__ba=o})},"__at<change,focusin,focusout>":function(t){t.stopPropagation()},"__a<click>":function(t){this.__a(t.params.enter)},"__cC<click>":function(){var t=this.__ba,e=this.__ci,i=this.__ck,_=this.updater;if(s.has(this,"__cz")||(this.__cz=t),t)t="";else{t="";for(var c=this.__cl?1:0,a=void 0;c<e.length;c++)a=e[c],i?a.group||(t+=a[i]+","):t+=a+",";t=t.slice(0,-1)}_.digest({selected:this.__ba=t})},"__cD<click>":function(){var t=this.__ba,e=this.__ci,i=this.__ck,c=this.updater;s.has(this,"__cz")||(this.__cz=t);var a=t.split(",");t="";for(var r=this.__cl?1:0,o=void 0;r<e.length;r++)o=e[r],i?o.group||-1!=_.inArray(o[i]+"",a)||(t+=o[i]+","):-1==_.inArray(o+"",a)&&(t+=o+",");t=t.slice(0,-1),c.digest({selected:this.__ba=t})}})});