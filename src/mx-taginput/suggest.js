define("mx-taginput/suggest",["magix","$","../mx-monitor/index"],(_,t,e)=>{var i=_("magix"),s=_("$"),o=_("../mx-monitor/index");i.applyStyle("_L","._fm{position:absolute;border:1px solid #e6e6e6;font-size:14px;max-height:260px;overflow:auto;list-style:none;border-radius:4px;background-color:#fff;display:none;z-index:10;padding:3px 0;line-height:1.8}._fn{padding:0 4px;cursor:pointer;margin:2px 0}._fo{color:#666;display:block;width:100%;padding:0 6px;height:29px;line-height:29px;border-radius:4px}._fp,._fo:active,._fo:focus,._fo:hover{color:#333;background-color:#f0f0f0}._fp{border-radius:4px;text-decoration:none;outline:0}"),e.exports=i.View.extend({tmpl:{html:'<ul mx-guid="g0" class="_fm _aj" style="width:<%=$$.width%>px;" mx-mouseout="__eH()" mx-mousemove="__eI()" mx-contextmenu="__D()">1</ul>',subs:[{keys:["width","rList","list","viewId","textKey"],path:'ul[mx-guid="g0"]',tmpl:'<%if($$.rList){for(var _=0,a;_<$$.list.length;_++){a=$$.list[_]%><li class="_fn"><a href="#" class="_fo" data-idx="<%=_%>" mx-click="__eG({item:\'<%@a%>\'})" id="sg_<%=$$.viewId%>_<%=_%>"><%=$$.textKey?a[$$.textKey]:a%></a></li><%}}%>',s:"1",attr:'style="width:<%=$$.width%>px;"',attrs:[{n:"style"}],mask:"21111"}]},init:function(_){var t=this;t.__fT=_.scrollTop||0,t.__ew=_.list||[],t.__cP=0|(_.offsetLeft||0),o.__d(),t.on("destroy",function(){o.__f(t),o.__g(),t.__h.off("keyup paste input",t.__ex).off("focus",t.__ey),s("#suggest_"+t.id).remove()}),t.updater.set({viewId:t.id,width:_.width||340,textKey:_.textKey,valueKey:_.valueKey}),t.__fU=-1,t.__fV=[t.id,"suggest_"+t.id],_.relateIds&&(t.__fV=t.__fV.concat(_.relateIds.split(",")))},__i:function(_){for(var t=this.__fV,e=0;e<t.length;e++)if(i.inside(_,t[e]))return!0;return!1},__fX:function(_,t){t||(this.__ew=_),this.__fU=-1,this.updater.digest({list:this.__fW=_}),this.__cN&&(_&&_.length?this.__cN.addClass("_fm"):this.__cN.removeClass("_fm"))},render:function(){var _=this,t=s("#"+_.id);_.__h=t,t.on("focus",_.__ey=s.proxy(_.__e,_)).on("keyup paste input",_.__ex=s.proxy(_.__eB,_));var e="suggest_"+_.id;s("<div />").attr("id",e).insertAfter(t),_.updater.to(e),_.__fX(_.__ew),_.__cN=s("#"+e+" ul"),_.__ew&&_.__ew.length||_.__cN.removeClass("_fm"),setTimeout(_.wrapAsync(function(){_.__cN.prop("scrollTop",_.__fT)}),0)},__eB:function(_){this.__j||this.__e();var t=this.__fW;if(40==_.keyCode)this.__eC(),this.__fU++,this.__fU>=t.length&&(this.__fU=0),this.__eD();else if(38==_.keyCode)this.__eC(),this.__fU--,this.__fU<0&&(this.__fU=t.length-1),this.__eD();else if(13==_.keyCode){if(this.__fU>-1&&this.__fU<this.__fW.length){var e=this.__fW[this.__fU];this.__h.trigger({type:"pick",item:e}),this.__eC(),this.__fU=-1,this.__a()}}else{var i=s.trim(_.target.value);if(i!=this.__cm)if(this.__cm=i,i){for(var o=[],h=this.__ew.slice(),r=this.updater.get("textKey"),f=0,n=void 0;f<h.length;f++)n=h[f],((r?n[r]:n)+"").indexOf(i)>=0&&o.push(n);this.__fX(o,!0)}else this.__fX(this.__ew,!0)}},__e:function(){var _=this.updater;if(!this.__j){this.__j=!0;_.get("rList")||_.digest({rList:!0}),o.__k(this);var t=this.__h.position();this.__cN.show().css({left:t.left+this.__cP,top:t.top+this.__h.outerHeight()+10}),this.__h.trigger("showlist")}},__eC:function(){s("#sg_"+this.id+"_"+this.__fU).removeClass("_fp")},__eD:function(_){var t=s("#sg_"+this.id+"_"+this.__fU);if(t.addClass("_fp"),!_&&t.length){this.__eF=1;var e=t.outerHeight(),i=(this.__fU+1)*e,o=this.__cN,h=o.height(),r=o.prop("scrollTop"),f=Math.ceil(h/e);i<r+e?o.prop("scrollTop",i-e):i>r+h&&o.prop("scrollTop",(this.__fU+2-f)*e)}},__a:function(){this.__j&&(this.__j=!1,o.__f(this),this.__cN.hide(),this.__h.trigger("hidelist"))},"__eG<click>":function(_){_.preventDefault();var t=_.params.item;this.__h.trigger({type:"pick",item:t,scrollTop:this.__cN.prop("scrollTop")}),this.__a()},"__eH<mouseout>":function(_){if(!i.inside(_.relatedTarget,_.eventTarget)){this.__eC(),this.__fU=-1}},"__eI<mousemove>":function(_){if(this.__eF)delete this.__eF;else{var t=s(_.target);if(t.is("li")){var e=t.data("idx");e!=this.__fU&&(this.__eC(),this.__fU=e,this.__eD(!0))}}},"__D<contextmenu>":function(_){_.preventDefault()}})});