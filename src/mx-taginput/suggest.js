define("mx-taginput/suggest",["magix","$","../mx-monitor/index"],(_,e,t)=>{var i=_("magix"),o=_("$"),s=_("../mx-monitor/index");i.applyStyle("_L","._fm{position:absolute;border:1px solid #e6e6e6;font-size:14px;max-height:260px;overflow:auto;list-style:none;border-radius:4px;background-color:#fff;display:none;z-index:10;padding:3px 0;line-height:1.8}._fn{padding:0 4px;cursor:pointer;margin:2px 0}._fo{color:#666;display:block;width:100%;padding:0 6px;height:29px;line-height:29px;border-radius:4px}._fp,._fo:active,._fo:focus,._fo:hover{color:#333;background-color:#f0f0f0}._fp{border-radius:4px;text-decoration:none;outline:0}"),t.exports=i.View.extend({tmpl:{html:'<ul mx-guid="g0" class="_fm _aj" style="width:<%=$$.width%>px;" mx-mouseout="__eH()" mx-mousemove="__eI()" mx-contextmenu="__D()">1</ul>',subs:[{keys:["width","rList","list","viewId","textKey"],path:'ul[mx-guid="g0"]',tmpl:'<%if($$.rList){for(var _=0,a;_<$$.list.length;_++){a=$$.list[_]%><li class="_fn"><a href="#" class="_fo" data-idx="<%!_%>" mx-click="__eG({item:\'<%@a%>\'})" id="sg_<%!$$.viewId%>_<%!_%>"><%=$$.textKey?a[$$.textKey]:a%></a></li><%}}%>',s:"1",attr:'style="width:<%=$$.width%>px;"',attrs:[{n:"style"}],mask:"21111"}]},init:function(_){var e=this;e.__fT=_.scrollTop||0,e.__ew=_.list||[],e.__cP=0|(_.offsetLeft||0),s.__d(),e.on("destroy",function(){s.__f(e),s.__g(),e.__h.off("keyup paste input",e.__ex).off("focus",e.__ey),o("#suggest_"+e.id).remove()}),e.updater.set({viewId:e.id,width:_.width||340,textKey:_.textKey,valueKey:_.valueKey}),e.__fU=-1,e.__fV=[e.id,"suggest_"+e.id],_.relateIds&&(e.__fV=e.__fV.concat(_.relateIds.split(",")))},__i:function(_){for(var e=this.__fV,t=0;t<e.length;t++)if(i.inside(_,e[t]))return!0;return!1},__fX:function(_,e){var t=this;e||(t.__ew=_),t.__fU=-1,t.updater.digest({list:t.__fW=_}),t.__cN&&(_&&_.length?t.__cN.addClass("_fm"):t.__cN.removeClass("_fm"))},render:function(){var _=this,e=o("#"+_.id);_.__h=e,e.on("focus",_.__ey=o.proxy(_.__e,_)).on("keyup paste input",_.__ex=o.proxy(_.__eB,_));var t="suggest_"+_.id;o("<div />").attr("id",t).insertAfter(e),_.updater.to(t),_.__fX(_.__ew),_.__cN=o("#"+t+" ul"),_.__ew&&_.__ew.length||_.__cN.removeClass("_fm"),setTimeout(_.wrapAsync(function(){_.__cN.prop("scrollTop",_.__fT)}),0)},__eB:function(_){var e=this;e.__j||e.__e();var t=e.__fW;if(40==_.keyCode)e.__eC(),e.__fU++,e.__fU>=t.length&&(e.__fU=0),e.__eD();else if(38==_.keyCode)e.__eC(),e.__fU--,e.__fU<0&&(e.__fU=t.length-1),e.__eD();else if(13==_.keyCode){if(e.__fU>-1&&e.__fU<e.__fW.length){var i=e.__fW[e.__fU];e.__h.trigger({type:"pick",item:i}),e.__eC(),e.__fU=-1,e.__b()}}else{var s=o.trim(_.target.value);if(s!=e.__cm)if(e.__cm=s,s){for(var r=[],f=e.__ew.slice(),a=e.updater.get("textKey"),n=0,l=void 0;n<f.length;n++)l=f[n],((a?l[a]:l)+"").indexOf(s)>=0&&r.push(l);e.__fX(r,!0)}else e.__fX(e.__ew,!0)}},__e:function(){var _=this,e=_.updater;if(!_.__j){_.__j=!0;e.get("rList")||e.digest({rList:!0}),s.__k(_);var t=_.__h.position();_.__cN.show().css({left:t.left+_.__cP,top:t.top+_.__h.outerHeight()+10}),_.__h.trigger("showlist")}},__eC:function(){o("#sg_"+this.id+"_"+this.__fU).removeClass("_fp")},__eD:function(_){var e=this,t=o("#sg_"+e.id+"_"+e.__fU);if(t.addClass("_fp"),!_&&t.length){e.__eF=1;var i=t.outerHeight(),s=(e.__fU+1)*i,r=e.__cN,f=r.height(),a=r.prop("scrollTop"),n=Math.ceil(f/i);s<a+i?r.prop("scrollTop",s-i):s>a+f&&r.prop("scrollTop",(e.__fU+2-n)*i)}},__b:function(){var _=this;_.__j&&(_.__j=!1,s.__f(_),_.__cN.hide(),_.__h.trigger("hidelist"))},"__eG<click>":function(_){_.preventDefault();var e=_.params.item;this.__h.trigger({type:"pick",item:e,scrollTop:this.__cN.prop("scrollTop")}),this.__b()},"__eH<mouseout>":function(_){if(!i.inside(_.relatedTarget,_.eventTarget)){var e=this;e.__eC(),e.__fU=-1}},"__eI<mousemove>":function(_){var e=this;if(e.__eF)delete e.__eF;else{var t=o(_.target);if(t.is("li")){var i=t.data("idx");i!=e.__fU&&(e.__eC(),e.__fU=i,e.__eD(!0))}}},"__D<contextmenu>":function(_){_.preventDefault()}})});