define("mx-hour/week",["magix","$","../mx-monitor/index","./index"],(t,i,e)=>{var a=t("magix"),_=t("$"),d=t("../mx-monitor/index");a.applyStyle("_x","._dB{padding:0;height:38.4px;text-align:center}._dC{text-align:left;padding-left:10px}._dD{border:none}._dE{border-right:1px solid #e6e6e6}._dF{visibility:hidden}._dG:hover ._dF{visibility:visible}._dH{position:absolute;display:none;background-color:#fff;border:1px solid #e6e6e6;border-radius:4px;padding:10px;margin-top:10px;z-index:10}._dI{margin-bottom:10px;width:300px;border-bottom:1px solid #e6e6e6}._dJ{margin:0 25px 10px 0}._dK{visibility:visible}");var s=t("./index"),n="111111111111111111111111",c="000000000000000000000000",r=function(t){var i=0;for(t=(t=(t+"").split(",")).slice(i,7);i<7;)t[i]=s.improve(t[i]),i++;return t};e.exports=a.View.extend({tmpl:{html:'<div mx-guid="g0" class="_dH" id="dlg_<%=$$.viewId%>"><div mx-guid="g1" class="_dI">2</div><div><button type="button" class="_an _ao" mx-click="__cW()">确认</button><button type="button" mx-click="__cV()" class="_an _s">取消</button></div></div><table class="_W"><thead><tr><th class="_dB" width="100">快捷设置</th><th colspan="2" class="_dB _dC"><label class="_t"><input mx-guid="g2" class="_at" type="radio" mx-change="__cT({type:0})" name="st-<%=$$.viewId%>" <%if($$.allDays){%> checked<%}%>> 全日程投放</label><label class="_v"><input mx-guid="g3" class="_at" type="radio" mx-change="__cT({type:1})" name="st-<%=$$.viewId%>" <%if($$.weekdays){%> checked<%}%>> 工作日（周一至周五）投放</label><label class="_v"><input mx-guid="g4" class="_at" type="radio" mx-change="__cT({type:2})" name="st-<%=$$.viewId%>" <%if($$.weekends){%> checked<%}%>> 休息日（周六、周日）投放</label></th></tr><tr><th class="_dB">时间</th><th class="_dB"><table class="_W"><tbody><tr><%for(var a=0;a<24;a++){%><td class="_dB _dD<%if(a<23){%> _dE<%}%>"><%=(\'0\'+a).slice(-2)%></td><%}%></tr></tbody></table></th><th width="80" class="_dB">操作</th></tr></thead><tbody mx-guid="g6">4</tbody></table>',subs:[{keys:["viewId"],path:'div[mx-guid="g0"]',attr:'id="dlg_<%=$$.viewId%>"',attrs:[{n:"id",p:1}]},{keys:["days","currentClone"],path:'div[mx-guid="g1"]',tmpl:'<%for(var _=0;_<$$.days.length;_++){%><label class="_dJ<%if(_==$$.currentClone){%> _am<%}%>"><input class="_h" type="checkbox" value="<%=_%>" <%if(_==$$.currentClone){%> disabled<%}%>>周<%=$$.days.charAt(_)%></label><%}%>',s:"2"},{keys:["viewId","allDays"],path:'input[mx-guid="g2"]',attr:'name="st-<%=$$.viewId%>" <%if($$.allDays){%> checked<%}%>',attrs:[{n:"name",p:1},{n:"checked",b:1,p:1}]},{keys:["viewId","weekdays"],path:'input[mx-guid="g3"]',attr:'name="st-<%=$$.viewId%>" <%if($$.weekdays){%> checked<%}%>',attrs:[{n:"name",p:1},{n:"checked",b:1,p:1}]},{keys:["viewId","weekends"],path:'input[mx-guid="g4"]',attr:'name="st-<%=$$.viewId%>" <%if($$.weekends){%> checked<%}%>',attrs:[{n:"name",p:1},{n:"checked",b:1,p:1}]},{keys:["days","viewId"],path:'tbody[mx-guid="g6"]',tmpl:'<%for(var b=0;b<$$.days.length;b++){%><tr class="_dG"><td class="_dB _ad" mx-click="__aQ({day:<%=b%>})">周<%=$$.days.charAt(b)%></td><td class="_dB"><table class="_W"><tbody id="hours_<%=$$.viewId%>_<%=b%>" mx-view="mx-hour/index?border=no" mx-change="__cN({day:<%=b%>})"></tbody></table></td><td class="_dB"><div class="_dF"><a mx-click="__cU({day:<%=b%>})" href="#">复制到</a></div></td></tr><%}%>',s:"4"}]},init:function(t){var i=this;i.__aR=r(t.days||[c,c,c,c,c,c,c]),d.__d(),i.__h=_("#"+i.id),i.on("destroy",function(){d.__f(i),d.__g()})},render:function(){this.updater.digest({viewId:this.id,days:"一二三四五六日"}),this.val(this.__aR)},__i:function(t){var i=a.inside(t,"dlg_"+this.id);if(!i&&this.__cQ){var e=this.__cQ.parent();i=a.inside(t,e[0])}return i},__cR:function(){var t=this.__aR.slice(0,5).join(""),i=this.__aR.slice(-2).join(""),e=t.indexOf("1")>-1,a=i.indexOf("1")>-1,_=-1==t.indexOf("0"),d=-1==i.indexOf("0"),s=_&&d;this.updater.digest({allDays:s,weekdays:!a&&_,weekends:d&&!e})},__cS:function(){for(var t=this.__aR,i=0,e=void 0,_=void 0;i<t.length;i++)e=t[i],(_=a.Vframe.get("hours_"+this.id+"_"+i))&&_.invoke("val",[e])},val:function(t){return t&&(this.__aR=r(t),this.__cS(),this.__cR()),this.__aR},__e:function(){if(!this.__j){this.__j=!0,d.__k(this);var t=this.__cQ,i=_("#dlg_"+this.id);i.show();var e=t.offset(),a=e.left+t.outerWidth()-i.outerWidth(),s=e.top+t.outerHeight()+10;i.offset({left:a,top:s}),t.parent().addClass("_dK")}},__a:function(){if(this.__j){this.__j=!1,d.__f(this),_("#dlg_"+this.id).hide();var t=this.__cQ;t&&t.parent().removeClass("_dK")}},__u:function(){var t=this.__aR;this.__h.val(t).trigger({type:"change",days:t})},"__cT<change>":function(t){switch(t.stopPropagation(),t.params.type){case 0:this.__aR=[n,n,n,n,n,n,n];break;case 1:this.__aR=[n,n,n,n,n,c,c];break;case 2:this.__aR=[c,c,c,c,c,n,n]}this.__cR(),this.__cS(),this.__u()},"__cN<change>":function(t){t.stopPropagation();var i=this;i.__aR[t.params.day]=t.range,clearTimeout(i.__cI),i.__cI=setTimeout(i.wrapAsync(function(){i.__cR()}),100),i.__u()},"__aQ<click>":function(t){var i=t.params.day,e=a.Vframe.get("hours_"+this.id+"_"+i);if(e){e.invoke("val").indexOf("0")>-1?e.invoke("val",[this.__aR[i]=n]):e.invoke("val",[this.__aR[i]=c]),this.__cR(),this.__u()}},"__cU<click>":function(t){t.preventDefault();var i=_(t.eventTarget);this.__cQ=i,this.__e(),this.updater.digest({currentClone:t.params.day})},"__cV<click>":function(){this.__a()},"__cW<click>":function(){var t=this,i=t.updater.get("currentClone"),e=t.__aR[i];_("#dlg_"+t.id+" input:checked").each(function(i,a){t.__aR[a.value]=e}),t.__a(),t.__cS(),t.__cR()}})});