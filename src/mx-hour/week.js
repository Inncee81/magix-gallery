define("mx-hour/week",["magix","$","../mx-monitor/index","./index"],(t,i,_)=>{var e=t("magix"),a=t("$"),d=t("../mx-monitor/index");e.applyStyle("_x","._dB{padding:0;height:38.4px;text-align:center}._dC{text-align:left;padding-left:10px}._dD{border:none}._dE{border-right:1px solid #e6e6e6}._dF{visibility:hidden}._dG:hover ._dF{visibility:visible}._dH{position:absolute;display:none;background-color:#fff;border:1px solid #e6e6e6;border-radius:4px;padding:10px;margin-top:10px;z-index:10}._dI{margin-bottom:10px;width:300px;border-bottom:1px solid #e6e6e6}._dJ{margin:0 25px 10px 0}._dK{visibility:visible}");var s=t("./index"),n="111111111111111111111111",r="000000000000000000000000",l=function(t){var i=0;for(t=(t=(t+"").split(",")).slice(i,7);i<7;)t[i]=s.improve(t[i]),i++;return t};_.exports=e.View.extend({tmpl:function(t){var i="",_={"&":"amp","<":"lt",">":"gt",'"':"#34","'":"#39","`":"#96"},e=/[&<>"'`]/g,a=function(t){return null==t?"":""+t},d=function(t){return"&"+_[t]+";"},s=function(t){return a(t).replace(e,d)};i+='<div class="_dH" id="dlg_'+s(t.viewId)+'"><div class="_dI">';for(var n=0;n<t.days.length;n++)i+='<label class="_dJ',n==t.currentClone&&(i+=" _am"),i+='"><input class="_h" type="checkbox" value="'+s(n)+'" ',n==t.currentClone&&(i+=" disabled"),i+="/>周"+s(t.days.charAt(n))+"</label>";i+='</div><div><button type="button" class="_an _ao" mx-click="__df()">确认</button><button type="button" mx-click="__de()" class="_an _s">取消</button></div></div><table class="_W"><thead><tr><th class="_dB" width="100">快捷设置</th><th colspan="2" class="_dB _dC"><label class="_t"><input class="_at" type="radio" mx-change="__dc({type:0})" name="st-'+s(t.viewId)+'" ',t.allDays&&(i+=" checked"),i+='/> 全日程投放</label><label class="_v"><input class="_at" type="radio" mx-change="__dc({type:1})" name="st-'+s(t.viewId)+'" ',t.weekdays&&(i+=" checked"),i+='/> 工作日（周一至周五）投放</label><label class="_v"><input class="_at" type="radio" mx-change="__dc({type:2})" name="st-'+s(t.viewId)+'" ',t.weekends&&(i+=" checked"),i+='/> 休息日（周六、周日）投放</label></th></tr><tr><th class="_dB">时间</th><th class="_dB"><table class="_W"><tbody><tr>';for(var r=0;r<24;r++)i+='<td class="_dB _dD',r<23&&(i+=" _dE"),i+='">'+s(("0"+r).slice(-2))+"</td>";i+='</tr></tbody></table></th><th width="80" class="_dB">操作</th></tr></thead><tbody>';for(var l=0;l<t.days.length;l++)i+='<tr class="_dG"><td class="_dB _ad" mx-click="__aY({day:'+s(l)+'})">周'+s(t.days.charAt(l))+'</td><td class="_dB"><table class="_W"><tbody id="hours_'+s(t.viewId)+"_"+s(l)+'" mx-view="mx-hour/index?border=no" mx-change="__cX({day:'+s(l)+'})"></tbody></table></td><td class="_dB"><div class="_dF"><a mx-click="__dd({day:'+s(l)+'})" href="#">复制到</a></div></td></tr>';return i+="</tbody></table>"},init:function(t){var i=this;i.__aZ=l(t.days||[r,r,r,r,r,r,r]),d.__f(),i.__k=a("#"+i.id),i.on("destroy",function(){d.__i(i),d.__j()})},render:function(){this.updater.digest({viewId:this.id,days:"一二三四五六日"}),this.val(this.__aZ)},__l:function(t){var i=e.inside(t,"dlg_"+this.id);if(!i&&this.__d_){var _=this.__d_.parent();i=e.inside(t,_[0])}return i},__da:function(){var t=this.__aZ.slice(0,5).join(""),i=this.__aZ.slice(-2).join(""),_=t.indexOf("1")>-1,e=i.indexOf("1")>-1,a=-1==t.indexOf("0"),d=-1==i.indexOf("0"),s=a&&d;this.updater.digest({allDays:s,weekdays:!e&&a,weekends:d&&!_})},__db:function(){for(var t=this.__aZ,i=0,_=void 0,a=void 0;i<t.length;i++)_=t[i],(a=e.Vframe.get("hours_"+this.id+"_"+i))&&a.invoke("val",[_])},val:function(t){return t&&(this.__aZ=l(t),this.__da(),this.__db()),this.__aZ},__h:function(){if(!this.__m){this.__m=!0,d.__n(this);var t=this.__d_,i=a("#dlg_"+this.id);i.show();var _=t.offset(),e=_.left+t.outerWidth()-i.outerWidth(),s=_.top+t.outerHeight()+10;i.offset({left:e,top:s}),t.parent().addClass("_dK")}},__b:function(){if(this.__m){this.__m=!1,d.__i(this),a("#dlg_"+this.id).hide();var t=this.__d_;t&&t.parent().removeClass("_dK")}},__x:function(){var t=this.__aZ;this.__k.val(t).trigger({type:"change",days:t})},"__dc<change>":function(t){switch(t.stopPropagation(),t.params.type){case 0:this.__aZ=[n,n,n,n,n,n,n];break;case 1:this.__aZ=[n,n,n,n,n,r,r];break;case 2:this.__aZ=[r,r,r,r,r,n,n]}this.__da(),this.__db(),this.__x()},"__cX<change>":function(t){t.stopPropagation();var i=this;i.__aZ[t.params.day]=t.range,clearTimeout(i.__cS),i.__cS=setTimeout(i.wrapAsync(function(){i.__da()}),100),i.__x()},"__aY<click>":function(t){var i=t.params.day,_=e.Vframe.get("hours_"+this.id+"_"+i);if(_){_.invoke("val").indexOf("0")>-1?_.invoke("val",[this.__aZ[i]=n]):_.invoke("val",[this.__aZ[i]=r]),this.__da(),this.__x()}},"__dd<click>":function(t){t.preventDefault();var i=a(t.eventTarget);this.__d_=i,this.__h(),this.updater.digest({currentClone:t.params.day})},"__de<click>":function(){this.__b()},"__df<click>":function(){var t=this,i=t.updater.get("currentClone"),_=t.__aZ[i];a("#dlg_"+t.id+" input:checked").each(function(i,e){t.__aZ[e.value]=_}),t.__b(),t.__db(),t.__da()}})});