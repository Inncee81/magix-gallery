define("mx-day/index",["magix","$","mx-dropdown/index","./month"],(e,a,t)=>{e("mx-dropdown/index"),e("./month");var n=e("magix"),_=e("$");n.applyStyle("_k","._bR{padding:0;height:38.4px}._bS{border:none}._bT{border-right:1px solid #e6e6e6}");var i=function(e,a){var t=a[e];if(!t){t=[];for(var n=12;n--;)t[n]="";a[e]=t}return t},r=[{key:"MON",day:"一"},{key:"TUE",day:"二"},{key:"WED",day:"三"},{key:"THU",day:"四"},{key:"FRI",day:"五"},{key:"SAT",day:"六"},{key:"SUN",day:"日"}];t.exports=n.View.extend({tmpl:function(e){var a="",t={"&":"amp","<":"lt",">":"gt",'"':"#34","'":"#39","`":"#96"},n=/[&<>"'`]/g,_=function(e){return null==e?"":""+e},i=function(e){return"&"+t[e]+";"},r=function(e){return _(e).replace(n,i)},s={"!":"%21","'":"%27","(":"%28",")":"%29","*":"%2A"},d=function(e){return s[e]},o=/[!')(*]/g,c=function(e){return encodeURIComponent(_(e)).replace(o,d)},h=/[\\'"]/g;a+='<table class="_W"><thead><tr><th class="_bR _a_" width="120">周期设置</th><th class="_bR _Z" colspan="31">';for(var l=0;l<e.weeks.length;l++)a+='<label class="_h _t"><input mx-change="__aV({key:\''+r((y=e.weeks[l].key,_(y).replace(h,"\\$&")))+'\'})" id="'+r(e.viewId)+"_"+r(e.weeks[l].key)+'" type="checkbox" class="_as"/>每周'+r(e.weeks[l].day)+"</label>";var y;a+='</th></tr><tr><th class="_bR _a_"><div mx-change="__aT()" style="width:100px" class="_g _s" mx-view="mx-dropdown/index?list=',a+=function(a,t,n){for(n=e[""];--n;)if(e[t=""+n]===a)return t;return e[t=""+e[""]++]=a,t}(e.years),a+="&selected="+_(c(e.selectedYear))+'"></div></th><th colspan="31" class="_bR"><table class="_W _X"><tbody><tr>';for(var m=1;m<32;m++)a+='<td class="_bR _a_ _bS',m<30&&(a+=" _bT"),a+='">'+r(("0"+m).slice(-2))+"</td>";a+="</tr></tbody></table></th></tr></thead><tbody>";for(var u=0;u<12;u++)a+='<tr><td class="_bR _ad _a_" mx-click="__aY({m:'+_(u)+'})">'+r(("0"+(u+1)).slice(-2))+'</td><td class="_bR" colspan="31" id="months_'+r(u)+"_"+r(e.viewId)+'" mx-change="__aX({m:'+_(u)+'})" mx-sync="__aX({m:'+_(u)+'})" mx-view="mx-day/month?year='+_(c(e.selectedYear))+"&month="+_(c(u))+"&selected="+_(c(e.days[u]))+'"></td></tr>';return a+="</tbody></table>"},init:function(e){this.assign(e);var a=_("#"+this.id);this.__k=a},assign:function(e){return e.years||(e.years=[(new Date).getFullYear()]),this.__aO=e.years,this.__aP=e.selectedYear||e.years[0],this.__aQ=function(e){e=e||{};for(var a in e){var t=e[a];(t=((t=t||"")+"").split(",")).length>12&&(t=t.slice(0,12));for(var n=0;n<12;n++)t[n]||(t[n]="");e[a]=t}return e}(e.selectedDays),!0},render:function(){var e=this.__aP,a=i(e,this.__aQ);this.updater.digest({viewId:this.id,weeks:r,years:this.__aO,selectedYear:e,days:a})},__aS:function(){for(var e={},a=r.length;a--;)e[r[a].key]=1;this.__k.find('[mx-view*="mx-day/month"]').each(function(a,t){for(var n=t.vframe.invoke("__aR"),_=n.length;_--;)delete e[n[_]]});for(a=r.length;a--;){var t=r[a].key;_("#"+this.id+"_"+t).prop("checked",!!e[t])}},"__aT<change>":function(e){e.stopPropagation();var a=i(e.value,this.__aQ);this.updater.digest({days:a,selectedYear:this.__aP=e.value})},__x:function(){var e=this.__aQ;this.__k.val(e).trigger({type:"change",days:e})},"__aV<change>":function(e){e.stopPropagation();this.__k.find('[mx-view*="mx-day/month"]').each(function(a,t){var n=t.vframe;n&&n.invoke("__aU",[e.params.key,e.eventTarget.checked])}),this.__x()},"__aX<change,sync>":function(e){e.stopPropagation();var a=this;i(a.__aP,a.__aQ)[e.params.m]=e.days,e.ignoreSync||(clearTimeout(a.__aW),a.__aW=setTimeout(function(){a.__aS()},20)),"change"==e.type&&a.__x()},"__aY<click>":function(e){var a=e.params.m,t=_("#months_"+a+"_"+this.id),n=i(this.__aP,this.__aQ)[a];n=new Array(n.length+1).join(n.indexOf("0")>-1?"1":0),t.invokeView("__s",[n]),this.__x()}})});