define("mx-dragsort/index",["magix","../mx-dragdrop/index","../mx-runner/index","$"],(_,t,e)=>{var i=_("magix"),h=_("../mx-dragdrop/index"),o=_("../mx-runner/index"),n=_("$");i.applyStyle("_n",'._ce{left:-1000px;top:0;background:#f96447}._ce,._cf{position:absolute}._cf{width:26px;height:26px}._cg{background:#479b47}._ch{background:#e94f4f}._cf:after{font-size:20px;line-height:26px;color:#fff;position:absolute;left:0;right:0;top:0;bottom:0;text-align:center}._cg:after{content:"✓"}._ch:after{content:"✗"}');var s=i.guid("dbar_"),b=i.guid("pt_"),d=n(window),r=n(document),a={__bi:function(){n("#"+s).length||n('<div class="_ce" id="'+s+'"/>').appendTo("body")},__aR:function(_){_.child&&(n(_.child).css({opacity:.4}),this.__bi())},__bb:function(_){_.child&&n(_.child).css({opacity:1}),this.__bj(),this.__bk()},__bj:function(){n("#"+s).css({left:-1e5})},__bl:function(_,t){var e=n("#"+s),i=!1;2&_.anchor&&(2&t?(e.css({height:2,width:_.bound.width,top:_.bound.y-1,left:_.bound.x}),i=!0):8&t&&(e.css({height:2,width:_.bound.width,top:_.bound.y+_.bound.height-1,left:_.bound.x}),i=!0)),!i&&1&_.anchor&&(1&t?e.css({height:_.bound.height,width:2,top:_.bound.y,left:_.bound.x-1}):4&t&&e.css({height:_.bound.height,width:2,top:_.bound.y,left:_.bound.x+_.bound.width-1}))},__bn:function(_){_.atPlace&&_.child!=_.hover?(3==_.anchor?_.__bm&&this.__bl(_,_.side):_.__bn&&this.__bl(_,_.position),this.__bo(!0)):(this.__bj(),this.__bo())},__bp:function(_){var t=n("#"+b);t.length||(t=n('<div class="_cf" id="'+b+'"/>')).appendTo("body");var e=Math.max(0,Math.min(_.pageX+10,r.width()-t.width())),i=Math.max(0,Math.min(_.pageY+18,r.height()-t.height()));t.css({left:e,top:i,display:"block"})},__bo:function(_){var t=n("#"+b);_?t.removeClass("_ch").addClass("_cg"):t.addClass("_ch").removeClass("_cg")},__bk:function(){n("#"+b).hide()}};e.exports=i.View.extend({init:function(_){var t=this,e=n("#"+t.id);e.on("mousedown",_.selector,function(_){_.preventDefault(),t.__aR(_)}),t.on("destroy",function(){e.off("mousedown")}),t.__h=e;var h=[e.get(0)];_.drops&&(h=h.concat(_.drops.split(","))),t.__bq=h;var o=_.horizonal+""=="true",s=_.vertical+""=="true";o||s||(s=!0);var b=0;o&&(b|=1),s&&(b|=2),t.__br=b;var d=!0;i.has(_,"sort")&&(d=_.sort+""=="true"),t.__bs=d},__bt:function(_){for(var t=0,e=this.__bq;t<e.length;t++){var h=e[t];if(i.inside(_,h))return i.node(h)}return null},__aT:function(_,t){var e=null;if(t||(t=this.__bt(_)),!this.__bs&&this.__bu)return{child:this.__bu,zone:t};for(;t!=_;){if(_.parentNode==t){e=_;break}_=_.parentNode}return!t||t.firstChild||e||(e=t),e&&"false"===e.getAttribute("ds-draggable")&&(e=null),{child:e,zone:t}},__bw:function(_,t){var e=0,i=0,h=-1,o=-1,n=-1,s=-1,b=!1;if(t.pageX>=_.x&&t.pageX<=_.x+_.width&&t.pageY>=_.y&&t.pageY<=_.y+_.height&&(e|=t.pageX<=_.x+_.width/2?1:4,h=t.pageX-_.x,n=_.x+_.width-t.pageX,e|=t.pageY<=_.y+_.height/2?2:8,o=t.pageY-_.y,s=_.y+_.height-t.pageY,b=!0),b){var d=Math.min(h,o,n,s);d>-1&&(d==h?i=1:d==o?i=2:d==n?i=4:d==s&&(i=8))}var r=this.__bv;return r&&r.zone===r.hover&&(e=2,i=1),{position:e,atPlace:b,side:i}},__aR:function(_){if(1===_.which){var t=this,e=t.__aT(_.target);e.child&&(t.__bu=e.child,t.__bx=e.zone,t.__h.trigger({type:"dragbegin",dragNode:e.child,dragZone:e.zone}),a.__aR(e),h.begin(e.zone,function(_){t.__ba(_)},function(_){t.__bb(_)}))}},__bA:function(_,t,e){var i=this.__bw(_,t),h=i.side!=this.__by,o=i.position!=this.__bz;(h||o)&&(this.__by=i.side,this.__bz=i.position,e.__bm=h,e.__bn=o,e.side=i.side,e.position=i.position,e.atPlace=i.atPlace,e.anchor=this.__br,a.__bn(e))},__ba:function(_){var t=h.fromPoint(_.clientX,_.clientY);if(a.__bp(_),this.__bc=_,this.__aS=!0,this.__bB(),this.__bd(),this.__bC||this.__bD||!t)return delete this.__bE,delete this.__by,void delete this.__bz;if(this.__bE!=t){if(t.id===s)return;this.__bE=t,delete this.__by;var e=this.__bt(t);if(e){e!=this.__bF&&(this.__bF=e,this.__h.trigger({type:"enterzone",zone:e,changePointer:a.__bo}));var o=this.__aT(t,e);if(!o.child)return;var b=n(o.child),d=b.offset(),r={x:d.left,y:d.top,width:b.outerWidth(),height:b.outerHeight()};d=(b=n(o.zone)).offset(),this.__bG={x:d.left,y:d.top,scrollX:b.prop("scrollLeft"),scrollY:b.prop("scrollTop"),maxWidth:b.prop("scrollWidth"),maxHeight:b.prop("scrollHeight"),width:b.width(),height:b.height()},this.__bA(this.__bH=r,_,this.__bv={child:this.__bu,bound:r,zone:o.zone,hover:o.child})}else this.__bF&&(this.__h.trigger({type:"leavezone",zone:this.__bF,changePointer:a.__bo}),delete this.__bF)}else this.__bH&&i.inside(t,this.__bv.zone)?this.__bA(this.__bH,_,this.__bv):(delete this.__by,delete this.__bz,this.__bs&&(a.__bj(),a.__bo()))},__bb:function(){this.__bI(),this.__be(),a.__bb({child:this.__bu});var _=this.__bz,t=this.__by,e=this.__aS,i=this.__bv,h=this.__bu;if(e&&(_||t)){var o=i.zone,n=this.__br,s=3===n?t:_;if(1&n&&1&s||2&s&&2&n)i.hover==o?o.appendChild(h):o.insertBefore(h,i.hover);else if(8&s&&2&n||4&s&&1&n){for(var b=i.hover.nextSibling;b&&1!=b.nodeType;)b=b.nextSibling;o.insertBefore(h,b),b||(o.scrollTop=o.scrollHeight)}}i&&this.__h.trigger({type:"dragfinish",moved:e,dragNode:h,dragZone:this.__bx,dropNode:i.hover,dropZone:i.zone,outZone:!this.__bF}),delete this.__bu,delete this.__bx,delete this.__bE,delete this.__bv,delete this.__bH,delete this.__bz,delete this.__by,delete this.__bc,delete this.__bD,delete this.__bF,delete this.__bG,delete this.__bC,delete this.__aS},__bB:function(){var _=this;_.__bJ||(_.__bJ=function(){var t=_.__bG;if(t){var e=_.__bv.zone,i=0,h=0,o=_.__bc;o.pageX>t.x&&o.pageY>t.y&&o.pageX<t.x+t.width&&o.pageY<t.y+t.height?(o.pageX-t.x<20&&t.scrollX>0?i=-Math.min(7,t.scrollX):t.x+t.width-o.pageX<20&&t.scrollX+t.width<t.maxWidth&&(i=Math.min(7,t.maxWidth-t.scrollX-t.width)),o.pageY-t.y<20&&t.scrollY>0?h=-Math.min(7,t.scrollY):t.y+t.height-o.pageY<20&&t.scrollY+t.height<t.maxHeight&&(h=Math.min(7,t.maxHeight-t.scrollY-t.height)),i||h?(_.__bC=!0,_.__bK=!0,e.scrollTop+=h,e.scrollLeft+=i,t.scrollX+=i,t.scrollY+=h,delete _.__aS,a.__bj(),a.__bo()):(delete _.__bC,delete _.__bK)):(delete _.__bC,delete _.__bK)}},o.__bg(30,_.__bJ))},__bd:function(){var _=this;_.__bf||(_.__bf=function(){if(!_.__bK){var t=0,e=0,i=_.__bc,h=d.scrollTop(),o=d.height(),n=r.height(),s=r.width(),b=d.width(),l=d.scrollLeft();i.pageX-l<20&&l>0?t=-Math.min(7,l):l+b-i.pageX<20&&l+b<s&&(t=Math.min(7,s-b-l)),i.pageY-h<20&&h>0?e=-Math.min(7,h):h+o-i.pageY<20&&h+o<n&&(e=Math.min(7,n-o-h)),t||e?(_.__bD=!0,i.pageX+=t,i.pageY+=e,window.scrollBy(t,e),delete _.__aS,a.__bj(),a.__bp(i),a.__bo()):delete _.__bD}},o.__bg(30,_.__bf))},__bI:function(){this.__bJ&&(o.__bh(this.__bJ),delete this.__bJ,delete this.__bK)},__be:function(){this.__bf&&(o.__bh(this.__bf),delete this.__bf)}})});