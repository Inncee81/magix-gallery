define("mx-calendar/range",["magix","$","./index","./datepicker"],(t,e,i)=>{t("./datepicker");var a=t("magix"),n=t("$"),r=t("./index"),s=r.parse,d=r.format;a.applyStyle("_h","._bl{border:1px solid #e6e6e6;padding:10px 0;border-radius:4px;background-color:#fff;width:265px;position:relative;z-index:10}._bm{padding:0 10px}._bn{height:24px;line-height:24px;border-radius:4px;margin:0 10px 10px 0;width:70px;float:left;text-align:center;display:inline-block;cursor:pointer}._bn:hover{background:#e6e6e6}._bo,._bo:hover{color:#fff;background:#f96447}._bp{padding:0 10px;margin-bottom:15px}._bq{background-color:#f0f0f0;border:0;height:24px;width:117px;text-align:center;display:inline-block;color:#333;border-radius:4px;padding:6px 9px;cursor:text}._br{border-top:1px solid #e6e6e6;margin-left:10px;padding-top:10px;width:92%}._bs{width:330px}._bs ._bq{width:150px}");var _=function(t,e){e||(e=new Date);var i=new Date(e.getTime()+864e5*t);return i=i.getFullYear()+"/"+(i.getMonth()+1)+"/"+i.getDate(),new Date(i)},o=function(t){return(t=new Date(t)).setHours(23),t.setMinutes(59),t.setSeconds(59),t},c=_(0),h=_(-1),p=function(t){var e=_(-7),i=t-e.getDay();return{start:_(i,e),end:o(_(i+6,e))}},l=p(0),u=p(1),g=function(){var t=new Date(c.getFullYear(),c.getMonth()-1,1),e=t.getFullYear(),i=t.getMonth(),a=32-new Date(e,i,32).getDate();return{start:t,end:o(new Date(e,i,a))}}();g.text="上月",l.text="上周（周日至周六）",u.text="上周（周一至周日）";for(var x={today:{text:"今天",start:c,end:o(c)},yesterday:{text:"昨天",start:h,end:o(h)},preMonth:g,preWeekSun:l,preWeekMon:u,passedThisMonth:{text:"本月",start:_(1-c.getDate()),end:o(h)},lastestThisMonth:{text:"本月",start:_(1-c.getDate()),end:o(c)}},m=[2,6,13,14,29,89],v=0,f=void 0,k=void 0;v<m.length;v++)x["passed"+(k=(f=m[v])+1)]={text:"过去"+k+"天",start:_(-k),end:o(h)},x["lastest"+k]={text:"最近"+k+"天",start:_(-f),end:o(c)};var b=["preMonth","preWeekMon","preWeekSun","passedThisMonth","lastestThisMonth"],D=a.View.extend({tmpl:function(t,e){var i="",a={"&":"amp","<":"lt",">":"gt",'"':"#34","'":"#39","`":"#96"},n=/[&<>"'`]/g,r=function(t){return null==t?"":""+t},s=function(t){return"&"+a[t]+";"},d=function(t){return r(t).replace(n,s)},_=/[\\'"]/g;if(i+='<div class="_bl',e.showTime&&(i+=" _bs"),i+=' _aj" mx-contextmenu="__F()">',e.quickDates.length){i+='<div class="_bm"><div class="_n">快捷日期</div><div class="_ai">';for(var o=0;o<e.quickDates.length;o++){var c=e.quickDates[o],h=e.quickDatesMap[c];i+='<span class="_bn _al',e.dates.quickDateKey==c&&(i+=" _bo"),i+='" mx-click="__p({quick:true,key:\''+d((p=c,r(p).replace(_,"\\$&")))+'\'})" title="'+d(h?h.text:c)+'">'+d(h?h.text:c)+"</span>"}i+="</div></div>"}var p;return i+='<div class="_bp"><div class="_n">日期范围</div><div class="_ai"><input class="_bq" readonly="readonly" data-hidden="'+d(e.dates.startStr)+'" value="'+d(e.dates.startStr)+'" mx-click="__R({first:true})" id="start_'+d(e.id)+'" mx-change="__Q()"><div mx-view="mx-calendar/datepicker" class="_af _ah"></div>-<input readonly="readonly" class="_bq" data-hidden="'+d(e.dates.endStr)+'" value="'+d(e.dates.endStr)+'" mx-click="__R()" id="end_'+d(e.id)+'" mx-change="__Q()"><div mx-view="mx-calendar/datepicker" class="_af _ah"></div></div></div><div class="_br _ai"><button mx-click="__p()" type="button" class="_an _ao">确定</button><button mx-click="__S()" type="button" class="_an _s">取消</button></div></div>'},init:function(t){this.__G=t.min,this.__H=t.max,this.__I=t.dates,this.__J=t.quickDates||[],this.__K=t.placement,this.__L=t.align,this.__M=t.timeType,this.__N=t.dateType,this.__O=t.formatter},__k:function(t){var e=a.inside(t,this.id);if(!e)for(var i=this.owner.children(),n=i.length-1;n>=0;n--){var r=a.Vframe.get(i[n]);if(r&&(e=r.invoke("inside",[t])),e)break}return e},render:function(){this.updater.digest({id:this.id,showTime:this.__M,quickDatesMap:x,quickDates:this.__J,dates:this.__I}),this.__j=n("#"+this.id)},__P:function(){this.updater.digest({dates:this.__I})},"__Q<change>":function(t){t.stopPropagation(),n(t.eventTarget).data("hidden",t.date+(t.time?" "+t.time:""));var e=n("#start_"+this.id).data("hidden"),i=n("#end_"+this.id).data("hidden"),a=this.updater.get("dates"),r=s(e,a.formatter);s(i,a.formatter).getTime()<r.getTime()&&(i=e,n("#end_"+this.id).data("hidden",i)),a=D.getDescription(e,i,this.__J,this.__O),this.updater.digest({dates:a})},"__R<click>":function(t){var e=t.eventTarget,i=t.params,a={max:this.__H,min:this.__G,timeType:this.__M,dateType:this.__N,selected:e.value,placement:this.__K,align:this.__L};i.first||(a.min=(r=n("#start_"+this.id).data("hidden"),(r=new Date(r)).setHours(0),r.setMinutes(0),r.setSeconds(0),r));var r;e.vframe?e.vframe.invoke("update",[a]):this.owner.mountVframe(e.id,"mx-calendar/datepicker",a).invoke("__g")},"__p<click>":function(t){var e,i,a,r,s=t.params,_=this.updater,o=_.get("dates");if(s.quick){o.quickDateKey=s.key;var c=x[s.key];e=c.start,i=c.end,a=d(e,o.formatter),r=d(i,o.formatter),n("#start_"+this.id).data("hidden",a),n("#end_"+this.id).data("hidden",r),o.startStr=a,o.endStr=r,o.start=e,o.end=i,o.quickDateText=c.text,_.digest({dates:o})}else a=n("#start_"+this.id).data("hidden"),r=n("#end_"+this.id).data("hidden"),o=D.getDescription(a,r,this.__J,this.__O),_.digest({dates:o});this.__j.trigger({type:"change",dates:this.__I=o})},"__S<click>":function(){this.__j.trigger("cancel"),this.__P()},"__F<contextmenu>":function(t){t.preventDefault()}},{getSupportQuickDates:function(){return x},getDescription:function(t,e,i,n){var r,_={start:t=s(t),end:e=s(e),startStr:d(t,n),endStr:d(e,n),formatter:n},o=c.getTime(),p=h.getTime(),l=t.getTime(),u=e.getTime();if(l==u)o==u?r="today":p==u&&(r="yesterday");else{var g=(u-l)/864e5+1;p==u?x[r="passed"+g]||(r=0):o==u&&(x[r="lastest"+g]||(r=0))}if(!r)for(var m=b.length-1;m>-1;m--){var v=b[m],f=x[v];if(u==f.end.getTime()&&l==f.start.getTime()){r=v;break}}return r&&i&&(a.toMap(i)[r]||(r=0)),r&&(_.quickDateText=x[r].text,_.quickDateKey=r),_}});i.exports=D});