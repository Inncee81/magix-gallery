define("mx-calendar/range",["magix","$","./index","./datepicker"],(t,e,i)=>{t("./datepicker");var a=t("magix"),n=t("$"),s=t("./index"),r=s.parse,d=s.format;a.applyStyle("_h","._bl{border:1px solid #e6e6e6;padding:10px 0;border-radius:4px;background-color:#fff;width:265px;position:relative;z-index:10}._bm{padding:0 10px}._bn{height:24px;line-height:24px;border-radius:4px;margin:0 10px 10px 0;width:70px;float:left;text-align:center;display:inline-block;cursor:pointer}._bn:hover{background:#e6e6e6}._bo,._bo:hover{color:#fff;background:#f96447}._bp{padding:0 10px;margin-bottom:15px}._bq{background-color:#f0f0f0;border:0;height:24px;width:117px;text-align:center;display:inline-block;color:#333;border-radius:4px;padding:6px 9px;cursor:text}._br{border-top:1px solid #e6e6e6;margin-left:10px;padding-top:10px;width:92%}._bs{width:330px}._bs ._bq{width:150px}");var _=function(t,e){e||(e=new Date);var i=new Date(e.getTime()+864e5*t);return i=i.getFullYear()+"/"+(i.getMonth()+1)+"/"+i.getDate(),new Date(i)},o=function(t){return(t=new Date(t)).setHours(23),t.setMinutes(59),t.setSeconds(59),t},c=_(0),h=_(-1),l=function(t){var e=_(-7),i=t-e.getDay();return{start:_(i,e),end:o(_(i+6,e))}},p=l(0),u=l(1),x=function(){var t=new Date(c.getFullYear(),c.getMonth()-1,1),e=t.getFullYear(),i=t.getMonth(),a=32-new Date(e,i,32).getDate();return{start:t,end:o(new Date(e,i,a))}}();x.text="上月",p.text="上周（周日至周六）",u.text="上周（周一至周日）";for(var g={today:{text:"今天",start:c,end:o(c)},yesterday:{text:"昨天",start:h,end:o(h)},preMonth:x,preWeekSun:p,preWeekMon:u,passedThisMonth:{text:"本月",start:_(1-c.getDate()),end:o(h)},lastestThisMonth:{text:"本月",start:_(1-c.getDate()),end:o(c)}},m=[2,6,13,14,29,89],v=0,f=void 0,k=void 0;v<m.length;v++)g["passed"+(k=(f=m[v])+1)]={text:"过去"+k+"天",start:_(-k),end:o(h)},g["lastest"+k]={text:"最近"+k+"天",start:_(-f),end:o(c)};var b=["preMonth","preWeekMon","preWeekSun","passedThisMonth","lastestThisMonth"],D=a.View.extend({tmpl:function(t,e){e=e||"";var i="",a={"&":"amp","<":"lt",">":"gt",'"':"#34","'":"#39","`":"#96"},n=/[&<>"'`]/g,s=function(t){return null==t?"":""+t},r=function(t){return"&"+a[t]+";"},d=function(t){return s(t).replace(n,r)},_=/[\\'"]/g;if(i+='<div class="_bl',t.showTime&&(i+=" _bs"),i+=' _aj" mx-contextmenu="'+e+'__G()">',t.quickDates.length){i+='<div mxa="_0:_" class="_bm"><div mxs="_0:_" class="_n">快捷日期</div><div mxa="_0:a" class="_ai">';for(var o=0;o<t.quickDates.length;o++){var c=t.quickDates[o],h=t.quickDatesMap[c];i+='<span class="_bn _al',t.dates.quickDateKey==c&&(i+=" _bo"),i+='" mx-click="'+e+"__q({quick:true,key:'"+d((l=c,s(l).replace(_,"\\$&")))+'\'})" title="'+d(h?h.text:c)+'">'+d(h?h.text:c)+"</span>"}i+="</div></div>"}var l;return i+='<div mxa="_0:b" class="_bp"><div mxs="_0:a" class="_n">日期范围</div><div mxa="_0:a" class="_ai"><input class="_bq" readonly="readonly" data-hidden="'+d(t.dates.startStr)+'" value="'+d(t.dates.startStr)+'" mx-click="'+e+'__S({first:true})" id="start_'+d(t.id)+'" mx-change="'+e+'__R()"/><div mxs="_0:b" mx-view="mx-calendar/datepicker" class="_af _ah"></div>-<input readonly="readonly" class="_bq" data-hidden="'+d(t.dates.endStr)+'" value="'+d(t.dates.endStr)+'" mx-click="'+e+'__S()" id="end_'+d(t.id)+'" mx-change="'+e+'__R()"/><div mxs="_0:b" mx-view="mx-calendar/datepicker" class="_af _ah"></div></div></div><div mxs="_0:c" class="_br _ai"><button mx-click="'+e+'__q()" type="button" class="_an _ao">确定</button><button mx-click="'+e+'__T()" type="button" class="_an _s">取消</button></div></div>'},init:function(t){this.__H=t.min,this.__I=t.max,this.__J=t.dates,this.__K=t.quickDates||[],this.__L=t.placement,this.__M=t.align,this.__N=t.timeType,this.__O=t.dateType,this.__P=t.formatter},__l:function(t){var e=a.inside(t,this.id);if(!e)for(var i=this.owner.children(),n=i.length-1;n>=0;n--){var s=a.Vframe.get(i[n]);if(s&&(e=s.invoke("inside",[t])),e)break}return e},render:function(){this.updater.digest({id:this.id,showTime:this.__N,quickDatesMap:g,quickDates:this.__K,dates:this.__J}),this.__k=n("#"+this.id)},__Q:function(){this.updater.digest({dates:this.__J})},"__R<change>":function(t){t.stopPropagation(),n(t.eventTarget).data("hidden",t.date+(t.time?" "+t.time:""));var e=n("#start_"+this.id).data("hidden"),i=n("#end_"+this.id).data("hidden"),a=this.updater.get("dates"),s=r(e,a.formatter);r(i,a.formatter).getTime()<s.getTime()&&(i=e,n("#end_"+this.id).data("hidden",i)),a=D.getDescription(e,i,this.__K,this.__P),this.updater.digest({dates:a})},"__S<click>":function(t){var e=t.eventTarget,i=t.params,a={max:this.__I,min:this.__H,timeType:this.__N,dateType:this.__O,selected:e.value,placement:this.__L,align:this.__M};i.first||(a.min=(s=n("#start_"+this.id).data("hidden"),(s=new Date(s)).setHours(0),s.setMinutes(0),s.setSeconds(0),s));var s;e.vframe?e.vframe.invoke("update",[a]):this.owner.mountVframe(e.id,"mx-calendar/datepicker",a).invoke("__e")},"__q<click>":function(t){var e,i,a,s,r=t.params,_=this.updater,o=_.get("dates");if(r.quick){o.quickDateKey=r.key;var c=g[r.key];e=c.start,i=c.end,a=d(e,o.formatter),s=d(i,o.formatter),n("#start_"+this.id).data("hidden",a),n("#end_"+this.id).data("hidden",s),o.startStr=a,o.endStr=s,o.start=e,o.end=i,o.quickDateText=c.text,_.digest({dates:o})}else a=n("#start_"+this.id).data("hidden"),s=n("#end_"+this.id).data("hidden"),o=D.getDescription(a,s,this.__K,this.__P),_.digest({dates:o});this.__k.trigger({type:"change",dates:this.__J=o})},"__T<click>":function(){this.__k.trigger("cancel"),this.__Q()},"__G<contextmenu>":function(t){t.preventDefault()}},{getSupportQuickDates:function(){return g},getDescription:function(t,e,i,n){var s,_={start:t=r(t),end:e=r(e),startStr:d(t,n),endStr:d(e,n),formatter:n},o=c.getTime(),l=h.getTime(),p=t.getTime(),u=e.getTime();if(p==u)o==u?s="today":l==u&&(s="yesterday");else{var x=(u-p)/864e5+1;l==u?g[s="passed"+x]||(s=0):o==u&&(g[s="lastest"+x]||(s=0))}if(!s)for(var m=b.length-1;m>-1;m--){var v=b[m],f=g[v];if(u==f.end.getTime()&&p==f.start.getTime()){s=v;break}}return s&&i&&(a.toMap(i)[s]||(s=0)),s&&(_.quickDateText=g[s].text,_.quickDateKey=s),_}});i.exports=D});