define("mx-calendar/range",["magix","$","./index","./datepicker"],(t,e,i)=>{t("./datepicker");var a=t("magix"),n=t("$"),r=t("./index"),s=r.parse,d=r.format;a.applyStyle("_h","._bl{border:1px solid #e6e6e6;padding:10px 0;border-radius:4px;background-color:#fff;width:265px;position:relative;z-index:10}._bm{padding:0 10px}._bn{height:24px;line-height:24px;border-radius:4px;margin:0 10px 10px 0;width:70px;float:left;text-align:center;display:inline-block;cursor:pointer}._bn:hover{background:#e6e6e6}._bo,._bo:hover{color:#fff;background:#f96447}._bp{padding:0 10px;margin-bottom:15px}._bq{background-color:#f0f0f0;border:0;height:24px;width:117px;text-align:center;display:inline-block;color:#333;border-radius:4px;padding:6px 9px;cursor:text}._br{border-top:1px solid #e6e6e6;margin-left:10px;padding-top:10px;width:92%}._bs{width:330px}._bs ._bq{width:150px}");var _=function(t,e){e||(e=new Date);var i=new Date(e.getTime()+864e5*t);return i=i.getFullYear()+"/"+(i.getMonth()+1)+"/"+i.getDate(),new Date(i)},o=function(t){return(t=new Date(t)).setHours(23),t.setMinutes(59),t.setSeconds(59),t},c=_(0),h=_(-1),l=function(t){var e=_(-7),i=t-e.getDay();return{start:_(i,e),end:o(_(i+6,e))}},p=l(0),u=l(1),g=function(){var t=new Date(c.getFullYear(),c.getMonth()-1,1),e=t.getFullYear(),i=t.getMonth(),a=32-new Date(e,i,32).getDate();return{start:t,end:o(new Date(e,i,a))}}();g.text="上月",p.text="上周（周日至周六）",u.text="上周（周一至周日）";for(var x={today:{text:"今天",start:c,end:o(c)},yesterday:{text:"昨天",start:h,end:o(h)},preMonth:g,preWeekSun:p,preWeekMon:u,passedThisMonth:{text:"本月",start:_(1-c.getDate()),end:o(h)},lastestThisMonth:{text:"本月",start:_(1-c.getDate()),end:o(c)}},m=[2,6,13,14,29,89],v=0,f=void 0,k=void 0;v<m.length;v++)x["passed"+(k=(f=m[v])+1)]={text:"过去"+k+"天",start:_(-k),end:o(h)},x["lastest"+k]={text:"最近"+k+"天",start:_(-f),end:o(c)};var b=["preMonth","preWeekMon","preWeekSun","passedThisMonth","lastestThisMonth"],D=a.View.extend({tmpl:function(t){var e="",i={"&":"amp","<":"lt",">":"gt",'"':"#34","'":"#39","`":"#96"},a=/[&<>"'`]/g,n=function(t){return null==t?"":""+t},r=function(t){return"&"+i[t]+";"},s=function(t){return n(t).replace(a,r)},d=/[\\'"]/g;if(e+='<div class="_bl',t.showTime&&(e+=" _bs"),e+=' _aj" mx-contextmenu="__G()">',t.quickDates.length){e+='<div class="_bm"><div class="_n">快捷日期</div><div class="_ai">';for(var _=0;_<t.quickDates.length;_++){var o=t.quickDates[_],c=t.quickDatesMap[o];e+='<span class="_bn _al',t.dates.quickDateKey==o&&(e+=" _bo"),e+='" mx-click="__q({quick:true,key:\''+s((h=o,n(h).replace(d,"\\$&")))+'\'})" title="'+s(c?c.text:o)+'">'+s(c?c.text:o)+"</span>"}e+="</div></div>"}var h;return e+='<div class="_bp"><div class="_n">日期范围</div><div class="_ai"><input class="_bq" readonly="readonly" data-hidden="'+s(t.dates.startStr)+'" value="'+s(t.dates.startStr)+'" mx-click="__S({first:true})" id="start_'+s(t.id)+'" mx-change="__R()"/><div mx-view="mx-calendar/datepicker" class="_af _ah"></div>-<input readonly="readonly" class="_bq" data-hidden="'+s(t.dates.endStr)+'" value="'+s(t.dates.endStr)+'" mx-click="__S()" id="end_'+s(t.id)+'" mx-change="__R()"/><div mx-view="mx-calendar/datepicker" class="_af _ah"></div></div></div><div class="_br _ai"><button mx-click="__q()" type="button" class="_an _ao">确定</button><button mx-click="__T()" type="button" class="_an _s">取消</button></div></div>'},init:function(t){this.__H=t.min,this.__I=t.max,this.__J=t.dates,this.__K=t.quickDates||[],this.__L=t.placement,this.__M=t.align,this.__N=t.timeType,this.__O=t.dateType,this.__P=t.formatter},__l:function(t){var e=a.inside(t,this.id);if(!e)for(var i=this.owner.children(),n=i.length-1;n>=0;n--){var r=a.Vframe.get(i[n]);if(r&&(e=r.invoke("inside",[t])),e)break}return e},render:function(){this.updater.digest({id:this.id,showTime:this.__N,quickDatesMap:x,quickDates:this.__K,dates:this.__J}),this.__k=n("#"+this.id)},__Q:function(){this.updater.digest({dates:this.__J})},"__R<change>":function(t){t.stopPropagation(),n(t.eventTarget).data("hidden",t.date+(t.time?" "+t.time:""));var e=n("#start_"+this.id).data("hidden"),i=n("#end_"+this.id).data("hidden"),a=this.updater.get("dates"),r=s(e,a.formatter);s(i,a.formatter).getTime()<r.getTime()&&(i=e,n("#end_"+this.id).data("hidden",i)),a=D.getDescription(e,i,this.__K,this.__P),this.updater.digest({dates:a})},"__S<click>":function(t){var e=t.eventTarget,i=t.params,a={max:this.__I,min:this.__H,timeType:this.__N,dateType:this.__O,selected:e.value,placement:this.__L,align:this.__M};i.first||(a.min=(r=n("#start_"+this.id).data("hidden"),(r=new Date(r)).setHours(0),r.setMinutes(0),r.setSeconds(0),r));var r;e.vframe?e.vframe.invoke("update",[a]):this.owner.mountVframe(e.id,"mx-calendar/datepicker",a).invoke("__h")},"__q<click>":function(t){var e,i,a,r,s=t.params,_=this.updater,o=_.get("dates");if(s.quick){o.quickDateKey=s.key;var c=x[s.key];e=c.start,i=c.end,a=d(e,o.formatter),r=d(i,o.formatter),n("#start_"+this.id).data("hidden",a),n("#end_"+this.id).data("hidden",r),o.startStr=a,o.endStr=r,o.start=e,o.end=i,o.quickDateText=c.text,_.digest({dates:o})}else a=n("#start_"+this.id).data("hidden"),r=n("#end_"+this.id).data("hidden"),o=D.getDescription(a,r,this.__K,this.__P),_.digest({dates:o});this.__k.trigger({type:"change",dates:this.__J=o})},"__T<click>":function(){this.__k.trigger("cancel"),this.__Q()},"__G<contextmenu>":function(t){t.preventDefault()}},{getSupportQuickDates:function(){return x},getDescription:function(t,e,i,n){var r,_={start:t=s(t),end:e=s(e),startStr:d(t,n),endStr:d(e,n),formatter:n},o=c.getTime(),l=h.getTime(),p=t.getTime(),u=e.getTime();if(p==u)o==u?r="today":l==u&&(r="yesterday");else{var g=(u-p)/864e5+1;l==u?x[r="passed"+g]||(r=0):o==u&&(x[r="lastest"+g]||(r=0))}if(!r)for(var m=b.length-1;m>-1;m--){var v=b[m],f=x[v];if(u==f.end.getTime()&&p==f.start.getTime()){r=v;break}}return r&&i&&(a.toMap(i)[r]||(r=0)),r&&(_.quickDateText=x[r].text,_.quickDateKey=r),_}});i.exports=D});