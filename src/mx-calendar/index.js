define("mx-calendar/index",["magix","$","mx-time/index"],(e,t,a)=>{e("mx-time/index");var i=e("magix");i.applyStyle("_h","._aY{background-color:#fff;display:inline-block;border:1px solid #e6e6e6;padding:0;border-radius:4px;overflow-y:hidden;z-index:10;color:#333;text-align:center;position:relative}._aZ{color:#777}._b_{height:32px;line-height:32px;padding:1px}._ba,._bb{color:#ccc;display:inline-block;padding:6px 7px;line-height:100%;vertical-align:top;cursor:pointer}._ba:focus,._ba:hover,._bb:focus,._bb:hover{color:#f96447}._bc{display:inline-block;cursor:pointer;padding:5px 10px;border-radius:4px;line-height:1}._bc:hover{background-color:#eee}._bd{width:245px}._be{color:#333;background-color:#fafafa;padding:0 10px}._bf{padding:10px}._bg,._bh{padding:1px 0;position:absolute;top:-100%;left:0;right:0;-webkit-transition:top .15s;transition:top .15s;background-color:#fff}._bi{top:0}._bj{height:59px;margin:2px;float:left;width:77px;cursor:pointer;line-height:59px;border-radius:4px;font-size:16px}._bk:hover,._bj:hover{background:#f0f0f0}._bk,._bl{width:28px;height:28px;line-height:28px;margin:3px 2px;float:left;border-radius:4px;cursor:pointer}._bm,._bm:hover{color:#fff;background-color:#f96447}._bn,._bn:hover{color:#eee;cursor:not-allowed;background:#fff}._bo{padding:5px}._bp,._bo{border-top:1px solid #e6e6e6}._bp{margin:10px;padding:10px 0 0;text-align:left}._bq{-webkit-transform:scaleX(-1);transform:scaleX(-1)}");var s=e("$"),n=function(e,t){return 32-new Date(e,t-1,32).getDate()},r=["日","一","二","三","四","五","六"],_=function(e){return("0"+e).slice(-2)},l=function(e,t,a){var i,s=e.getTime();return t&&(i=s<t.getTime()),i||(i=!!a&&s>a.getTime()),i},o=function(e,t,a,i){var s,n=parseInt(e+_(t),10);return a&&(s=n<(a=parseInt(a.getFullYear()+_(a.getMonth()),10))),!s&&i&&(s=n>(i=parseInt(i.getFullYear()+_(i.getMonth()),10))),s},d=function(e,t,a){var i;return t&&(i=e<t.getFullYear()),!i&&a&&(i=e>a.getFullYear()),i},c={y:{reg:/y+/gi,fn:function(e,t){return String(t.getFullYear()).slice(-e.length)}},M:{reg:/M+/g,fn:function(e,t,a){return a=t.getMonth()+1,_(a).slice(-e.length)}},d:{reg:/d+/gi,fn:function(e,t,a){return a=t.getDate(),_(a).slice(-e.length)}},h:{reg:/h+/gi,fn:function(e,t,a){return a=t.getHours(),_(a).slice(-e.length)}},m:{reg:/m+/g,fn:function(e,t,a){return a=t.getMinutes(),_(a).slice(-e.length)}},s:{reg:/s+/g,fn:function(e,t,a){return a=t.getSeconds(),_(a).slice(-e.length)}},S:{reg:/S+/g,fn:function(e,t,a){return a=t.getMilliseconds(),String(a).substring(0,e.length)}}},h=function(e){return e instanceof Date?e:(e=new Date(Date.parse(String(e).replace(/-/g,"/"))))instanceof Date&&"Invalid Date"!=e&&!isNaN(e)?e:null},p=function(e,t){e=h(e),t=t||"YYYY-MM-dd";var a,i=function(t){return c[a].fn(t,e)};for(a in c)t=t.replace(c[a].reg,i);return t};a.exports=i.View.extend({tmpl:{html:'<div class="_aY _aj" mx-contextmenu="__E()"><%if($$.types.day){%><div id="days_<%=$$.id%>" class="_ai"><div class="_b_"><span class="__ _ba _aa" mx-click="__w()">&#xe61e;</span><h4 mx-click="<%if($$.types.month){%>__y<%}else{%>__z<%}%>()" class="_bc"><%=$$.year%>-<%=(\'0\'+$$.month).slice(-2)%></h4><span class="__ _bb _bq _ab" mx-click="__w({next:true})">&#xe61e;</span></div><div class="_bd"><div class="_be _ai"><%for(var _=0;_<$$.weekText.length;_++){%><span class="_bl"><%=$$.weekText[_]%></span><%}%></div><div class="_bf _ai"><%for(var a=0;a<$$.days.length;a++){var b=$$.days[a];for(var c=0;c<b.length;c++){%><span class="_bk<%if(b[c].otherMonth){%> _aZ<%}if(b[c].disabled){%> _bn<%}if(b[c].selected){%> _bm<%}%>" <%if(!b[c].disabled){%> mx-click="__C({toMonth:<%=b[c].month%>,date:\'<%=$eq(b[c].full)%>\'})" <%}%> title="<%=b[c].full%>"><%=b[c].day%></span><%}}%></div></div><%if($$.timeType){%><div class="_ai _bo" mx-change="__D()" mx-view="mx-time/index?time=<%!$eu($$.timeValue)%>&types=<%!$eu($$.timeType)%>"></div><%if($$.hasBtn){%><div class="_bp"><button type="button" class="_an _ao" mx-click="__a({enter:true})">确定</button><button type="button" class="_an _s" mx-click="__a()">取消</button></div><%}}%></div><%}if($$.types.month){%><div class="_ai<%if($$.types.day){%> _bg<%}if($$.showMonth){%> _bi<%}%>"><div class="_b_"><span class="__ _ba _aa" mx-click="__x()">&#xe61e;</span><h4 mx-click="__z()" class="_bc"><%=$$.year%></h4><span class="__ _bb _ab _bq" mx-click="__x({next:true})">&#xe61e;</span></div><div class="_bd _ai"><%for(var d=0,e;d<$$.months.length;d++){e=$$.months[d]%><span class="_bj<%if(e.disabled){%> _bn<%}if(e.selected){%> _bm<%}%>" <%if(!e.disabled){%> mx-click="__B({month:\'<%=$eq(e.month)%>\'})" <%}%>><%=e.month%></span><%}%></div></div><%}if($$.types.year){%><div class="_ai<%if($$.types.day||$$.types.month){%> _bh<%}if($$.showYear){%> _bi<%}%>"><div class="_b_"><span class="__ _ba _aa" mx-click="__x({range:true})">&#xe61e;</span><h4 class="_bc"><%=$$.startYear%>-<%=$$.endYear%></h4><span class="__ _bb _ab _bq" mx-click="__x({range:true,next:true})">&#xe61e;</span></div><div class="_bd _ai"><%for(var f=0,g;f<$$.years.length;f++){g=$$.years[f]%><span class="_bj<%if(g.selected){%> _bm<%}if(g.disabled){%> _bn<%}if(!f||f==$$.years.length-1){%> _aZ<%}%>" <%if(!g.disabled){%> mx-click="__A({year:\'<%=$eq(g.year)%>\'})" <%}%>><%=g.year%></span><%}%></div></div><%}%></div>'},init:function(e){this.__c=e},render:function(){this.update(this.__c)},__n:function(){var e=this.updater;e.set({showYear:0,showMonth:0});e.get().timeType&&(this.__p&&(this.__q(this.__p),this.__r(),this.__s(),this.__t(),delete this.__p),this.__u&&(e.set({timeValue:this.__u}),delete this.__u)),e.digest()},update:function(e){(e=e||{}).selected||(e.selected=new Date);var t=function(e){e||(e="all");var t={year:!0,month:!0,day:!0};if("all"!=e)for(var a in t)-1===e.indexOf(a)&&delete t[a];return t}(e.dateType),a=0|e.weekStart,i=h(e.selected),s=this.updater,n=h(e.max),_=h(e.min),l=e.timeType,o=p(i,"hh:mm:ss");s.set({types:t,showYear:0,showMonth:0,timeType:l,timeValue:o,hasBtn:e.hasBtn,dateValue:p(i,e.formatter),max:n,min:_,id:this.id,weekStart:a,weekText:function(e){for(var t=[],a=0;a<7;a++)t[a]=r[(a+e)%7];return t}(a)}),this.__q(i),this.__r(),this.__s(),this.__t(!0)},__q:function(e){var t=this.updater;(e=h(e))&&t.set({year:e.getFullYear(),month:e.getMonth()+1,selectedYear:e.getFullYear(),selectedMonth:e.getMonth()+1,selected:p(e)})},__r:function(e){for(var t=this.updater,a=t.get(),i=a.year,s=a.min,n=a.max,r=i-i%10-1,_=r+11,l=[],o=r;o<=_;o++)l.push({year:o,selected:o==a.selectedYear,disabled:d(o,s,n)});t.set({startYear:r,endYear:_,years:l}),e&&t.digest()},__s:function(e){for(var t=[],a=this.updater,i=a.get(),s=i.year,n=i.min,r=i.max,_=1;_<=12;_++)t.push({month:_,selected:s==i.selectedYear&&_==i.selectedMonth,disabled:o(s,_-1,n,r)});a.set({months:t}),e&&a.digest()},__t:function(e){var t,a,i,s,r=[],_=this.updater,o=_.get("weekStart"),d=_.get("year"),c=_.get("month"),h=(7-o+new Date(d,c-1,1).getDay())%7,u=[],g=n(d,c),f=n(d,c-1),b=_.get("max"),m=_.get("min"),x=_.get("selected");for(t=1;t<=h;t++)a=f-(h-t),i=new Date(d,c-2,a),u.push({month:c-1,full:p(i),day:a,otherMonth:!0,disabled:l(i,m,b)});for(t=1;t<=g;t++)i=new Date(d,c-1,t),s=p(i),u.push({selected:s==x,day:t,month:c,full:s,disabled:l(i,m,b)}),(t+h)%7==0&&(r.push(u),u=[]);var v=u.length;for(t=v;t<14&&(a=t-v+1,i=new Date(d,c,a),u.push({month:c+1,day:a,otherMonth:!0,full:p(i),disabled:l(i,m,b)}),(t+1)%7!=0||(r.push(u),u=[],6!=r.length));t++);_.set({days:r}),e&&_.digest()},__v:function(e){var t=this.updater.get();t.types.day?t.timeType&&t.hasBtn?e&&s("#"+this.id).trigger({type:"change",date:t.dateValue,time:t.timeType?t.timeValue:null}):s("#"+this.id).trigger({type:"change",date:t.dateValue,time:t.timeType?t.timeValue:null}):s("#"+this.id).trigger({type:"change",date:t.selectedYear+(t.types.month?"-"+("0"+t.selectedMonth).slice(-2):"")})},"__w<click>":function(e){var t=this.updater,a=t.get("month"),i=t.get("year");e.params.next?(a+=1)>12&&(a=1,i++):(a-=1)<1&&(a=12,i--),t.set({year:i,month:a}),this.__t(!0)},"__x<click>":function(e){var t=e.params,a=this.updater,i=a.get("year");t.range?i+=t.next?10:-10:i+=t.next?1:-1,a.set({year:i}),t.range?this.__r(!0):this.__s(!0)},"__y<click>":function(){this.updater.set({showMonth:1}),this.__s(!0)},"__z<click>":function(){this.updater.set({showYear:1}),this.__r(!0)},"__A<click>":function(e){var t=e.params.year,a=this.updater.get().types;a.day||a.month?(this.updater.set({showYear:0,year:+t}),a.month?this.__s(!0):this.__t(!0)):(this.__q(t+"-01-01"),this.__r(!0),this.__v())},"__B<click>":function(e){var t=e.params.month,a=this.updater,i=a.get();i.types.day?(a.set({showMonth:0,month:+t}),this.__t(!0)):(this.__q(i.year+"-"+t+"-01"),this.__s(!0),this.__v())},"__C<click>":function(e){var t=this.updater,a=t.get("month"),i=e.params.toMonth!=a;this.__q(e.params.date),this.__p||(this.__p=t.get("dateValue")),i&&(this.__r(),this.__s()),t.set({dateValue:e.params.date}),this.__t(!0),this.__v()},"__D<change>":function(e){e.stopPropagation();this.__u||(this.__u=this.updater.get("timeValue")),this.updater.set({timeValue:e.time}),this.__t(!0),this.__v()},"__a<click>":function(e){if(e.params.enter)return delete this.__p,delete this.__u,void this.__v(!0);s("#"+this.id).trigger("cancel")},"__E<contextmenu>":function(e){e.preventDefault()}},{parse:h,format:p,dateDisabled:l})});