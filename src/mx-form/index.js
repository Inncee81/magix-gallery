define("mx-form/index",["$","magix"],(e,t,r)=>{var n=e("$"),i=e("magix");i.applyStyle("_s","._dh,._dh:hover{border-color:#a62a22!important}._di{display:none;position:absolute;white-space:nowrap;word-wrap:normal;pointer-events:none;color:#666;font-size:10px;top:1px;line-height:1}");var a=function(e){return e.replace(/[^\x00-\xff]/g,"xl").length},o={required:function(e,t){return!t||n.trim(e)},number:function(e,t){return!(e=n.trim(e))||!t||e.indexOf(".")==e.lastIndexOf(".")&&/^-?[\d\.]+$/.test(e)},length:function(e,t){return!(e.length<t[0]||e.length>t[1])},blength:function(e,t){var r=a(e);return!(r<t[0]||r>t[1])},minLength:function(e,t){return!((e=n.trim(e))&&e.length<t)},maxLength:function(e,t){return!((e=n.trim(e))&&e.length>t)},range:function(e,t){return e=parseFloat(e),!isNaN(e)&&!(e<t[0]||e>t[1])},equalto:function(e,t){return n(t).val()==e},pattern:function(e,t){if(e=n.trim(e)){return new RegExp(t).test(e)}return!0},max:function(e,t){return!(+e>+t)},min:function(e,t){return!(+e<+t)}},s={required:function(){return"必填"},number:function(){return"数字"},length:function(e,t){return e[0]+"-"+e[1]+"个字之间,当前:"+t.length},blength:function(e,t){return e[0]+"-"+e[1]+"个字符之间,当前:"+a(t)},range:function(e){return e[0]+"-"+e[1]+"之间的数字"},equalto:function(e){return"与"+e+"同样的内容"},pattern:function(){return"格式有误"},minLength:function(e){return"最小长度:"+e},maxLength:function(e){return"最大长度:"+e},max:function(e){return"不能大于 "+e},min:function(e){return"不能小于 "+e}},f=function(e,t){var r,n,a=!0;for(var s in e)if(i.has(e,s)){var f=o[s];if(f&&!(a=f(t,n=e[s]))){r=s;break}}return{f:a,v:n,a:t,r:r}},u=function(e,t,r,a){var o=n('[mx-ssid="'+e+'"]');if(o.length)return o.addClass("_dh"),o.each(function(e,o){var f=(o=n(o)).attr("id");f||(f=i.guid(),o.attr("id",f));var u=f+"_msg",c=n("#"+u);if(!c.length){var l=o.parent();"static"==l.css("position")&&l.addClass("_ag"),o.after('<div class="_di" id="'+u+'"/>'),c=n("#"+u)}c.html(s[t](r,a)).show();var d=o.outerWidth()-3,v=c.width(),h=o.position();c.css({top:h.top+2,left:h.left+d-v})}),!0},c=function(e){var t=n('[mx-ssid="'+e+'"]');t.removeClass("_dh"),t.each(function(e,t){var r=(t=n(t)).attr("id")+"_msg";n("#"+r).hide()})},l=function(e,t){var r=e.params;if(r.m){var n=t[r.m+""+e.type];n&&(e.params=r.a,n.call(t,e))}};r.exports={fromKeys:function(e,t){t=(t+"").split(",");for(var r={},n=0,a=void 0;n<t.length;n++)r[a=t[n]]=i.has(e,a)?e[a]:"";return r},isValid:function(e){var t=!0,r=this.owner.children(),a=!1;e||(e=[],a=!0);for(c=0;c<r.length;c++){!1===i.Vframe.get(r[c]).invoke("isValid",[e])&&(t=!1)}n("#"+this.id+' [mx-ssid^="'+this.id+'"]').each(function(e,t){n(t).trigger({type:"change",from:"faker"})});var o=this.updater.$form;if(o){var s=i.keys(o);s.length&&(e.push(s[0]),t=!1)}if(a){for(var f=1e20,u=void 0,c=e.length,l=void 0,d=void 0;c--;)(l=n('[mx-ssid="'+e[c]+'"]')).length&&(d=l.offset()).top<f&&(u=l[0],f=d.top);u&&(u.scrollIntoViewIfNeeded?u.scrollIntoViewIfNeeded():u.scrollIntoView&&u.scrollIntoView())}return t},triggerParent:function(e){n("#"+this.id).trigger({type:"change",from:"subview",values:e})},"__b<focusin>":function(e){e.stopPropagation();var t=n(e.eventTarget);c(t.attr("mx-ssid")),l(e,this)},"__b<focusout>":function(e){e.stopPropagation();n(e.eventTarget).trigger({type:"change",from:"faker"}),l(e,this)},"__b<change>":function(e){var t=this,r=n(e.eventTarget);if(!e.viewId||e.viewId==t.id){e.viewId=t.id;var i="faker"==e.from||"subview"==e.from;e.stopPropagation();var a=e.params,o=t.updater;o.$form||(o.$form={});var s=o.$form,d=o.$keys||o.$k,v=a.c?a.c.slice():[a],h=!1,p=!0;n("#"+t.id).removeAttr("mx-ssid");for(var m=!1,g=function(e,t,r){n('input[name="'+e+'"]:checked').each(function(e,n){var i=n.value;r.number&&(i=parseFloat(i)),-1===t.indexOf(i)&&t.push(i)})};v.length;){for(var x=v.shift(),_=x.p.split("."),b=x.f||{},w=_.pop(),y=void 0,k=void 0,I=void 0,$=o.get();$&&_.length;)y=_.shift(),I||(I=y),$=$[y];if(I=I||w,"subview"==e.from)k=e.values[b.from||w];else if("checkbox"==r.prop("type")){var V=$[w],P=r.prop("checked");if(!0===V||!1===V)k=P;else if(k=r.val(),b.number&&(k=parseFloat(k)),n.isArray(V)){var F=r.prop("name");if(F)g(F,V=[],b);else{k=r.val(),b.number&&(k=parseFloat(k));var O=V.indexOf(k);P?-1===O&&V.push(k):O>-1&&V.splice(O,1)}k=V}else n.isPlainObject(V)?(P?V[k]=k:delete V[k],k=V):k=P?k:""}else k=r.val(),b.number&&(k=parseFloat(k));if($&&$[w]!==k&&($[w]=k,b.refresh&&(h=!0),!h&&b.silent||(d[I]=1),m=!0),p){var T=f(b,k),q=r.attr("mx-ssid");T.f?(delete s[q],c(q)):(s[q]=T,p=!1,u(q,T.r,T.v,T.a))}}p&&h&&o.digest(),m&&t.triggerParent(o.get()),i||l(e,t)}},"$doc<htmlchanged>":function(e){var t=this,r=t.updater.$form;e.vId==t.id&&(clearTimeout(t.__cs),t.__cs=setTimeout(t.wrapAsync(function(){if(r)for(var e in r){var t=r[e];u(e,t.r,t.v,t.a)||delete r[e]}}),0))}}});