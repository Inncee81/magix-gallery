define("mx-main/index",["magix","$","../mx-util/view"],(e,l,i)=>{"use strict";l.__esModule=!0;var a=e("magix"),r=e("$"),s=e("../mx-util/view");a.default.applyStyle("_zs_galleryag",'[mx-view*="mx-main/index"]{position:relative;background-color:#e8ebf2}._zs_galleryio{position:absolute;top:0;left:0;bottom:0;padding-top:16px;background-color:var(--app-nav-bg);z-index:3}._zs_galleryio ._zs_galleryip{position:relative;font-size:14px}._zs_galleryio ._zs_galleryip:before{content:"";position:absolute;top:0;left:24px;bottom:0;width:0;border-left:1px solid #4d5873}._zs_galleryio ._zs_galleryip:first-child:before{top:23px}._zs_galleryio ._zs_galleryip:last-child:before{bottom:23px}._zs_galleryio ._zs_galleryip ._zs_galleryiq{position:relative;display:block;height:46px;line-height:46px;padding-left:36px}._zs_galleryio ._zs_galleryip ._zs_galleryiq ._zs_galleryir{position:absolute;top:50%;left:16px;width:16px;height:16px;margin-top:-8px;border-radius:50%;background-color:#4d5873;color:#fff;text-align:center;line-height:16px;font-size:12px;transition:all var(--duration)}._zs_galleryio ._zs_galleryip ._zs_galleryiq ._zs_galleryis{color:#fff;opacity:.5}._zs_galleryio ._zs_galleryip ._zs_galleryiq ._zs_galleryit{opacity:0;position:absolute;top:0;left:0;z-index:-1;width:100%;height:100%;background-image:linear-gradient(-90deg,var(--app-brand),var(--app-brand-gradient));background-color:var(--app-brand);transition:all var(--duration)}._zs_galleryio ._zs_galleryip ._zs_galleryiq._zs_galleryiu ._zs_galleryit,._zs_galleryio ._zs_galleryip ._zs_galleryiq._zs_galleryiu ._zs_galleryis,._zs_galleryio ._zs_galleryip ._zs_galleryiq:hover ._zs_galleryis{opacity:1}._zs_galleryio ._zs_galleryip ._zs_galleryiv:before{content:"";position:absolute;top:50%;left:24px;width:10px;height:0;border-top:1px solid #4d5873}._zs_galleryio ._zs_galleryip._zs_galleryiw ._zs_galleryiq ._zs_galleryis{opacity:1}._zs_galleryio ._zs_galleryip._zs_galleryiw ._zs_galleryiq ._zs_galleryit{opacity:.2}._zs_galleryio ._zs_galleryip._zs_galleryiw ._zs_galleryiq._zs_galleryiu ._zs_galleryir{background-color:#fff;color:var(--app-brand)}._zs_galleryio ._zs_galleryip._zs_galleryiw ._zs_galleryiq._zs_galleryiu ._zs_galleryit{opacity:1}._zs_galleryio ._zs_galleryip._zs_galleryix ._zs_galleryiq{cursor:not-allowed}._zs_galleryio ._zs_galleryip._zs_galleryix ._zs_galleryiq:hover ._zs_galleryis{opacity:.5}._zs_galleryio ._zs_galleryip._zs_galleryix ._zs_galleryiy{position:absolute;top:50%;right:16px;margin-top:-6px;font-size:14px;font-weight:700;color:#4d5873}._zs_galleryiz{position:relative;z-index:2}._zs_galleryiz ._zs_galleryiA{position:relative;margin-bottom:16px;border-radius:var(--border-radius);background-color:#fff}._zs_galleryiz ._zs_galleryiA ._zs_galleryiB{padding:8px 24px;border-top-left-radius:var(--border-radius);border-top-right-radius:var(--border-radius);border-bottom:1px solid var(--color-border)}._zs_galleryiz ._zs_galleryiA ._zs_galleryiB ._zs_galleryiC,._zs_galleryiz ._zs_galleryiA ._zs_galleryiB ._zs_galleryiC>*,._zs_galleryiz ._zs_galleryiA ._zs_galleryiB ._zs_galleryiD,._zs_galleryiz ._zs_galleryiA ._zs_galleryiB ._zs_galleryiE{display:inline-block;height:32px;line-height:32px;vertical-align:middle;overflow:hidden}._zs_galleryiz ._zs_galleryiA ._zs_galleryiB ._zs_galleryiC,._zs_galleryiz ._zs_galleryiA ._zs_galleryiB ._zs_galleryiC>*{margin-right:5px;color:#999;font-size:22px}._zs_galleryiz ._zs_galleryiA ._zs_galleryiB ._zs_galleryiD{font-size:16px}._zs_galleryiz ._zs_galleryiA ._zs_galleryiB ._zs_galleryiF{margin-left:20px;color:#999}._zs_galleryiz ._zs_galleryiA ._zs_galleryiG{padding:16px 24px}._zs_galleryiz ._zs_galleryiH{position:absolute;background-color:#fff;border-radius:var(--border-radius)}._zs_galleryiz ._zs_galleryiH ._zs_galleryiI{padding:8px 24px;line-height:32px;font-size:16px;border-bottom:1px solid var(--color-border)}._zs_galleryiz ._zs_galleryiH ._zs_galleryiJ{padding:16px 24px;color:#666}._zs_galleryiz ._zs_galleryiK{text-align:center;padding:40px 0}._zs_galleryiz ._zs_galleryiK ._zs_galleryiL{min-width:100px;margin-right:20px}._zs_galleryiz ._zs_galleryiK ._zs_galleryiL:last-child{margin-right:0}._zs_galleryiM{display:inline-block;position:relative;margin-top:10px;padding-left:20px;color:var(--color-red)}._zs_galleryiM ._zs_galleryiN{position:absolute;top:0;left:0}');var t=a.default.Router,_=a.default.Vframe;l.default=s.extend({tmpl:function(e,l,i,a,r,s,t,_){if(i||(i=e),!r){var n={"&":"amp","<":"lt",">":"gt",'"':"#34","'":"#39","`":"#96"},o=/[&<>"'`]/g,g=function(e){return"&"+n[e]+";"};r=function(e){return""+(null==e?"":e)},a=function(e){return r(e).replace(o,g)}}if(!s){var d={"!":"%21","'":"%27","(":"%28",")":"%29","*":"%2A"},p=function(e){return d[e]},z=/[!')(*]/g;s=function(e){return encodeURIComponent(r(e)).replace(z,p)}}if(!_){var y=/[\\'"]/g;_=function(e){return r(e).replace(y,"\\$&")}}t||(t=function(e,l,i,a){for(a=e[c];--a;)if(e[i=c+a]===l)return i;return e[i=c+e[c]++]=l,i});var c="",u="",x=e.leftWidth,f=e.stepInfos,v=e.curStepIndex,h=e.curSubStepIndex,b=e.viewHeight,m=e.gapWidth,w=e.curStepInfo,k=e.rightWidth,I=e.viewId;u+='<div class="_zs_galleryio" style="width: '+a(x)+'px;">';for(var S=0,D=f.length;S<D;S++){var q=f[S];if(u+='<div class="_zs_galleryip ',q.index==v&&(u+=" _zs_galleryiw "),u+=" ",q.locked&&(u+=" _zs_galleryix "),u+='"><a href="javascript:;" class="_zs_galleryiq ',q.index==v&&-1==h&&(u+=" _zs_galleryiu "),u+='" data-sub="-1" ',q.locked||(u+=' mx-click="'+l+"nav({stepIndex:"+a(q.index)+'})" '),u+='><span mxa="_zs_gallerydD:_" class="_zs_galleryir">'+a(S+1)+'</span><span mxs="_zs_gallerydD:_" class="_zs_galleryit"></span><span mxa="_zs_gallerydD:a" class="_zs_galleryis">'+a(q.label)+"</span></a>",!q.locked&&q.subs.length>1){u+=" ";for(var W=0,A=q.subs,B=A.length;W<B;W++){var $=A[W];u+='<a href="javascript:;" class="_zs_galleryiq _zs_galleryiv ',q.index==v&&h==$.index&&(u+=" _zs_galleryiu "),u+='" data-sub="'+a($.index)+'" mx-click="'+l+"nav({stepIndex:"+a(q.index)+",subStepIndex:"+a($.index)+'})"><span mxs="_zs_gallerydD:_" class="_zs_galleryit"></span><span mxa="_zs_gallerydD:b" class="_zs_galleryis">'+a($.label)+"</span></a>"}u+=" "}u+=" ",q.locked&&(u+='<i mxs="_zs_gallerydD:a" class="mc-iconfont _zs_galleryiy">&#xe759;</i>'),u+="</div>"}u+='</div><div mxv class="_zs_galleryiz clearfix" style="min-height: '+a(b)+"px; padding-top: "+a(m)+"px; padding-right: "+a(m+(w.sideWrapper?k+m:0))+"px; padding-left: "+a(x+m)+'px;">';for(var H=0,M=w.subs,T=M.length;H<T;H++){u+='<div mxv mxa="_zs_gallerydD:c" class="_zs_galleryiA"><div mxa="_zs_gallerydD:d" class="_zs_galleryiB clearfix">',($=M[H]).icon&&(u+='<span mxa="_zs_gallerydD:e" class="_zs_galleryiC">'+r($.icon)+"</span>"),u+='<span mxa="_zs_gallerydD:f" class="_zs_galleryiD">'+a($.label)+"</span>",$.tip&&(u+='<span mxa="_zs_gallerydD:g" class="_zs_galleryiF">'+r($.tip)+"</span>"),u+='</div><div mxv="curStepInfo" class="_zs_galleryiG" id="sub_frame_'+a($.index)+'" mx-view="'+a($.view)+"?info="+t(i,$)+'"><div mxs="_zs_gallerydD:b" class="loading" style="padding: 40px 0;"><span class="loading-anim"></span></div></div></div>'}u+=" ",w.sideWrapper&&(u+='<div mxv="curStepInfo" class="_zs_galleryiH" style="top: '+a(m)+"px; right: "+a(m)+"px; width: "+a(k)+'px;" mx-view="'+a(w.sideWrapper)+"?data="+t(i,w.sideData)+'"><div mxs="_zs_gallerydD:b" class="loading" style="padding: 40px 0;"><span class="loading-anim"></span></div></div>'),u+='<div mxa="_zs_gallerydD:h" class="_zs_galleryiK"><div>';for(var C=0,E=w.btns,j=E.length;C<j;C++){var F=E[C];u+='<a href="javascript:;" class="btn ',F.brand&&(u+=" btn-brand "),u+=' _zs_galleryiL" mx-click="'+l+""+a(F.fn)+"({btn:'"+t(i,F)+"'})\">"+a(F.text)+"</a>"}return u+='</div><div id="'+a(I)+'_error" class="_zs_galleryiM"></div></div></div>'},init:function(e){var l=this;l.updater.set({gapWidth:16,leftWidth:+e.leftWidth||160,rightWidth:+e.rightWidth||260,alreadyStep:e.alreadyStep||1,originStepInfos:e.stepInfos||[],viewHeight:r(window).height()}),l.observeLocation(["stepIndex","subStepIndex"]),l.owner.oncreated=function(){l.$init||(l.subScroll(),l.$init=1)},l.ondestroy=function(){l.owner.off("created")}},render:function(){var e=this;e.$init=null;var l=+e.updater.get("alreadyStep"),i=r.extend(!0,[],e.updater.get("originStepInfos")),a=t.parse().params,s=+(a.stepIndex||1);s>l&&(l=s);var _=+a.subStepIndex||-1;i.forEach(function(a,r){var t=r+1;a.index=t,a.subs=a.subs||[],(a=e.wrapSide(a)).locked=a.locked+""=="true"||t>l,t==s&&(_>a.subs.length||1==a.subs.length)&&(_=-1);var n=[];if(a.hasOwnProperty("btns"))(n=a.btns||[]).forEach(function(e){"prev"==e.type?(e.text=e.text||"返回上一步",e.fn="prev"):"next"==e.type?(e.text=e.text||"下一步",e.fn="next",e.brand=e.brand+""!="false",e.callback&&(a.nextFn=e.callback)):e.fn="custom"});else{var o="";t>1&&!i[r-1].locked&&(o=a.prevTip||"返回上一步"),o&&n.push({type:"prev",text:o,fn:"prev"});var g="";t<i.length&&(g=a.nextTip||"下一步"),g&&n.push({type:"next",text:g,brand:!0,fn:"next"})}a.btns=n});var n=function(){e.updater.digest({alreadyStep:l,stepInfos:i,curStepInfo:i[s-1],curStepIndex:s,curSubStepIndex:_})};if(e.$inited)if(t.diff().params.stepIndex)n();else{e.updater.set({curSubStepIndex:_});var o=r("#"+e.id+" ._zs_galleryiw");o.find("._zs_galleryiq").removeClass("_zs_galleryiu"),o.find('._zs_galleryiq[data-sub="'+_+'"]').addClass("_zs_galleryiu"),e.subScroll()}else e.$inited=1,n()},"custom<click>":function(e){var l=this,i=e.params.btn;if(i.check){var r=l.updater.get().curStepInfo.subs,s=r.map(function(e){return _.get("sub_frame_"+e.index).invoke("check")});Promise.all(s).then(function(e){var s=!0,t=[],_={};e.forEach(function(e,l){s=s&&e.ok,e.ok||t.push({id:l+1,label:r[l].label,msg:e.msg||""}),a.default.mix(_,e.remain||{})}),s?(l.showMsg(""),i.callback&&i.callback(_)):l.showMsg(""+t.map(function(e){return"\n                        <div>"+e.label+"："+e.msg+"</div>\n                    "}).join(""))})}else i.callback&&i.callback()},"prev<click>":function(e){var l=this.updater.get().curStepIndex;t.to({stepIndex:+l-1,subStepIndex:-1})},"next<click>":function(e){var l=this,i=l.updater.get().curStepInfo,r=i.subs,s=r.map(function(e){return _.get("sub_frame_"+e.index).invoke("check")});Promise.all(s).then(function(e){var s=!0,t=[],_={};e.forEach(function(e,l){s=s&&e.ok,e.ok||t.push({id:l+1,label:r[l].label,msg:e.msg||""}),a.default.mix(_,e.remain||{})}),s?(l.showMsg(""),i.nextFn?i.nextFn(_).then(function(e){l.next(e)}):l.next({})):l.showMsg(""+t.map(function(e){return"\n                    <div>"+e.label+"："+e.msg+"</div>\n                "}).join(""))})},next:function(e){var l=this.updater.get().curStepIndex;e.stepIndex=+l+1,t.to(e)},showMsg:function(e){var l=r("#"+this.id+"_error");e?l.html('<i class="mc-iconfont _zs_galleryiN">&#xe6ad;</i>'+e):l.html("")},wrapSide:function(e){var l=+this.updater.get("rightWidth"),i=!1,a=null,r={};(e.sideView||e.sideTip)&&(a="mx-main/tip",r={view:e.sideView||"",title:e.sideTitle||"",content:e.sideTip||""},i=!0);var s=!1;return e.subs.forEach(function(e,l){e.index=l+1;var a=null,r={};if(!i){var t=!1;(e.sideView||e.sideTip)&&(a="mx-main/tip",r={view:e.sideView||"",content:e.sideTip||""},t=!0),s=s||t}e.sideWrapper=a,e.sideData=r}),i=i||s,e.hasSide=i,e.sideWrapper=a,e.sideData=r,e.rightWidth=i?l:0,e},subScroll:function(){var e,l=+this.updater.get("curSubStepIndex");l>0?e=r("#"+this.id+" #sub_frame_"+l).offset().top-50:e=0;r(window).scrollTop(e)},"$win<scroll>":function(){var e=r("#"+this.id),l=e.find("._zs_galleryiz");if(l.length){var i=e.find("._zs_galleryio"),a=r(window).scrollTop();a>l.offset().top?i.css({position:"fixed"}):i.css({position:"absolute"});var s=e.find("._zs_galleryiH");if(s.length){var t=l.offset().top,_=this.updater.get().gapWidth;a>t+_?s.css({position:"fixed",top:0}):s.css({position:"absolute",top:_+"px"})}}},"$win<resize>":function(){var e=r(window).height();this.updater.set({viewHeight:e}),r("#"+this.id).find(".unfound-[main]-from-index.less").css({minHeight:e})},"nav<click>":function(e){var l=e.params,i=l.stepIndex,a=l.subStepIndex||-1;t.to({stepIndex:i,subStepIndex:a})}})});