define("mx-main/steps",["magix","$","../mx-util/view"],(e,t,n)=>{"use strict";t.__esModule=!0;var a=e("magix"),i=e("$"),c=e("../mx-util/view"),r=a.default.Router,s=a.default.Vframe;t.default=c.extend({init:function(e){this.updater.set({alreadyStep:e.alreadyStep||1,originStepInfos:e.stepInfos||[],viewHeight:i(window).height()}),this.observeLocation(["stepIndex"])},render:function(){var e=this.updater,t=+e.get("alreadyStep"),n=i.extend(!0,[],e.get("originStepInfos")),a=+(r.parse().params.stepIndex||1);a>t&&(t=a);n.forEach(function(e,i){var c=i+1;e.index=c,e.locked=e.locked+""=="true"||c>t,e.lineOn=c<t,e.current=c==a,e.icon=e.icon||'<span class="fontsize-16">'+e.index+"</span>";var r=[];if(e.hasOwnProperty("btns"))(r=e.btns||[]).forEach(function(t){"prev"==t.type?(t.text=t.text||"返回上一步",t.fn="prev"):"next"==t.type?(t.text=t.text||"下一步",t.fn="next",t.brand=t.brand+""!="false",t.callback&&(e.nextFn=t.callback)):t.fn="custom"});else{var s="";c>1&&!n[i-1].locked&&(s=e.prevTip||"返回上一步"),s&&r.push({type:"prev",text:s,fn:"prev"});var o="";c<n.length&&(o=e.nextTip||"下一步"),o&&r.push({type:"next",text:o,brand:!0,fn:"next"})}e.btns=r}),this.updater.digest({alreadyStep:t,stepInfos:n,curStepInfo:n[a-1],curStepIndex:a})},showMsg:function(e){var t=i("#"+this.id+"_error");e?t.html('<i class="mc-iconfont displacement-2">&#xe6ad;</i>'+e):t.html("")},"custom<click>":function(e){var t=this,n=e.params.btn;if(n.check){t.updater.get("curStepInfo");s.get(t.id+"_cur_content").invoke("check").then(function(e){e.ok?(t.showMsg(""),n.callback&&n.callback(e.remain)):t.showMsg(e.msg)})}else n.callback&&n.callback()},"prev<click>":function(e){var t=this.updater.get().curStepIndex;r.to({stepIndex:+t-1})},"next<click>":function(e){var t=this,n=t.updater.get("curStepInfo");s.get(t.id+"_cur_content").invoke("check").then(function(e){e.ok?(t.showMsg(""),n.nextFn?n.nextFn(e.remain).then(function(e){t.next(e)}):t.next({})):t.showMsg(e.msg)})},next:function(e){var t=this.updater.get("curStepIndex");e.stepIndex=+t+1,r.to(e)},"nav<click>":function(e){var t=e.params.stepIndex;r.to({stepIndex:t})}})});