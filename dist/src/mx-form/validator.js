define("mx-form/validator",["$","magix","mx-form/rule","./util","mx-util/css-var"],(e,r,t)=>{var a=e("$"),o=e("magix"),l=e("mx-form/rule"),i=e("./util"),s=e("mx-util/css-var");o.applyStyle("_zs_galleryU","html ._zs_galleryfS,html ._zs_galleryfS:focus,html ._zs_galleryfS:hover{border-color:var(--color-red)}._zs_galleryfT{display:none;position:absolute;white-space:nowrap;word-wrap:normal;pointer-events:none;color:var(--color-red);font-size:var(--font-size);line-height:18px}._zs_galleryfU,._zs_galleryfU:focus,._zs_galleryfU:hover{border-color:var(--color-warn)}._zs_galleryfV{display:none;position:absolute;white-space:nowrap;word-wrap:normal;pointer-events:none;color:var(--color-warn);font-size:var(--font-size)}");var n=function(e,r,t){var a,i,s,n=!0;for(var f in r)if(o.has(r,f)){if(l[f]){var c=l[f](t,i=r[f]);n=c.valid,s=c.tip}else n=!0,s="过滤掉不在校验规则内的";if(!n){a=f;break}}return{type:e,placement:r.placement,valid:n,action:a,rule:i,val:t,tip:s}},f=function(e){var r=a('[mxe="'+e+'"]');r.removeClass("_zs_galleryfU _zs_galleryfS"),r.each(function(e,r){var t=(r=a(r)).attr("id")+"_msg";a("#"+t).hide()})},c=function(e,r,t){var l=a('[mxe="'+r+'"]');if(l.length){switch(e){case"warn":l.addClass("_zs_galleryfU").removeClass("_zs_galleryfS");break;case"error":l.addClass("_zs_galleryfS").removeClass("_zs_galleryfU")}return"checkbox"!=l.prop("type")&&"radio"!=l.prop("type")||(l=a(l[0])),l.each(function(r,l){var i=(l=a(l)).parent(),n=l.attr("id");n||(n=o.guid(),l.attr("id",n));var f=n+"_msg",c=a("#"+f);c.length||("static"==i.css("position")&&i.css({position:"relative"}),l.after('<div id="'+f+'"/>'),c=a("#"+f));switch(e){case"warn":c[0].className="_zs_galleryfV";break;case"error":c[0].className="_zs_galleryfT"}c.html(t.tip).show();var p=t.placement||"bottom",v=l.outerWidth(),d=l.outerHeight(),h=l.offset(),m=i.offset(),u=s.get("--input-height","32px");switch(p){case"right":c.css({lineHeight:u,top:h.top-m.top,left:h.left-m.left+v+10});break;case"bottom":c.css({lineHeight:"18px",top:h.top-m.top+d,left:h.left-m.left+10})}}),!0}};t.exports={isValid:function(e,r){e=o.mix({element:null,scrollIntoView:!0,checkSubs:!0},e||{});var t,l=this,i=!0,s=l.owner.children(),n=!1;if(r||(r=[],n=!0),e.checkSubs)for(var f=0;f<s.length;f++){!1===o.Vframe.get(s[f]).invoke("isValid",[r])&&(i=!1)}e.element?(t="string"!=typeof e.element||/^#/.test(e.element)||/^\./.test(e.element)?a(e.element):a("#"+e.element)).attr("mxe")||(t=t.find('[mxe^="'+l.id+'"]')):t=a("#"+l.id+' [mxe^="'+l.id+'"]');var c=[];t.each(function(e,r){l.__bY(a(r)),c.push(a(r).attr("mxe"))});var p=l.updater.$form;if(p)for(var v=0;v<c.length;v++){var d=c[v];if(p[d]&&"error"==p[d].type){r.push(d),i=!1;break}}if(n&&e.scrollIntoView){for(var h=1e20,m=void 0,u=r.length,g=void 0,_=void 0;u--;)(g=a('[mxe="'+r[u]+'"]')).length&&(_=g.offset()).top<h&&(m=g[0],h=_.top);m&&(m.scrollIntoViewIfNeeded?m.scrollIntoViewIfNeeded():m.scrollIntoView&&m.scrollIntoView())}return i},"$[mxc]<keyup,change,focusout>":function(e){var r=a(e.eventTarget),t=r.attr("mxe");t&&t.startsWith(this.id)&&this.__bY(r)},__bY:function(e){for(var r=this.updater,t=r.$form||(r.$form={}),l=e.attr("mxc"),s=!0,p=0,v=r.parse(l);p<v.length;p++){for(var d=v[p],h=d.f||{},m=d.p.split("."),u=m.pop(),g=void 0,_=r.get();_&&m.length;)_=_[m.shift()];if("checkbox"==e.prop("type")){var y=_[u],w=e.prop("checked");if(!0===y||!1===y)g=w;else if(g=e.val(),a.isArray(y)){var x=e.prop("name");if(x)y=[],i.addCheckbox(x,y,h);else{var z=i.indexOf(y,g);w?-1===z&&y.push(g):z>-1&&y.splice(z,1)}g=y}else a.isPlainObject(y)?(w?y[g]=g:delete y[g],g=y):g=w?g:""}else if("radio"==e.prop("type")){var b=e.prop("name");g=a("input[name="+b+"]:checked").val()}else g=e.val();if(s){var k=n("error",h,g),V=e.attr("mxe");if(k.valid){if(delete t[V],f(V),o.has(h,"warn")){var $=n("warn",h.warn,g);$.valid?(delete t[V],f(V)):(t[V]=$,c("warn",V,$))}}else t[V]=k,s=!1,c("error",V,k)}}},clearValid:function(){var e=this.updater.$form;if(e)for(var r in e)f(r);this.updater.$form={}},"$doc<htmlchanged>":function(e){var r=this.updater.$form;if(e.vId==this.id&&r)for(var t in r){var a=r[t];c(a.type,t,a)||delete r[t]}}}});