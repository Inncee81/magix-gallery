define("mx-dialog/index",["magix","$","../mx-medusa/util","mx-popover/index"],(e,a,t)=>{e("mx-popover/index");var l=e("magix"),r=e("$"),i=l.Vframe,n=e("../mx-medusa/util");l.applyStyle("_zs_galleryE",'._zs_gallerydL,._zs_gallerydM{position:fixed;left:0;width:100%;height:100%;transition:all var(--duration)}._zs_gallerydL{opacity:0;top:0;background-color:rgba(0,0,0,.4)}._zs_gallerydL._zs_gallerydN{opacity:1}._zs_gallerydO{position:absolute;border-radius:var(--border-radius);background-color:#fff;box-shadow:0 1px 1px 0 rgba(0,0,0,.08);border:1px solid #f5f5f6}._zs_gallerydO ._zs_gallerydP{position:relative;word-break:break-all}._zs_gallerydO ._zs_gallerydQ{position:absolute;top:16px;right:24px;width:26px;height:26px;z-index:20;border-radius:50%;background:transparent;color:#ccc;text-align:center}._zs_gallerydO ._zs_gallerydQ ._zs_gallerydR{font-size:18px;font-weight:700;line-height:26px}._zs_gallerydO ._zs_gallerydQ:focus,._zs_gallerydO ._zs_gallerydQ:hover{background-color:#999;color:#fff}._zs_gallerydO._zs_gallerydS{border-radius:0}@-webkit-keyframes _zs_gallerya{0%{transform:translate(0)}25%{transform:translateY(2px)}50%{transform:translate(0)}75%{transform:translateY(-2px)}to{transform:translate(0)}}@keyframes _zs_gallerya{0%{transform:translate(0)}25%{transform:translateY(2px)}50%{transform:translate(0)}75%{transform:translateY(-2px)}to{transform:translate(0)}}@-webkit-keyframes _zs_galleryb{0%{transform:translate(0)}25%{transform:translateY(-2px)}50%{transform:translate(0)}75%{transform:translateY(2px)}to{transform:translate(0)}}@keyframes _zs_galleryb{0%{transform:translate(0)}25%{transform:translateY(-2px)}50%{transform:translate(0)}75%{transform:translateY(2px)}to{transform:translate(0)}}._zs_gallerydT,._zs_gallerydT:after,._zs_gallerydT:before{display:inline-block;width:4px;height:4px;background-color:#fff;vertical-align:middle;border-radius:50%}._zs_gallerydT{position:relative;margin:0 8px}._zs_gallerydT:after{content:" ";position:absolute;left:-8px;top:0;-webkit-animation:_zs_gallerya .6s linear 0s infinite;animation:_zs_gallerya .6s linear 0s infinite}._zs_gallerydT:before{content:" ";position:absolute;left:8px;top:0;-webkit-animation:_zs_galleryb .6s linear 0s infinite;animation:_zs_galleryb .6s linear 0s infinite}._zs_gallerydU{position:relative}._zs_gallerydU ._zs_gallerydV{opacity:1;position:relative;z-index:1}._zs_gallerydU ._zs_gallerydW{display:none;position:absolute;top:0;left:0;z-index:2;width:100%;height:100%}._zs_gallerydU._zs_gallerydX ._zs_gallerydV{opacity:0}._zs_gallerydU._zs_gallerydX ._zs_gallerydW{display:inline}');var o=99999,s=[];t.exports=l.View.extend({tmpl:function(e,a,t,l,r,i,n,o){if(t||(t=e),!r){var s={"&":"amp","<":"lt",">":"gt",'"':"#34","'":"#39","`":"#96"},d=/[&<>"'`]/g,c=function(e){return"&"+s[e]+";"};r=function(e){return""+(null==e?"":e)},l=function(e){return r(e).replace(d,c)}}if(!i){var _={"!":"%21","'":"%27","(":"%28",")":"%29","*":"%2A"},g=function(e){return _[e]},f=/[!')(*]/g;i=function(e){return encodeURIComponent(r(e)).replace(f,g)}}if(!o){var p=/[\\'"]/g;o=function(e){return r(e).replace(p,"\\$&")}}var m="",u=e.closable,y=e.cntId,h=e.full,x=e.fullHeader,v=e.fullFooter;return u&&(m+='<a mxs="_zs_gallerya4:_" href="javascript:;" mx-click="'+a+'__aL()" class="_zs_gallerydQ"><i class="mc-iconfont _zs_gallerydR">&#xe603;</i></a>'),m+='<div class="_zs_gallerydP" id="'+l(y)+'_content">',h?(m+=" ",x.title&&(m+='<div class="dialog-header" id="'+l(y)+'_header"><span mxa="_zs_gallerya4:_" class="header-name">'+r(x.title)+"</span>",x.iconTip&&(m+='<i class="mc-iconfont color-c displacement-2" mx-view="mx-popover/index?content='+i(x.iconTip)+'">&#xe7aa;</i>'),m+=" ",x.tip&&(m+='<span mxa="_zs_gallerya4:a" class="color-9 ml10">'+r(x.tip)+"</span>"),m+="</div>"),m+='<div id="'+l(y)+'"><div mxs="_zs_gallerya4:a" class="loading" style="padding: 150px 0;"><span class="loading-anim"></span></div></div>',(v.enter||v.cancel)&&(m+='<div class="dialog-footer clearfix" id="'+l(y)+'_footer">',v.enter&&(m+='<a mxa="_zs_gallerya4:b" href="javascript:;" class="fl btn btn-brand min-width-60 mr10 _zs_gallerydU" mx-click="'+a+'__aM()"><span mxa="_zs_gallerya4:c" class="_zs_gallerydV">'+r(v.enterText)+"</span></a>"),m+=" ",v.cancel&&(m+='<a mxa="_zs_gallerya4:d" href="javascript:;" class="fl btn min-width-60 mr10" mx-click="'+a+'__aL()">'+r(v.cancelText)+"</a>"),m+=" ",v.enter&&(m+='<span id="'+l(y)+'_footer_error" class="fl lh32 color-red"></span>'),m+="</div>"),m+=" "):m+='<div id="'+l(y)+'"><div mxs="_zs_gallerya4:a" class="loading" style="padding: 150px 0;"><span class="loading-anim"></span></div></div>',m+="</div>"},init:function(e){var a=this;a.on("destroy",function(){!function(e){for(var a=s.length-1;a>=0;a--)if(s[a].id==e.id){s.splice(a,1);break}}(a),o-=2,r("#"+a.id).trigger("dlg_close"),a.__aI&&clearTimeout(a.__aI)}),o+=2,s.push(a),l.has(e,"closable")||(e.closable=!0),a.updater.set(l.mix({cntId:"cnt_"+a.id},e))},render:function(){var e=this,a=e.updater,t=a.get();a.digest(),setTimeout(e.wrapAsync(function(){var a=r("#wrapper_"+e.id);a.css(t.posTo),e.__aJ();var i=t.cntId,n=r("#mask_"+e.id);n.length>0&&n.addClass("_zs_gallerydN"),(t.closable||t.emptyClosable)&&a.on("click",function(a){l.inside(a.target,i+"_content")||r("#"+e.id).trigger("dlg_close")}),e.owner.mountVframe(i,t.view,t),a.on("scroll",function(){r(document).trigger("dialogScolll")})}),250)},__aJ:function(){var e=this.updater.get(),a=e.cntId,t=r("#"+e.vId),l=window.innerHeight,i=window.innerWidth;if(e.full){var n=l,o=r("#"+a+"_header"),s=r("#"+a+"_footer");o&&o.length&&(n-=o.outerHeight()),s&&s.length&&(n-=s.outerHeight());var d={height:n-2,overflowY:"auto"};e.card&&(d.backgroundColor="#e8ebf2",d.padding="16px 24px"),r("#"+a).css(d);var c=Math.min(i,e.width);t.css({width:c,left:Math.max(0,i-c)})}},__aK:function(e){var a=i.get("cnt_"+this.id);a&&a.invoke("fire",["unload",e])},"__aM<click>":function(e){var a=r(e.eventTarget),t="_zs_gallerydX";if(!a.hasClass(t)){a.addClass(t),a.append('<span class="_zs_gallerydW">\n            <span class="_zs_gallerydT"></span>\n        </span>');var l=this,n=l.updater.get(),o=n.cntId;i.get(o).invoke("check").then(function(e){a.find("._zs_gallerydW").remove(),a.removeClass(t);var i=r("#"+o+"_footer_error");e.ok?(i.html(""),l["__aL<click>"](),n.callback&&n.callback(e.data||{})):e.msg?i.html('<i class="mc-iconfont displacement-2">&#xe6ad;</i>'+e.msg):i.html("")})}},"__aL<click>":function(){r("#"+this.id).trigger("dlg_close")},"$doc<keyup>":function(e){if(27==e.keyCode){var a=s[s.length-1];if(a==this&&a.updater.get("closable"))r("#"+a.id).trigger("dlg_close")}},"$win<resize>":function(e){var a=this;a.__aI&&clearTimeout(a.__aI),a.__aI=setTimeout(a.wrapAsync(function(){a.__aJ()}),200)}},{__aN:function(e,a){var t=l.guid("dlg_");if(a.mask){var i=r('<div class="_zs_gallerydL" id="mask_'+t+'" />');i.css({zIndex:o-1}),r(document.body).append(i)}var n="wrapper_"+t,d=o,c=a.width,_=a.left,g=a.top,f=r('<div class="_zs_gallerydM" \n            id="'+n+'" \n            style="z-index:'+d+'">\n            <div class="_zs_gallerydO '+(a.full?"_zs_gallerydS":"")+'" id="'+t+'" \n                style="top:'+g+"px; left:"+_+"px; width:"+c+'px;"></div>\n        </div>');f.css(a.posFrom),r(document.body).append(f),window.innerWidth-document.body.clientWidth>0&&(document.body.style.paddingRight=window.innerWidth-document.body.clientWidth+"px"),document.body.style.overflowY="hidden",f.css({overflowY:a.modal?"hidden":"auto"});var p,m=e.owner.mountVframe(t,"mx-dialog/index",a),u=r("#"+t);return u.on("dlg_close",function(){u.data("closed")||u.trigger({type:"beforeClose",closeFn:function(){if(!u.data("closing")&&!p){var l=function(){u.data("closing",1),r("#wrapper_"+t).css(a.posFrom),r("#mask_"+t).removeClass("_zs_gallerydN"),setTimeout(function(){u.trigger("close"),u.data("closed",1),e.owner&&e.owner.unmountVframe(t),r("#wrapper_"+t).remove(),r("#mask_"+t).remove(),0==s.length&&(document.body.style.paddingRight="",document.body.style.overflowY="")},250)},i={prevent:function(){p=1},resolve:function(){i.p=1,p=0,l()},reject:function(){i.p=1,p=0}};m.invoke("__aK",[i]),p||i.p||l()}}})})},alert:function(e,a,t,r){var i=(r=r||{}).btns+""!="false";return this.mxDialog("mx-dialog/alert",{title:e,content:a,enterCallback:t,hasBtns:i},l.mix({width:320,emptyClosable:!0,closable:!1,mask:!1},r))},confirm:function(e,a){return this.mxDialog("mx-dialog/confirm",e,l.mix({width:320,emptyClosable:!0,closable:!1,mask:!1},a||{}))},mxModal:function(e,a,t){return t=t||{},this.mxDialog(e,a,l.mix({closable:!0,mask:!0},l.mix(t,{full:!0,fullHeader:l.mix({title:"",tip:"",iconTip:""},t.header||{}),fullFooter:l.mix({enter:!0,enterText:n["dialog.submit"],cancel:!0,cancelText:n["dialog.cancel"]},t.footer||{}),modal:!1,height:window.innerHeight,placement:"right",card:t.card+""!="false"})))},mxDialog:function(e,a,t){var i,n,o,s=this,d={beforeClose:function(e){n=e},close:function(){i&&i.trigger("dlg_close")},afterClose:function(e){o=e}},c={view:e};return seajs.use(e,s.wrapAsync(function(_){var g="$dlg_"+e;if(!s[g]){s[g]=1;var f,p,m,u,y=_.dialogOptions||{},h=(t=t||{}).placement||y.placement||"center",x=t.width||y.width||400,v=t.height||y.height||260,z=window.innerWidth,b=window.innerHeight,w=t.target||y.target;if(w){var k=void 0;k="string"!=typeof w||/^#/.test(w)||/^\./.test(w)?r(w):r("#"+w);var T=t.offset||y.offset||{};T.top=+T.top||0,T.left=+T.left||0;var C=k.offset();p=C.top+k.outerHeight()+10-r(window).scrollTop()+T.top,f=C.left-(x-k.outerWidth())/2+T.left,m={opacity:0,top:"-50px"},u={opacity:1,top:0}}else switch(h){case"center":f=(z-x)/2,p=Math.max((b-v)/2,0),m={opacity:0,top:"-50px"},u={opacity:1,top:0};break;case"right":f=z-x,p=0,m={opacity:0,top:0,left:z},u={opacity:1,top:0,left:0}}l.mix(c,{mask:!0,modal:!1,width:x,closable:!0,left:f,top:p,posFrom:m,posTo:u},y,t),l.mix(c,a),c.dialog=d,(i=s.__aN(s,c)).on("beforeClose",function(e){n?n().then(function(){e.closeFn()}):e.closeFn()}),i.on("close",function(){delete s[g],o&&o()})}})),d},mxCloseAllDialogs:function(){s.forEach(function(e){var a=r("#"+e.id);a&&a.trigger("dlg_close")})}})});