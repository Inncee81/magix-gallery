define("mx-indics/dialog",["magix","../mx-util/view","mx-popover/index","mx-dragsort/index"],(e,l,a)=>{e("mx-popover/index"),e("mx-dragsort/index"),l.__esModule=!0;var r=e("magix"),t=e("../mx-util/view");r.default.applyStyle("_zs_galleryac",'._zs_galleryhH{position:relative;height:100%}._zs_galleryhH ._zs_galleryhI{position:relative;width:100%;height:60px;padding:0 24px;background-color:#fff;line-height:60px;border-bottom:1px solid var(--color-border);white-space:nowrap;word-wrap:normal;overflow:hidden;text-overflow:ellipsis}._zs_galleryhH ._zs_galleryhI ._zs_galleryhJ{position:absolute;top:0;right:0;padding:0 24px;background-color:#fff}._zs_galleryhH ._zs_galleryhK{position:absolute;top:60px;left:0;bottom:0;right:0;overflow-y:auto}._zs_galleryhH ._zs_galleryhK ._zs_galleryhL{position:relative;padding:16px 24px}._zs_galleryhH ._zs_galleryhK ._zs_galleryhL:nth-of-type(2n){background-color:var(--color-bg)}._zs_galleryhH ._zs_galleryhK ._zs_galleryhM{position:absolute;top:16px;left:24px;width:90px;padding:8px 0;color:#999}._zs_galleryhH ._zs_galleryhK ._zs_galleryhN{float:left;padding:8px 0;white-space:nowrap}._zs_galleryhH ._zs_galleryhK ._zs_galleryhN ._zs_galleryhO{position:relative;top:1px;left:1px;font-size:14px;color:#ccc}._zs_galleryhH._zs_galleryhP ._zs_galleryhL{padding-left:122px}._zs_galleryhH._zs_galleryhQ{padding-right:240px}._zs_galleryhH._zs_galleryhQ ._zs_galleryhK{right:240px;border-right:1px solid var(--color-border)}._zs_galleryhH._zs_galleryhQ ._zs_galleryhR{position:absolute;top:0;right:0;width:240px;height:98px}._zs_galleryhH._zs_galleryhQ ._zs_galleryhR ._zs_galleryhS{height:60px;line-height:60px;padding-left:24px;border-bottom:1px solid var(--color-border)}._zs_galleryhH._zs_galleryhQ ._zs_galleryhR ._zs_galleryhT{height:38px;padding:0 24px;line-height:38px;text-align:right;background-color:var(--color-bg)}._zs_galleryhH._zs_galleryhQ ._zs_galleryhU{position:absolute;top:98px;right:0;bottom:0;width:240px;padding:0 24px 16px;overflow-y:auto;background-color:var(--color-bg)}._zs_galleryhH._zs_galleryhQ ._zs_galleryhU ._zs_galleryhV{height:30px;margin-bottom:5px;padding:0 15px;line-height:28px;background:#fff;border:1px solid var(--color-border);border-radius:var(--border-radius);cursor:move}._zs_galleryhH._zs_galleryhQ ._zs_galleryhU ._zs_galleryhV:last-child{margin-bottom:0}._zs_galleryhW{display:inline-block;width:40px;padding-right:10px;margin-right:10px;text-align:center}._zs_galleryhW ._zs_galleryhX{position:relative;top:2px;font-size:18px}._zs_galleryhY{display:inline-block;width:auto}[mx-view*="mx-indics/index"]{display:inline-block;vertical-align:middle}[mx-view*="mx-indics/index"]:hover ._zs_galleryhW,[mx-view*="mx-indics/index"]:hover ._zs_galleryhY{border-color:var(--border-highlight-hover);color:#333}[mx-view*="mx-indics/index"]:hover ._zs_galleryhY ._zs_galleryhZ{color:var(--border-highlight-hover)}'),l.default=t.extend({tmpl:function(e,l,a,r,t,s,i,o){if(a||(a=e),!t){var n={"&":"amp","<":"lt",">":"gt",'"':"#34","'":"#39","`":"#96"},c=/[&<>"'`]/g,h=function(e){return"&"+n[e]+";"};t=function(e){return""+(null==e?"":e)},r=function(e){return t(e).replace(c,h)}}if(!s){var d={"!":"%21","'":"%27","(":"%28",")":"%29","*":"%2A"},g=function(e){return d[e]},_=/[!')(*]/g;s=function(e){return encodeURIComponent(t(e)).replace(_,g)}}if(!o){var p=/[\\'"]/g;o=function(e){return t(e).replace(p,"\\$&")}}var x="",v=e.sortable,u=e.hasParent,f=e.limit,y=e.selectedItems,m=e.tip,z=e.groups,b=e.width;x+='<div mxv class="_zs_galleryhH ',v&&(x+="_zs_galleryhQ"),x+=" ",u&&(x+="_zs_galleryhP"),x+='"><div mxa="_zs_galleryc[:_" class="_zs_galleryhI"><span mxs="_zs_galleryc[:_" class="fontsize-16">选择数据字段</span>',f>0&&(x+='<span mxa="_zs_galleryc[:a" class="color-9 font-tahoma bold ml10">'+r(y.length)+" / "+r(f)+"</span>"),x+=" ",m&&(x+='<span mxa="_zs_galleryc[:b" class="color-9 ml10">'+t(m)+"</span>"),x+=" ",v||(x+='<span mxs="_zs_galleryc[:a" class="_zs_galleryhJ"><a href="javascript:;" class="link-brand mr16" mx-click="'+l+'reset()"><i class="mc-iconfont displacement-2">&#xe627;</i>恢复默认</a><a href="javascript:;" class="link-brand" mx-click="'+l+'clear()"><i class="mc-iconfont displacement-2">&#xe72e;</i>清空</a></span>'),x+='</div><div mxv mxa="_zs_galleryc[:c" class="_zs_galleryhK">';for(var k=0,w=z.length;k<w;k++){var H=z[k];x+='<div mxv mxa="_zs_galleryc[:d" class="_zs_galleryhL clearfix">',H.text&&(x+='<div mxa="_zs_galleryc[:e" class="_zs_galleryhM">'+r(H.text)+"</div>"),x+='<div mxv mxa="_zs_galleryc[:f" class="clearfix">';for(var I=0,Q=H.fields,K=Q.length;I<K;I++){var M=Q[I];x+='<div mxv class="_zs_galleryhN" style="width: '+r(b)+';"><label mxv ',f>0&&y.length>=f&&!M.checked&&(x+=' class="cursor-not-allow" '),x+='><input type="checkbox" name="field" value="'+r(M.value)+'" class="checkbox" ',M.checked&&(x+=' checked="true" '),x+=" ",f>0&&y.length>=f&&!M.checked&&(x+=' disabled="true" '),x+=' mx-change="'+l+"toggle({value:'"+r(o(M.value))+"',text:'"+r(o(M.text))+"'})\"/>"+r(M.text)+"</label>",M.tip&&(x+='<i class="mc-iconfont _zs_galleryhO" mx-view="mx-popover/index?width=240&content='+s(M.tip)+'">&#xe7aa;</i>'),x+="</div>"}x+="</div></div>"}if(x+="</div>",v){x+='<div mxs="_zs_galleryc[:b" class="_zs_galleryhR"><div class="_zs_galleryhS"><span class="fontsize-16">自定义字段</span><span class="color-9 ml10">可拖动排序</span></div><div class="_zs_galleryhT"><a href="javascript:;" class="link-brand mr16" mx-click="'+l+'reset()"><i class="mc-iconfont displacement-2">&#xe627;</i>恢复默认</a><a href="javascript:;" class="link-brand" mx-click="'+l+'clear()"><i class="mc-iconfont displacement-2">&#xe72e;</i>清空</a></div></div><div mxa="_zs_galleryc[:g" class="_zs_galleryhU" mx-view="mx-dragsort/index" mx-dragfinish="'+l+'drag()">';for(var O=0,P=y.length;O<P;O++){var R=y[O];x+='<div class="_zs_galleryhV" data-value="'+r(R.value)+'" data-text="'+r(R.text)+'">'+r(R.text)+"</div>"}x+="</div>"}return x+="</div>"},init:function(e){var l=e.selected||[],a=e.fields||[],r=e.parents||[],t=[];l.forEach(function(e){for(var l=0;l<a.length;l++){var r=a[l];if(r.value==e){r.checked=!0,t.push({value:r.value,text:r.text});break}}});var s,i=e.lineNumber,o=[];if(r.length>0)o=r.map(function(e){var l=[];return a.forEach(function(a){a.pValue==e.value&&l.push(a)}),{text:e.text,fields:l}}),s=!0;else{for(var n=Math.ceil(a.length/i),c=0;c<n;c++){var h={fields:a.slice(c*i,(c+1)*i)};o.push(h)}s=!1}this.updater.set({width:Math.floor(100/i)+"%",hasParent:s,sortable:e.sortable,fields:a,groups:o,selectedItems:t,limit:e.limit,tip:e.tip}),this.viewOptions=e},render:function(){this.updater.digest({})},"toggle<change>":function(e){for(var l=e.target.checked,a=e.params,r=a.value,t=a.text,s=this.updater,i=s.get(),o=i.fields,n=i.selectedItems,c=i.sortable,h=0;h<o.length;h++)if(o[h].value==r){o[h].checked=l;break}if(l)c?n.push({value:r,text:t}):n=o.filter(function(e){return e.checked});else for(h=0;h<n.length;h++)if(n[h].value==r){n.splice(h,1);break}s.digest({fields:o,selectedItems:n})},"drag<dragfinish>":function(e){for(var l=[],a=document.querySelectorAll("#"+this.id+" ._zs_galleryhV"),r=0,t=a.length;r<t;r++){var s=a[r].attributes;l.push({value:s["data-value"].value,text:s["data-text"].value})}this.updater.digest({selectedItems:l})},"reset<click>":function(){var e=this.viewOptions.map[1].list,l=this.updater.get("fields"),a=[];l.forEach(function(l){l.checked=e.indexOf(l.value+"")>-1,l.checked&&a.push(l)}),this.updater.digest({fields:l,selectedItems:a})},"clear<click>":function(){var e=this.updater.get("fields");e.forEach(function(e){e.checked=!1}),this.updater.digest({fields:e,selectedItems:[]})},check:function(){event.preventDefault();var e=this.updater.get("selectedItems").map(function(e){return e.value});return new Promise(function(l){l({ok:e.length>0,msg:"请至少选择一个指标",data:{selected:e}})})}})});