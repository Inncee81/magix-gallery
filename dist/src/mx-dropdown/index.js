define("mx-dropdown/index",["magix","../mx-util/view","$","../mx-util/monitor","../mx-medusa/util"],(e,t,a)=>{var _=e("magix"),i=e("../mx-util/view"),r=e("$"),l=e("../mx-util/monitor"),s=e("../mx-medusa/util");_.applyStyle("_zs_galleryI","._zs_galleryew{min-width:600px}._zs_galleryew ._zs_galleryex{float:left;width:25%}._zs_galleryew ._zs_galleryey{margin-bottom:10px}._zs_galleryez{padding-top:10px;padding-left:18px;padding-right:18px;line-height:16px}._zs_galleryez ._zs_galleryeA{float:left;padding-right:20px;color:#999}._zs_galleryez ._zs_galleryeA:hover{color:var(--color-brand)}._zs_galleryez._zs_galleryeB{padding-left:12px;padding-right:12px}._zs_galleryeC ._zs_galleryeD{height:auto}._zs_galleryeE img{display:none}"),a.exports=i.extend({tmpl:function(e,t,a,_,i,r,l,s){if(a||(a=e),!i){var c={"&":"amp","<":"lt",">":"gt",'"':"#34","'":"#39","`":"#96"},n=/[&<>"'`]/g,o=function(e){return"&"+c[e]+";"};i=function(e){return""+(null==e?"":e)},_=function(e){return i(e).replace(n,o)}}if(!r){var u={"!":"%21","'":"%27","(":"%28",")":"%29","*":"%2A"},p=function(e){return u[e]},d=/[!')(*]/g;r=function(e){return encodeURIComponent(i(e)).replace(d,p)}}if(!s){var g=/[\\'"]/g;s=function(e){return i(e).replace(g,"\\$&")}}l||(l=function(e,t,a,_){for(_=e[x];--_;)if(e[a=x+_]===t)return a;return e[a=x+e[x]++]=t,a});var x="",m="",v=e.viewId,f=e.expand,h=e.name,y=e.selectedText,b=e.placementClass,z=e.rList,w=e.searchbox,k=e.text,T=e.keyword,j=e.list,A=e.height,C=e.textKey,L=e.valueKey,K=e.selected,q=e.spm;if(m+='<div id="toggle_'+_(v)+'" class="mx-trigger ',f&&(m+=" mx-trigger-open "),m+='"><span mxa="_zs_gallerybx:_" class="mx-trigger-label">',h&&(m+='<span mxa="_zs_gallerybx:a" class="color-9">'+_(h)+"ï¼š</span>"),m+='<span mxa="_zs_gallerybx:b" class="_zs_galleryeE">'+i(y)+'</span></span><span mxs="_zs_gallerybx:_" class="mc-iconfont mx-trigger-arrow">&#xe692;</span></div><div mxv id="menu_'+_(v)+'" class="_zs_galleryeC mx-output '+_(b)+" ",f&&(m+=" mx-output-open "),m+='">',z){if(m+=" ",w&&(m+='<div mxv mxa="_zs_gallerybx:c" class="mx-output-search"><div mxv mxa="_zs_gallerybx:d" class="search-box" style="width: 100%;"><i mxs="_zs_gallerybx:a" class="mc-iconfont search-icon">&#xe651;</i><input class="input search-input" placeholder="'+_(k.search)+'" mx-keyup="'+t+'__j()" mx-paste="'+t+'__j()" mx-change="'+t+'__p()" mx-focusin="'+t+'__p()" mx-focusout="'+t+'__p()" value="'+_(T)+'"/></div></div>'),m+=" ",j.length){m+='<ul class="mx-output-list" id="list_'+_(v)+'" style="max-height:'+_(A)+'px;">';k=void 0;var D=void 0;m+=" ";for(var E=0,I=j;E<I.length;E++){var O=I[E];if(m+=" ",k=O[C],D=O[L],m+=" ",O&&O.group)m+='<li class="mx-output-header" title="'+_(O[C])+'">'+_(O[C])+"</li>";else{m+='<li class="mx-output-item" title="'+_(O.tip?O.tip:k)+'">';var P=D+""==K+"";m+='<span class="_zs_galleryeD mx-output-link ',P&&(m+=" mx-output-link-active "),m+='" data-active="'+_(P)+'" mx-click="'+t+"__ah({item:'"+l(a,O)+"'})\" ",q&&(m+=' data-spm-click="'+_(q)+_(D)+'" '),m+=">"+i(k)+"</span></li>"}m+=" "}m+="</ul>"}else m+='<div mxa="_zs_gallerybx:e" class="text-center color-9 pt20 pb20">'+i(k.empty)+"</div>";m+=" "}return m+="</div>"},init:function(e){var t=this;l.__k(),t.on("destroy",function(){l.__l(t),l.__m()}),t.__a=r("#"+t.id),t.__n=e.disabled+""=="true"||r("#"+t.id)[0].hasAttribute("mx-disabled"),t.__ce=!1;var a="mx-output-"+(e.placement||"bottom");t.__bU=e.triggerType||"click";var i=t.__cf=e.selected,c=t.__cg=e.textKey||"text",n=t.__ch=e.valueKey||"value",o=t.__ci=e.emptyText||"",u=[];if(e.list){try{u=JSON.parse(e.list)}catch(t){u=e.list}"object"==typeof u[0]||(u=u.map(function(e){var t={};return t[c]=e,t[n]=e,t}))}else{var p;t.__a.children().each(function(e,t){t=r(t),p="true"==t.attr("group"),u.push({group:p,text:t.text(),value:p?_.guid():t.attr("value")})}),c=t.__cg="text",n=t.__ch="value"}t.__cj=u;var d=_.toMap(u,n);if(o&&!d[""]){var g={};g[c]=o,g[n]="",u.unshift(g),d[""]=g}if(!i||!d[i]){for(var x={},m=0;m<u.length;m++)if(!u[m].group){x=u[m];break}i=d[i]||x,c&&n&&(i=i[n])}t.updater.set({textKey:t.__cg,valueKey:t.__ch,selected:t.__cf=i,searchbox:e.searchbox+""=="true",selectedText:t.__ck=(d[i]||{})[c],keyword:t.__cl=e.keyword||"",expand:t.__ce,height:e.height||250,name:e.name||"",placementClass:a,text:{search:s["dropdown.search"],empty:s["empty.text"]}}),t.__a.val(i)},render:function(){var e,t=this,a=t.updater.get("searchbox"),_=function(){t.updater.digest({list:e});var a=t.__bU,_=r("#toggle_"+t.id);switch(a){case"click":_.on("click",function(){t.__ce?t.__q():t.__n||t.__r()});break;case"hover":_.hover(function(){clearTimeout(t.__bT),t.__n||t.__r()},function(){t.__bV()}),r("#menu_"+t.id).hover(function(){clearTimeout(t.__bT)},function(){t.__bV()})}};a?t.__c_(t.__cl,function(t){e=t,_()}):(e=t.__cj,_())},__o:function(e){return _.inside(e,this.id)},__bV:function(){var e=this;clearTimeout(e.__bT),e.__bT=setTimeout(e.wrapAsync(function(){e.__q()}),250)},__q:function(){var e=this;e.__ce&&(e.updater.digest({expand:e.__ce=!1}),e.__a.trigger("focusout"),l.__l(e))},__r:function(){var e=this;if(!e.__ce){var t={expand:e.__ce=!0};e.updater.get("rList")||(t.rList=!0),e.updater.digest(t),e.__a.trigger("focusin");var a=r("#list_"+e.id),_=a.find('[data-active="true"]').position(),i=a.height(),s=a.prop("scrollTop");if(_&&(_.top<0||_.top>i)){var c=_.top-i+s+i/2;a.prop("scrollTop",c)}l.__t(e)}},__c_:function(e,t){var a=this;clearTimeout(a.__cm);var _=a.__cj,i=[],r=0,l=_.length,s=a.__cg,c=a.__ch;if(e){var n=function(){if(r<l){for(var o=Math.min(r+400,l),u=r,p=void 0,d=void 0,g=void 0;u<o;u++){d=p=_[u],g=p,s&&c&&(d=p[s],g=p[c]);var x=(e+"").toLocaleLowerCase();((d+"").toLocaleLowerCase().indexOf(x)>=0||(g+"").indexOf(e)>=0)&&i.push(p)}r=o,a.__cm=setTimeout(a.wrapAsync(n),20)}else t(i)};n()}else t(_)},"__j<keyup,paste>":function(e){var t=this;e.stopPropagation(),clearTimeout(t.__cd);var a=r.trim(e.eventTarget.value);t.updater.set({keyword:a}),t.__cd=setTimeout(t.wrapAsync(function(){a!=t.__cl&&t.__c_(t.__cl=a,function(e){t.updater.digest({list:e})})}),250)},"__ah<click>":function(e){var t=this,a=e.params.item,_=t.updater,i=t.__ch,l=t.__cg,s=t.__cf,c=t.__cl,n=a[i],o=a[l];if(s!==n){_.set({selected:t.__cf=n});var u=r.Event("change",{item:a,keyword:c,keys:{text:l,value:i},value:a[i],text:a[l],selected:a[i]});u.isDefaultPrevented()?_.set({selected:s}):_.digest({selected:n,selectedText:o}),t.__a.val(i?a[i]:a).trigger(u)}t.__q()},"__p<change,focusin,focusout>":function(e){e.stopPropagation()}})});